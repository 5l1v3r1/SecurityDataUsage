Measuring the Impact and Perception of

Acceptable Advertisements

Robert J. Walls

Eric D. Kilmer
Department of Computer Science and Engineering

Nathaniel Lageman

Patrick D. McDaniel

Pennsylvania State University, University Park, PA, USA

{rjwalls, ekilmer, njl5114, mcdaniel}@cse.psu.edu

ABSTRACT

In 2011, Adblock Plus—the most widely-used ad blocking software—
began to permit some advertisements as part of their Acceptable
Ads program. Under this program, some ad networks and content
providers pay to have their advertisements shown to users. Such
practices have been controversial among both users and publishers.
In a step towards informing the discussion about these practices,
we present the ﬁrst comprehensive study of the Acceptable Ads
program. Speciﬁcally, we characterize which advertisements are
allowed and how the whitelisting has changed since its introduction
in 2011. We show that the list of ﬁlters used to whitelist acceptable
advertisements has been updated on average every 1.5 days and grew
from 9 ﬁlters in 2011 to over 5,900 in the Spring of 2015. More
broadly, the current whitelist triggers ﬁlters on 59% of the top 5,000
websites. Our measurements also show that the program allows
advertisements on 2.6 million parked domains. Lastly, we take the
lessons learned from our analysis and suggest ways to improve the
transparency of the whitelisting process.

Categories and Subject Descriptors

H.3.5 [On-line Information Services]: Web-based services; K.4.4
[Computers and Society]: Electronic Commerce

General Terms

Acceptable Ads; Adblock Plus; Ad Avoidance

1.

INTRODUCTION

Over 144 million users employ ad blocking software [27]. Users
are motivated by a desire to hide intrusive ads, increase their privacy,
or protect themselves from malicious adverts [34]. Yet, some claim
ad blocking threatens the Web’s business model. Indeed, Google lost
an estimated $887 million in revenue to blocking in Q2 2013 [26,31].
In 2011 Eyeo GmbH—the maker of the most popular ad blocker,
Adblock Plus—introduced their Acceptable Ads program. Through
this program, Adblock Plus allows some “non-intrusive” ads that
satisfy a set of community-driven guidelines, such as “ads should
never obscure page content.” According to Eyeo, their goal is to

Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage and that copies bear this notice and the full citation
on the ﬁrst page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior speciﬁc permission
and/or a fee. Request permissions from Permissions@acm.org.
IMC’15, October 28–30, 2015, Tokyo, Japan.
Copyright is held by the owner/author(s). Publication rights licensed to ACM.
ACM 978-1-4503-3848-6/15/10 ...$15.00.
DOI: http://dx.doi.org/10.1145/2815675.2815703 .

strike a balance between the needs of users and publishers, and
they emphasize transparency as key to the program’s success [6,
22]. However, Eyeo drew strong criticism when they conﬁrmed
some companies—including Google, Microsoft, and Amazon—paid
undisclosed amounts to be included in the whitelist [9,32]. Some
view this arrangement as a conﬂict of interest; the organization that
provides blocking software is in a position to indirectly proﬁt from
ads being shown.

The Acceptable Ads program impacts millions of users and bil-
lions of dollars,1 but little is known about the whitelisting process
or how it impacts users. In this paper, we provide the ﬁrst compre-
hensive study of the Acceptable Ads program. We identify how the
users experience the Web under this program by exploring the use
of ad policies (called ﬁlter lists, or just whitelists). We develop tools
and techniques to explore and correlate information from Internet
measurements, a complete history of the program’s whitelist, instru-
mented browser behavior, and user surveys. In this, we have focused
on the following questions:

1. What is in the whitelist and how has it changed over time?
We ﬁnd that at the current revision, Rev. 988, the whitelist
contains 5,936 ﬁlters and is updated every 1.5 days to add or
modify 11.4 ﬁlters on average.

2. Who beneﬁts from the whitelist? We ﬁnd that the whitelist
identiﬁes 3,545 unique explicitly listed publisher domains
(including 15 of the top 100), and that ﬁve general-purpose
ﬁlter types are responsible for allowing content on 2,676,165
parked domains.

3. How do we measure the impact of the whitelist? We survey
whitelist use in the Alexa top 5,000 most popular websites
as well as 5,000 sites from the 5k to 1 million most popular.
The current whitelist triggers ﬁlters on 59% of the top 5,000
websites but explicitly whitelist only a few percent of less
popular sites.

4. How do users perceive acceptable advertisements? A survey
of over 300 users showed wide dissension on many adver-
tisements that were judged as being invasive. One area of
agreement was clear: advertisements interspersed with and
largely indistinguishable from web content were deemed as
undesirable.

Our study is motivated by other large-scale Web and security
measurement studies, including those characterizing SPAM [14,
17], afﬁliate programs [20], domain abuse [4,7], and malicious
advertising [19,34]. We begin by detailing the operation of Adblock

1The Internet Advertising Bureau reported a record high of $12.4 bil-
lion in U.S. advertising revenue for Q3 2014, breaking the previous
record of $12.1 billion in Q4 of 2013 [13].

107<iframe id= " ad_main " frameborder= " 0 " scrolling= " no " name= " ad_main " src= " http :// static . adzerk .

net / reddit / ads . html ? sr = - reddit . com , loggedout & amp ; bust2 # http :// www . reddit . com " > </iframe>

Figure 1: Sample ad code from Reddit. This code displays an iframe for an Adzerk advertisement on the right side of the page. Similar code constructions
are common across different sites using the same ad network. This allows Adblock Plus to use a single ﬁlter to block ads on multiple domains.

Plus and the Acceptable Ads program. We then characterize how
the program works in practice. Finally, we offer suggestions for
improving the transparency of the whitelisting process.

2. ADBLOCK PLUS

Adblock Plus is the most widely used browser extension with over
50 million users across all major browsers.2 In 2014, the extension’s
Firefox version was downloaded 68 million times and boasted 19.2
million users daily.3 Adblock Plus is open source and available free
of charge.

Adblock Plus was created by Michael McDonald’s as a fork
of Henrik Aasted Sørensen’s Adblock project. In January 2006,
Wladimir Palant rewrote the code and released it as a separate
project for Firefox. Since then, Adblock Plus has been ported to
run on all major browsers: Chrome (Dec. 2010 [28], formerly
AdThwart [3]), Opera (Nov. 2012 [10]), Internet Explorer (Aug.
2013 [29]), and Safari (Jan. 2014 [25]). Eyeo offers an Android
version, but it is not available in the Google Play store [30].

Adblock Plus uses textually encoded ﬁlters to determine the con-
tent shown on a page. Blocking ﬁlters restrict page content, while
exception ﬁlters override any matching blocking ﬁlters to allow the
content. Filter deﬁnitions generally consist of: (i) a matching ex-
pression that speciﬁes what content to block (or allow), e.g., the
URL of an advertising network; and (ii) a set of ﬁlter options, e.g.,
the image option applies the ﬁlter to image requests. A detailed
description of the ﬁlter syntax is included in Appendix A.

Adblock Plus users rarely write their own ﬁlters. Instead, they
subscribe to regularly published text-based ﬁlter lists. By default,
Adblock Plus subscribes users to two ﬁlter lists: the ﬁrst, EasyList,
contains tens of thousands of ﬁlters to block advertisements and
covers most common ad networks. Other blocking extensions also
use EasyList, including the second most popular blocker, AdBlock.
The second default ﬁlterlist—which we refer to as the Acceptable
Ads whitelist—is used to implement the Acceptable Ads program.
In short, this list overrides the user’s other ﬁlter lists allowing certain
publishers to show advertisments. We characterize the scope and
impact of the whitelist in later sections.

Users can subscribe to additional ﬁlter lists that provide function-
ality beyond blocking advertisements including: disabling tracking,
allowing the user to “browse the web truly anonymously”, blocking
known malicious domains, and removing social media buttons, such
as the Facebook Like button.4 We defer analysis of these lists to
future work.

2.1 Filter Matching

Broadly, individual ﬁlters match one of two types of content: Web

requests or page elements. We brieﬂy describe each below.

2.1.1 Matching Web Requests

Publishers often rely on third-party ad networks, such as Adzerk
or Google Adsense, to display advertisements on their site. These

2https://adblockplus.org/en/about
3https://addons.mozilla.org/en-US/firefox/addon/
adblock-plus/statistics/
4https://adblockplus.org/en/features

Figure 2: Acceptable ads on Reddit.com. Reddit is a member of the
Acceptable Ads program. Consequently, Adblock Plus allows both of the ads
on this page. A third-party network, Adzerk, serves the ad on the right side
(labeled 1). The sponsored link (labeled 2) is embedded directly into the
page.

networks make it possible for publishers to show ads by simply
including a small snippet of code provided by the ad network. This
straightforward interface also simpliﬁes the blocking process by
allowing a single ﬁlter to block ads on multiple sites.

For example, reddit.com uses the code in Figure 1 to show
Adzerk advertisements. When an Adblock Plus user visits the page,
their browser will make a third-party web request to fetch the adver-
tisement from Adzerk. Adblock Plus will preempt this request to
check if the request URL matches any ﬁlters. If the match is for a
blocking ﬁlter, such as the following, Adblock Plus will cancel the
request, stopping the browser from fetching the ad.

1

|| adzerk . net ^ $third - party

In short, the above ﬁlter will block all third-party requests to adzerk.
net or any of its subdomains. For a more complete explanation of
ﬁlter syntax see Appendix A.

If the request matches an exception ﬁlter,5 then Adblock Plus al-
lows it, regardless of any blocking ﬁlter matches. The advertisement
is then shown as an image on the right of the page—denoted by the
bold 1 in Figure 2.

2.1.2 Matching Page Elements

Adblock Plus uses different ﬁlter syntax for matching advertising
elements embedded directly into the page. Similar to how request
ﬁlters match URLs, element ﬁlters use CSS Selectors6 to identify
elements based on attributes such as the element’s class or id.

The following ﬁlter blocks the “sponsored link” at the top of
Reddit’s front page (bold 2 in Figure 2) by matching elements with
an id attribute of siteTable_organic.

1

reddit . com ### siteTable_organic

However, Adblock Plus does not block either of the advertise-
ments in our example. It allows these ads because Reddit is a part
of the Acceptable Ads program.

5Request exception ﬁlters are denoted by the @@ preﬁx.
6http://www.w3.org/TR/CSS21/selector.html

1086000

s
r
e

t
l
i

F

 
f

o
 
r
e
b
m
u
N

4000

2000

Whitelist Released 

in ABP 2.0

Added Sedo 

Sitekey

Filter
Category

Restricted

Blocking

Unrestricted

Sitekey

Added 

About.com

Added Google 

Search ads

Added Conversion 

Tracking for 
DoubleClick

●

Added 
Reddit

●

Added Unrestricted 
AdSense for Search

●

0

● ●

2 0 1 2 − 0 1

2 0 1 2 − 0 7

●

●

2 0 1 3 − 0 1

2 0 1 3 − 0 7

2 0 1 4 − 0 1

2 0 1 4 − 0 7

2 0 1 5 − 0 1

Figure 3: The growth of the Acceptable Ads whitelist. The whitelist has grown steadily since its introduction in 2011. On average, this ﬁlter list is updated
every 1.5 days, adding or modifying 11.4 exception ﬁlters. The most recent version (Rev. 988 on April 28, 2015) includes 5,936 ﬁlters. Among these are exceptions
for domain parking services, conversions tracking, and third-party ad networks.

3. ACCEPTABLE ADS

In May 2011, Adblock Plus’s creator, Wladimir Palant, outlined
the criteria for Acceptable Ads with the goal of “encourag[ing]
websites to use advertising that users don’t perceive as annoying.”7
These guidelines have been reﬁned multiple times based on feedback
from the community. Whitelisted sites are required to adhere to
these guidelines. To paraphrase the most recent criteria [1], sites
must ensure that:

1. Advertisements cannot contain animations, sounds, or “attention-

grabbing” images.

2. Advertisements cannot obscure page content or obstruct read-
ing ﬂow, i.e., the ad cannot be placed in the middle of a block
of text.

3. Advertisements must be clearly distinguished from the page
content and must be labeled using the word “advertisement”
or equivalent terms.

4. Banner advertisements should not force the user to scroll

down to view page content.

After publishing the initial Acceptable Ads requirements, Palant
and his partner, Till Faida, created Eyeo GmbH in August 2011.
Their goal was to make the Adblock Plus project “more sustain-
able” [8]. The following month, the company began surveying users
about their willingness to allow advertising in some form.8 By the
year’s end released Acceptable Ads as an opt-out feature in Adblock
Plus version 2.0.9

The program has been controversial. Eyeo drew criticism from

both users and publishers when they conﬁrmed that some companies—
including Google, Microsoft, and Amazon—paid undisclosed amounts
to be included in the whitelist [9,32]. Eyeo has stated that received
funds are used to sustain the program. Further, they state that
whitelisting is free for smaller sites and all participants of the pro-
gram must abide by the acceptable ads criteria.
7https://adblockplus.org/forum/viewtopic.php?f=4&t=
7551
8https://adblockplus.org/releases/
adblock-plus-1310-released
9https://adblockplus.org/releases/
adblock-plus-20-released

Eyeo’s practices have incensed some publishers to such a degree
that they have accused the company of “extortion” and “shaking
down” websites [23]. Recently, this criticism has escalated to the
courtroom, and Eyeo is facing lawsuits in France and Germany [11,
12,16]. In Germany, publishers ﬁled suit against Eyeo claiming
that their product is anti-competitive and threatens their ability to
generate revenue. The regional court in Hamburg ruled in favor of
Eyeo after a four month trial [15,33].

3.1 Filter List Maintenance

Eyeo regularly updates the whitelist. On average, the company
adds or modiﬁes 11.4 ﬁlters every 1.5 days, and has a documented
process for requesting new whitelist ﬁlters to be added. The process
of adding new sites to the Acceptable Ads program comprises four
steps: contact, application, agreement, and inclusion.

The ﬁrst step, contact, consists of communication between Eyeo
and a perspective publisher. Either party may initiate this dialog [24].
Next, Eyeo works with the publisher to ensure their site follows
the Acceptable Ads guidelines (the application step). Once Eyeo
conﬁrms the site’s advertisements adhere to their policy, they estab-
lish a private agreement with the publisher. These agreements may
involve a fee, but Eyeo does not currently disclose the fee structure,
monetary value, or list of paying publishers. However, anecdotal
sources claim the company has requested up to 30% of recovered
revenue [5], and Eyeo acknowledges they have experimented with
both ﬂat and performance-based fees [24]. After reaching an agree-
ment, Adblock Plus adds the ﬁlter to the list and solicits community
feedback on the application via an online forum.10 Forum posts
made after Nov. 2014 include links to the whitelist revision and
optional sample screenshots.

4. WHITELIST ANALYSIS

In the following sections, we examine the complete history of
Eyeo’s Acceptable Ads program. Our analysis combines whitelist
changes with public disclosures and empirical observations of browser
behavior. We focus on answering the following broad questions.

10https://adblockplus.org/forum/viewforum.php?f=12

109Year Revisions Filters Added Filters Removed Domains Added Domains Removed
1
2011
2012
4
73
2013
125
2014
207
2015
Total
410

25
225
5152
2179
1227
8808

26
47
311
386
219
989

17
30
1555
775
495
2872

5
59
2248
859
371
3542

Table 1: Yearly activity for the Acceptable Ads whitelist. This table shows the year, number of revisions, number of ﬁrst-party domains, and number of
changes to exception ﬁlters—modiﬁcations are counted as new ﬁlters. The data covers changes up to Apr. 28, 2015 (Rev. 988).

1. How has the whitelist changed over time? We analyze all
revisions of the whitelist to quantify the number of domains
and ﬁlters. Section 4.1.

2. Who beneﬁts explicitly from the whitelist? We ﬁrst char-
acterize the whitelist ﬁlters based on their scope and target
content. Then, we parse the whitelist ﬁlters to extract explic-
itly listed publisher domains and group these domains based
on popularity and category. Section 4.2.

3. How do we measure the impact of the whitelist? We run
an automated survey across the top 5,000 most popular web-
sites and 5,000 additional sites from the 5K to 1M top sites.
Section 5.

4. How do users perceive acceptable advertisements? We survey
305 users on Amazon’s Mechanical Turk platform and ask
them to rate 15 “acceptable” advertisements. Section 6

4.1 Whitelist History

Eyeo tracks all whitelist changes in a public Mercurial repos-
itory.11 Using this repository, we extracted 988 versions of the
whitelist dating from the start of the whitelist in Oct. 2011 to Apr.
2015. The most recent version (Rev. 988) comprises 5,936 distinct
ﬁlters. The majority of these exceptions allow advertisements and
other advertising functionality such as conversion tracking.

Figure 3 shows the growth of the Acceptable Ads whitelist over
time. There are two large jumps visible in the ﬁgure. The ﬁrst
corresponds to Google’s ofﬁcial addition to the whitelist on June
21, 2013 (Rev. 200).12 In total, this revision added 1,262 ﬁlters for
Google search advertisements on google.com and other variations
of this URL, e.g., google.co.uk. The second jump was caused
by ﬁlters for ask.com, about.com, and related subdomains, e.g.,
cars.about.com. These additions are discussed in Section 7.

Table 1 summarizes the yearly changes. The second full year of
the whitelist (2013) saw the list grow by an order of magnitude over
the previous year: Eyeo made 4,633 ﬁlter changes, bringing the total
to 2,319 publisher domains compared to just 60 domains in 2012.
However, as we discuss below, these numbers belie the actual scope
of the whitelist.

4.2 Whitelist Scope

In order to understand who beneﬁts from the Acceptable Ads
program, we need to ﬁrst understand the scope of a whitelist ﬁlter,
i.e., the set of domains that can activate the ﬁlter. For some ﬁlters,
this list of applicable domains is explicitly enumerated in the ﬁlter’s
deﬁnition. We call these restricted ﬁlters. For others—namely
unrestricted and sitekey ﬁlters—the ﬁlter can apply to any domain.
The implication here is that it is impossible to determine the actual
impact of these ﬁlters using ﬁlter deﬁnitions alone. Instead, we can
only empirically estimate this value through site surveys (Section 5).

11https://hg.adblockplus.org/exceptionrules
12https://hg.adblockplus.org/exceptionrules/rev/
8bdf815a5291

Whitelist
Filters 

e
p
o
c
S

Restricted

Sitekey

Unrestricted

e
p
y
T

Request

Element

Request

Element

Figure 4: Hierarchy of Filter Types in the Whitelist.

Figure 4 illustrates a hierarchy of whitelist ﬁlter types and their
scope. We discuss each class in detail below.

4.2.1 Restricted Exception Filters

A restricted exception ﬁlter explicitly deﬁnes the ﬁrst-party do-
mains for which it activates, i.e., the ﬁlter will only match when the
user is browsing a page on one of these domains. The syntax for
deﬁning the domain list depends on the ﬁlter’s type. For example,
the following are two of the whitelist’s restricted exceptions for
reddit.com.

1
2

reddit . com # @ ## ad_main
@@ || adzerk . net / reddit / $subdocument ,

document , domain = reddit . com

The ﬁrst ﬁlter—an element exception—instructs Adblock Plus to
allow any reddit.com elements with the ad_main identiﬁer. For
element ﬁlters, restricted domains are prepended to the start. The
second ﬁlter allows requests to adzerk.net, the ad provider for
reddit.com. In this case, the ﬁlter is restricted via the domain
option.

Restricted exception ﬁlters make up 89% of the whitelist and
cover 3,545 fully qualiﬁed domains, including search engines (Mi-
crosoft, Yahoo, Google), commercial sales (Walmart, Amazon),
content publishers (Reddit, About.com, Cracked), and ISPs (Com-
cast, Time Warner), amongst others. Many of the fully qualiﬁed
domains appearing in the whitelist map to the same publisher. For in-
stance, the whitelist includes over 1,044 subdomains for about.com,
including cars.about.com and food.about.com. Additionally,
there are 919 country-based domains for Google properties included
in the whitelist, e.g., google.co.uk and google.de. Table 2 shows
the respective count and Alexa rankings for fully qualiﬁed domains.

4.2.2 Unrestricted Exception Filters

An unrestricted exception ﬁlter applies to all ﬁrst-party domains,
i.e., these exceptions can match on any site. The whitelist uses
unrestricted exceptions primarily for two purposes. First, many
of these ﬁlters enable conversion tracking. Broadly, conversion
tracking is used to measure if an advertisement resulted in some
user action, e.g., user purchased the product after clicking on the ad.
Second, unrestricted ﬁlters are used to whitelist speciﬁc ad networks.

110Alexa

Fully Qualiﬁed

Partition
All
Top 1,000,000
Top 5,000
Top 1,000
Top 500
Top 100

Domains

1,990
1,286 (0.12%)
316 (6.32%)
167(16.70%)
112(22.40%)
33(33.00%)

Table 2: Domains explicitly included in the whitelist. The whitelist con-
tains restricted exception ﬁlters for 3,544 fully qualiﬁed publisher domains.
This corresponds to 1,990 effective second-level domains, e.g., google.com
is the effective second-level domain of maps.google.com. Percentages are
on the total number of domains within the particular Alexa partition.

This practice allows the ad network to show advertisements across
multiple domains without having to explicitly include these domain
in the whitelist. PageFair is an example of the latter.

PageFair. While PageFair is oft-quoted for their reports on the
prevalence of ad blocking and its monetary costs—in fact, we cite
one in the introduction—the company is also an ad network involved
in the Acceptable Ads program.13

1
2

3

@@ || pagefair . net ^ $third - party
@@ || tracking . admarketplace . net ^ $third -

party

@@ || imp . admarketplace . net ^ $third - party

These unrestricted exception ﬁlters allow PageFair to show adver-
tisements on any partnered website without needing a separate ex-
ception for each domain. The company takes a “minority share
of the additional advertising revenue” that they provide publish-
ers. PageFair also pays Eyeo to participate in the Acceptable Ads
program.

Another advertising network, Inﬂuads, has similar unrestricted

exceptions.

1
2

@@ || influads . com ^ $script , image
# @ ## influads_block

The second of these ﬁlters—an element exception—is not actually
limited to Inﬂuads advertisements; instead, this ﬁlter will match any
element on any site as long as the element’s id is influads_block.
This is the only example of an unrestricted element ﬁlter in the
whitelist, and possibly an oversight by the whitelist’s authors.

In Section 5, we further explore the impact of the 156 unrestricted

exception ﬁlters using a survey of popular domains.

4.2.3 Sitekey Exception Filters

A sitekey exception ﬁlter includes a DER-encoded, base-64 repre-

sentation of an RSA public key.

1
2

! Text ads on Sedo parking domains
@@$sitekey = MFwwDQYJK ... wEAAQ , document

Adblock Plus allows advertisements on any domain that presents a
valid signature signed with a current sitekey. Effectively, sitekeys
delegate the task of whitelisting to the publisher.

Adblock Plus calculates the signature by signing a string contain-
ing the URI, hostname, and user-agent string of the HTTP request.
Adblock Plus then compares the result with the signature returned by
the server in: (i) the X-Adblock-key header of the HTTP response,
and (ii) the data-adblockkey attribute of the returned page.

The ﬁrst sitekey—added to the whitelist before its release—belongs
to Sedo, a domain parking and hosting company based in Cologne,

Whitelisted Domains (.com)
Company
1,060,129
Sedo
2011-11-30
ParkingCrew 2013-05-27
368,703
2013-07-31
RookMedia
949
1,246,359
2013-09-25
Uniregistry
Digimedia
2014-07-02
25
2,676,165

Table 3: Domain statistics for the ﬁve parking services whitelisted by
Adblock Plus. RookMedia was removed from the whitelist on Sept. 16, 2014
(rev. 656); all others remain active.

Germany (the same city as Eyeo). The company’s founder, Tim
Schumacher, is also Eyeo’s chief investor and participated in the
initial development of the Acceptable Ads program [24].

Currently, there are 4 sitekeys and 25 sitekey ﬁlters in the whitelist,
all belonging to domain parking services. They are, in order of
introduction, Sedo, ParkingCrew, Uniregistry, and Digimedia. A
ﬁfth sitekey (for Rook Media) was removed from the whitelist in
Sept. 2014.

Parked domains typically exist to show advertisements (and sell
domains), usually in the form of links to pages related to the domain
name. Misspellings of popular sites are also frequently parked.
For example, reddit.cm is a parked domain that advertises dating
services and photos of celebrities; this domain is whitelisted under
the Acceptable Ads program using a sitekey. For a more complete
treatment of domain parking, see the recent work by Alrwais et
al. [4].

Using the top-level domain zone ﬁle for .com domains, we
identiﬁed approximately 3 million parked domains managed by
one of the parking services listed in Table 3. Speciﬁcally, we
focused on those domains whose name servers belong to one of
the sitekey parking services. For example, Sedo domains use the
ns1.sedoparking.com and ns2.sedoparking.com nameservers.
The list of parking name servers, in part, was derived from the exam-
ple sites given in Adblock Plus online forums. We used automated
tools to visit each suspected domain and only recorded those that
presented a sitekey signature.

Table 3 provides a lower bound on the number of domains for
In total, we ﬁnd the four active sitekeys

each parking service.
account for at least 2,676,165 distinct whitelisted domains.

Finally, some of the above sites required special accommodations
to scrape. For example, ParkingCrew domains employ countermea-
sures to prevent scraping, returning a 403 response if the user-agent
string matches that of a tool like curl. Further, some domains, e.g.,
Uniregistry, behave differently given the presence or absence of
speciﬁc cookie values. For instance, when a user visits a Unireg-
istry domain for the ﬁrst time, the site will return a page that ﬁrst
generates a cookie and then redirects the user to another page with
advertisements (and the sitekey signature).

Factoring Sitekeys. All current sitekeys use 512 bit RSA keys
(RSA-155). Such small key sizes are well within the factoring
capabilities of an individual or publisher with modest hardware
resources. To demonstrate this, we constructed a cluster comprising
8 desktop computers running Ubuntu 14.04, each with an Intel Xeon
E5-2630 clocked at 2.30GHz and 32 GB of memory. We used the
CADO-NFS14 implementation of the Number Field Sieve algorithm.
This setup took approximately one week on average to factor each
sitekey.

In Figure 5, we demonstrate how an adversarial publisher could
use a factored sitekey to show intrusive or malicious advertising.

13https://pagefair.com/about/

14http://cado-nfs.gforge.inria.fr/

111(a) Without sitekey.

(b) With sitekey.

Figure 5: Exploiting sitekeys. Using a cluster of desktop computers, we were able to factor one of the whitelist sitekeys in ﬁve days. The derived key allowed
our test site to bypass Adblock Plus’s blocking entirely.

For our proof of concept, we used Adblock Plus’s default settings
with both the EasyList blacklist and the Acceptable Ads whitelist
enabled. The ﬁgure shows our test site before and after adding the
sitekey. In short, our test site bypassed all blocking ﬁlters.

5. MEASURING FILTER BEHAVIOR

Our previous analysis—focusing on the content of the whitelist—
provides a necessary but incomplete picture of the whitelist’s be-
havior. For instance, the whitelist includes an exception ﬁlter for
PageFair advertisements, but it does not list any of the domains that
use PageFair.

Complicating matters, whitelist behavior also depends on a myr-
iad of more subtle factors including ﬁlter ambiguity, unpredictable
website behavior, and complex interactions between different ﬁlters
and ﬁlter lists. In this Section, we expand on our previous analysis
using empirical measurements of ﬁlter activation.

Methodology. We instrument Adblock Plus to measure ﬁlter activa-
tions on domains drawn from four sample groups: (i) the 5,000 most
popular domains,15 (ii) 1,000 domains randomly sampled from the
rank 5K–50K popularity strata, (iii) 1,000 domains randomly sam-
pled from the rank 50K–100K popularity strata, (iv) 1,000 domains
randomly sampled from the rank 100K–1M popularity strata.

We instrumented Adblock Plus to record ﬁlter activations and
used Selenium16 to visit each domain. We surveyed only the landing
page of each site. By limiting our visit to the ﬁrst page, our survey
produces a lower bound on the number of matching ﬁlters as some
ﬁlters will not activate without user interaction. For instance, Google
search ads only appear after a search.

Figure 6 shows the ﬁlter activations on the top 50 sites with at
least one ﬁlter activation. We show the number and type of ﬁlter

15Website popularity was based on Alexa rankings from Apr. 2015.
http://www.alexa.com/topsites
16http://www.seleniumhq.org/

matches by the height and color of the bars, respectively. Domains
explicitly included in the whitelist are shown in bold along the
x-axis.

This ﬁgure illustrates a number of subtle issues when measur-
ing ﬁlter behavior. First, 12 domains not explicitly included in
the whitelist nevertheless activate whitelist ﬁlters, e.g., youtube.
com. Second, whitelist ﬁlters activate needlessly. That is, the ﬁlter
matches content that would not have otherwise been blocked by the
EasyList blacklist. Third, sites may behave differently based on
browser state and conﬁguration. For example, ask.com will activate
more ﬁlters if the user does not have speciﬁc cookies in the browser
cache. Further, some sites will show different advertisements if the
sites detects the presence of Adblock Plus, e.g., imgur.com.

Finally, not all whitelist ﬁlters are directly responsible for dis-
playing advertisements, e.g., gstatic exceptions. Many common
exceptions are for conversion tracking and do not visually impact
the website.

These results suggests the need for more complex analysis tech-
niques to fully characterize the whitelist’s behavior. We leave such
explorations for future work.

5.1 Active Filters on the Top 5K Domains

Of the Top 5,000 domains, 3,956 activated at least one Adblock
Plus ﬁlter from either the EasyList blacklist or the Acceptable Ads
whitelist. The remaining 1,044 domains were largely non-English
(and thus out of the purview of Easylist) or required additional user
interaction to trigger ﬁlters, e.g., logins, search queries, etc.

Figure 7 shows the distribution of the total and distinct whitelist
ﬁlter matches per surveyed site. We include only domains with at
least one whitelist ﬁlter activation (2,934 sites). Toyota.com saw
the most ﬁlter activations with 83 total matches for 8 distinct ﬁlters,
5% of the surveyed sites activated at least 12 exception ﬁlters (non-
distinct), and, on average, each site activated 2.6 distinct whitelist
ﬁlters.

112ﬁlter_survey

Filter
Source

Whitelist

EasyList

EasyList−Overlapping

20

15

10

5

0

0

s
r
e

t
l
i

 

F
n
o

i
t

p
e
c
x
E

 
f

o
 
r
e
b
m
u
N

10

20

Whitelist

Sans Whitelist

W
h
i
t
e

l
i

s
t

S
a
n
s
 
W
h
i
t
e

l
i

s
t

g o o gle.c o.in − 1 1
a m azo n.c o m  − 6
g o o gle.c o.jp − 1 9
e b ay.c o m  − 1 8
g o o gle.d e − 2 3
ya h o o.c o m  − 4
blo g s p ot.c o m  − 2 0
a s k.c o m  − 3 3
g o o gle.c o m  − 1
lin k e din.c o m  − 1 4
g o o gle.c o.u k − 2 8
g o o gle.e s − 5 2
re d dit.c o m  − 3 2
g o o gle.ru − 4 5
g o o gle.c a − 6 3
a m azo n.c o.jp − 2 9
g o o gle.it − 4 9
g o o gle.fr − 3 0
i m g ur.c o m  − 4 4
g o o gle.c o m . m x − 6 5
a m azo n.d e − 5 6
g o o gle.c o m .br − 3 4
g o o gle.c o m .h k − 6 8
w eib o.co m  −  1 5
wikip e dia.org −  7
live.co m  −  1 2
q q.co m  −  1 0
twitter.co m  −  9
ya h o o.co.jp −  1 6
m ail.ru −  3 7
yo utu b e.co m  −  3
xvid e os.co m  −  4 2
h a o 1 2 3.co m  −  2 6
w ord press.co m  −  3 6
m sn.co m  −  2 7
fc2.co m  −  5 1
so h u.co m  −  3 5
o nclicka ds.n et −  3 8
g m ail.co m  −  4 8
n aver.co m  −  6 6
p ayp al.co m  −  4 3
im d b.co m  −  5 3
g o.co m  −  6 9
g o o gle a dservices.co m  −  5 8
microsoft.co m  −  4 7
aliexpress.co m  −  3 9
diply.co m  −  5 7
tia nya.cn −  6 7
a dcash.co m  −  5 4
stackoverflo w.co m  −  6 0

Figure 6: Filter matches with and without the whitelist enabled. The upper panel shows the ﬁlter matches when both the whitelist and EasyList are enabled,
the bottom shows matches when just EasyList is enabled. We limit this ﬁgure to sites that match at least one ﬁlter from either the whitelist or EasyList (and elide
sina.com.cn for ease of presentation). Each bar is labeled with the domain and rank. Bold denotes domains explicitly included in a whitelist ﬁlter deﬁnition. The
height of the bar represents the number of matches and the ﬁll speciﬁes the ﬁlter’s source. Filters that match in both conﬁgurations are shown in black.

Filter (Truncated)
@@||stats.g.doubleclick.net^$script,image
@@||googleadservices.com^$third-party
@@||gstatic.com^$third-party
@@||googleads.g.doubleclick.net/pagead/view...
@@||google.*/ads/user-lists/$image,subdoc...
@@||googletagmanager.com/gtm.js
@@||fls.doubleclick.net^$subdocument,image
@@||doubleclick.net/activity*$subdocument,i...
@@||google.com/adsense/search/*.js$domain=~...
@@||google.*/ads/conversion
@@||p.skimresources.com/px.gif?ch=1&rn=
||p.skimresources.com/px.gif?ch=2&rn=
@@||r.skimresources.com/api/?$script
@@||s.skimresources.com/js/*.skimlinks.js^$...
@@||t.skimresources.com/api/track.php?$script
@@||pagefair.net^$third-party
#@##influads_block
||viglink.com/images/pixel.gif?ch=2$third-party
@@||doubleclick.net/json
@@||google.com/gen_204

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20

Domains Modiﬁed

Purpose

1,559
1,535
1,282
929
892
746
300
135
78
69
53
53
48
48
47
31
30
25
22
20

2013-02-21 Conversion tracking.
2013-06-21 Google search ads.
2013-06-21 Google search ads.
2013-08-08 Experimental.
2013-05-31 Conversion tracking.
2013-08-08 Experimental.
2013-03-20 Conversion tracking.
2013-08-08 Experimental.
2015-01-22 Google Adsense(A-ﬁlter)
2014-11-28 Conversion tracking.
2013-11-07 Text to afﬁliate links.
2013-11-07 Blocking, text to afﬁliate links.
2013-08-27 Text to afﬁliate links.
2013-08-14 Text to afﬁliate links.
2013-08-27 Text to afﬁliate links.
2014-01-30
2012-11-08
2014-06-02 Blocking, text to afﬁliate links.
2013-08-08 Experimental.
2013-08-08 Experimental.

PageFair ads.
Inﬂuads ads.

Table 4: Most common whitelist ﬁlters in the survey. This table displays the 20 most common exception ﬁlters from our survey of Alexa’s top 5,000 websites.
Number 9 on this list was added without community vetting; it allows Google’s AdSense for search on nearly all domains.

Table 4 shows the 20 most common whitelist exception ﬁlters in
the Top 5,000 group. As expected, all of these ﬁlters are unrestricted.
As we discussed previously, unrestricted ﬁlters can trigger on any
site.

The most activated ﬁlter, @@||stats.g.doubleclick.net^
$script,image, triggered on 1,559 domains (31.2%). This ﬁlter
is used to allows conversion tracking. The second-most popular ﬁl-
ter, @@||googleadservices.com^$third-party, was observed
on 1,535 domains, and allows advertisements from Google’s Ad-
Sense network. The third-most popular ﬁlter, @@||gstatic.com
^$third-party, occurred on 1,282 domains. This ﬁlter does not
appear to contribute to the visibility of advertisements. Instead,
the Google-owned gstatic.com serves fonts, scripts, images, and

other resources to sites to increase browsing performance. The
necessity of the gstatic.com ﬁlter is unclear to us, given that Ea-
syList does not currently contain any ﬁlters that would block the
observed gstatic.com requests.

We observed one unrestricted element exception ﬁlter, #@##
influads_block, which activated on 30 different domains. As
discussed in Section 4.2.2, this ﬁlter prevents the blocking of con-
tent contained within any element with an id of influads_block.

5.2 Filter Activations Across Categories

Figure 8 shows the number of ﬁlters triggered by domains in
each group. The top portion shows categorical ﬁlter activation
frequencies while the lower portion shows ﬁlter activation frequency

113Filter
Source

●

Whitelist

●

EasyList

Group
Proportion ●

0.2

● ●

0.4

0.6

World
Sports
Society
Shopping
Science
Regional
Reference
Recreation
News
Kids_and_Teens
Home
Health
Games
Computers
Business
Arts
Adult

●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

●

●
●
●

●
●
●

●
●
●

●
●
●

●
●
●

●
●
●

●

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

●

●

●
●
●

●
●
●
●
●
●
●
●
●
●

●
●

●

●

●

●

●

●
●

●

●

●
●
●

●

●

●
●

●

●

●
●

●

●

●
●

●

●
●
●

●

●
●

●

●

●
●
●

●

●

●
●
●

●

●

●

●

●

●

●

●
●

●
●
●
●
●

●
●

●
●

●
●
●
●

top5k
top50k
top1m
top100k

●
●
●
●

●
●
●
●

●
●
●
●

●
●
●

●
●
●

●

●

●
●

●

●

●
●

●

●

●

●

●

●

●

●
●
●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●
●
●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●
●

●

●

●

●

●

●

●

●

●

●

●

●

●
●
●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●
●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●
●

●

●

●

●
●

●

●

●

●

●

●

●

●

●

●

●
●
●
●
●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●
●

●

●

●

●

●

●

●

●

●

●

●

●

●
●
●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●
●

●

●

●

●

●
●
●

●

●
●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●
●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●
●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●
●

●
●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

●

C
a

t

e
g
o
r
y

P
o
p
u
a
r
i
t
y

l

||googlesyndication.co m/saf...
@ ||google.*/ads/user−lists...
@ ||googletag m anager.co m/gt...
@ ||stats.g.doubleclick.net...
@ ||googleads.g.doubleclick...
@ ||gstatic.co m ^$third − party
@ ||googleadservices.co m ^$t...

/pubads.
://ads.
/pagead2.

/w w w/delivery/*
/adserver.
##.adsbygoogle
||pub m atic.co m ^$third − party
##.banner_ad
/securepubads.
@ ||google.*/ads/conversion
17track.net,5ne w sonline.co m...
.openx.
||effective m easure.net^$thi...
@ ||fbexternal− a.aka m aihd.n...
||s m artadserver.co m ^$third −...
||bizographics.co m ^$third − p...
@ ||p.skim resources.co m/px....
?file=ads &
||advertising.co m ^$third − party
||p.skim resources.co m/px.gi...
||nexac.co m ^$third − party
/adim ages/*$~subdocu m ent
||m ookie1.co m ^$third − party
||adsrvr.org^$third − party
##ifra m e[id^="google_ads_if...
||tidaltv.co m ^$third − party
||serving − sys.co m ^$third − party
||criteo.net^$third − party
||ad.doubleclick.net^$~obje...
@ ||doubleclick.net/activit...
##div[id^="div − gpt− ad − "]
||revsci.net^$third − party
||adadvisor.net^$third − party
||criteo.co m ^$third − party
||a m azon − adsyste m.co m ^$thir...
||turn.co m ^$third − party
||krxd.net^$third − party
@ ||google.co m/adsense/sear...
||rubiconproject.co m ^$third...
||adnxs.co m ^$third − party
||adroll.co m ^$third − party
@ ||s.ytim g.co m/yts/s wfbin/...
@ ||fls.doubleclick.net^$su...

@

@

@

@

@

@

@

@

@

@

@

@

@

Figure 8: Filter matches per group ranking. Each row represents 1,000 domains within the respective Alexa ranking group. For each group we plot the
frequency each ﬁlter is triggered by domains in that group.

Total

Distinct

s
e

t
i

S

 
f

o

 

n
o

i
t
c
a
r
F

1.00

0.75

0.50

0.25

0.00

1

10

100

Number of Exception Filters

Figure 7: ECDF of ﬁlter matches per surveyed domain. We only include
domains with at least one match. A single ﬁlter may match multiple elements
(or requests) on a single domain; the solid line represents the total number of
matches while the dashed line is the number of unique matching ﬁlters.

for the most popular sites taken from Alexa. We chose the top 50
most frequently activated ﬁlters and found that the 5 most activated
ﬁlters out of both the EasyList and Whitelist were all ﬁlters from
the whitelist. These ﬁlters also related to Google. This implies that
these ﬁlters may be more broad than necessary.

We ﬁnd that the whitelist ﬁlters are skewed more towards shop-

ping websites, which we can attribute to the ﬁlter’s purpose.

We also ﬁnd that 4 of these ﬁlters were triggered more often by
the top 5,000 websites than by any of the other groups. There is one
ﬁlter that was used most often by the group of domains consisting
from Alexa rank 100,000 to 1,000,000. This particular ﬁlter is used
for conversion tracking.

6. USER PERCEPTION

Underlying the Acceptable Ads program is the goal that both
publishers and users ﬁnd the whitelisted ads to be acceptable. There
have been many studies of how users perceive Web advertisements
(e.g., [21]), and the degree to which they intrude on the user experi-
ence (e.g., [18]). In this section, we build on these efforts to survey
user perception of advertisements on popular websites based on the
criteria stated in Eyeo’s Acceptable Ads guidelines [1]. We used
Amazon’s Mechanical Turk [2] to solicit participation, limiting our
pool to workers with at least 5,000 approved submissions and at
least 98% approval rate. Each of the 305 respondents were paid
1$US and completed the 72 question survey in about 10 minutes.
50% of the users used some form of ad blocking software before,
with 61% using the Google Chrome browser, 28% using FireFox,
9% Safari, and 1% each for Opera and Internet Explorer. The results
of the survey are discussed below and shown in Figure 9.

The online survey showed eight different sites, each containing
one or more advertisements allowed by Adblock Plus. The eight
sites were selected based on their popularity and diversity of ad
placement. Speciﬁcally, we choose a search engine (Google), an
image hosting service (Imgur), an online retailer (Walmart), a Web
service (IsItUp.com), an online game forum (Utopia-game.com), a
humor website (Cracked.com), a viral content curator (ViralNova),
and a user-submitted content site (Reddit).

114S1: The advertisements are eye catching and grab my attention.

S2: The advertisements are clearly distinguished from page content.

Google #1
Google #2
Google #3
Imgur #1
IsItUp.com #1

Utopia #1
Utopia #2
Reddit #1
Reddit #2
Viralnova Taboola #1

Viralnova Taboola #2
Viralnova Taboola #3
Walmart #1
Cracked.com #1
Cracked.com #2

 75

 65

 55

 45

 35

 25

 15

 5

 75

 65

 55

 45

 35

 25

 15

 5

s
t
n
e
d
n
o
p
s
e
r
 
f
o
 
t
n
e
c
r
e
P

Google #1
Google #2
Google #3
Imgur #1
IsItUp.com #1

Utopia #1
Utopia #2
Reddit #1
Reddit #2
Viralnova Taboola #1

Viralnova Taboola #2
Viralnova Taboola #3
Walmart #1
Cracked.com #1
Cracked.com #2

Strongly disagree Disagree

Neutral

Agree

Strongly agree

Strongly disagree Disagree

Neutral

Agree

Strongly agree

(a) Attention grabbing advertisements

(b) Advertisement distinguished from content

S3: The advertisements on this page obscure page content or obstruct reading flow.

Google #1
Google #2
Google #3
Imgur #1
IsItUp.com #1

Utopia #1
Utopia #2
Reddit #1
Reddit #2
Viralnova Taboola #1

Viralnova Taboola #2
Viralnova Taboola #3
Walmart #1
Cracked.com #1
Cracked.com #2

s
t
n
e
d
n
o
p
s
e
r
 
f
o
 
t
n
e
c
r
e
P

s
t
n
e
d
n
o
p
s
e
r
 
f
o
 
t
n
e
c
r
e
P

 75

 65

 55

 45

 35

 25

 15

 5

Search Engine Marketing Advertisements

Attention Distinguished Obscuring

µ

VAR(X)

0.217
0.304

0.597
0.095

-0.260
0.219

Banner Advertisements

Attention Distinguished Obscuring

µ

VAR(X)

0.152
0.015

0.755
0.131

-0.613
0.042

Content Advertisements

Attention Distinguished Obscuring

µ

VAR(X)

-0.247
0.009

-0.935
0.305

0.125
0.178

Strongly disagree Disagree

Neutral

Agree

Strongly agree

(c) Advertisement obscuring content

(d) Mean and variance of the survey responses. Calculated by assigning
integer values [-2, 2] to the Likert scale, e.g., strongly disagree was given -2.

Figure 9: User perception survey results.

For each whitelisted advertisement, we asked the participants to
rate their level of agreement with statements relating to acceptability
on a Likert scale, e.g., “Strongly Disagree,” “Disagree,” “Neutral,”
“Agree,” or “Strongly Agree.” Each statement is a direct transcription
from the Adblock Plus policy (with minor adjustments for clarity)
and states characteristics that must or must not be true for an ad-
vertisement to be “acceptable”. Ideally, Adblock Plus should only
allow advertisements that meet these criteria.

Statement 1: The advertisements are eye catching and grab my
attention. - This ﬁrst statement measures the level of distraction
that the advertisement has on the user. There were two types of
advertisements that many users found to be attention grabbing or
distracting. Figure 10 shows two examples of the advertisements
deemed most attention getting, (10a, Google Ad #2, with 73%
agreeing or strongly agreeing) the image-based sales advertisements
displayed with search results on engines and, (10b, Utopia Ad
#2, 45%) the advertising bar next to navigation buttons on many
websites.

Statement 2: The advertisements are clearly distinguished from
page content. - This statement is designed to measure how well the
user can distinguish the advertisements from page content. Illus-
trated in Figure 10, the mixed content/advertising grid images used
in curator websites such as ViralNova appears to intentionally blur
the lines between advertisement and content. Almost 90% of users
viewing all grid-layout ads stated that they were not distinguished

from the content. Hence the allowance by Adblock Plus seems to
be in conﬂict with the program’s stated policies.

Statement 3: The advertisements on this page obscure page con-
tent or obstruct reading ﬂow. - This last statement measures the
degree to which users feel the ads are intrusive on content use. While
the mixed content/advertising grids seem to inhibit some content
use, other ad strategies were viewed as more invasive. In particular,
a little more than a third of users viewed sidebar advertisements
(e.g., Reddit #1, not shown), ﬁrst search results (Google #1), and
top bar advertisements (Cracked.com #1) as inhibiting.

Summary. While the above results are instructive, one must be
careful not to over-read the meaning of one survey. A summary of
the survey results in Figure 9(d) shows that there is broad dissension
amongst the participants about what was acceptable, confusing,
or inhibiting. However, this reenforces our experience; we have
observed that each person views advertisements differently—often
vastly so. Therefore, any single policy of whitelisting is unlikely
to serve the needs of a large and diverse user community well.
Developing deeper and larger studies of user desires is needed to
develop a better understanding of user preferences and ultimately a
more precise and ﬂexible advertisement blocking policy.

7. UNDOCUMENTED FILTERS

Over the course of our analysis outlined in the previous sections,
we discovered several instances where ﬁlters were added without

115(a) Google Ad#2

(b) Utopia Ad#2

(c) ViralNova Ad#1

Figure 10: Survey advertisement examples.

community vetting or public disclosure. For completeness, we
discuss two representative instances here.

Google’s introduction. Google was ofﬁcially added to the whitelist
on June 21, 2013 (Rev. 200).17 Prior to this, Eyeo allowed some
publishers (but not all) to show Google AdSense for search ads on
their own search pages. Of particular note among these exceptions
are the two ﬁlters added for golem.de (Rev. 67, Dec. 2012).18

! A6
@@ || Ask . com ^ $elemhide
@@ || us . ask . com ^ $elemhide
@@ || uk . ask . com ^ $elemhide

! A29
@@ || google . com / adsense / search / ads .

js$domain = search . comcast . net

1

2

@@ || google . com / ads / search / module / ads /*/

@@ || google . com / ads / search / module / ads /*/

search . js$domain = suche . golem . de | www .
google . com

www . google . com # @ ## adBlock

search . js$script , domain = search .
comcast . net

@@ || google . com / afs / $script , subdocument ,

document , domain = search . comcast . net

These exception ﬁlters are structured differently than previous Ad-
Sense ﬁlters. Namely, the ﬁrst exception speciﬁes both golem.de
and www.google.com in the domain list. This is unusual as the
addition of Google in the ﬁrst-party domain option is not neces-
sary for showing search advertisements on golem.de. Rather, this
option makes the ﬁlter active on www.google.com. The second
ﬁlter is even more unusual as it unblocks the adBlock element
on www.google.com, i.e., the ﬁlter does not make any reference
to golem.de. None of the previous AdSense exceptions included
analogous ﬁlters.

Roughly two weeks later, Eyeo modiﬁed these ﬁlters19 to match
other restricted AdSense exceptions. In particular, they removed
www.google.com from the domain list in the ﬁrst ﬁlter and deleted
the second ﬁlter entirely.

1

@@ || google . com / ads / search / module / ads /*/

search . js$domain = suche . golem . de

The forum post for the golem.de ﬁlters does not provide any ra-
tionale for the initial dissimilarities between these other AdSense
exceptions, nor does it indicate the purpose of the later changes (or
even mention such changes were made). However, during the two
weeks the original ﬁlters were active, Google could conceivably
have used the ﬁlters (especially the element ﬁlter) to measure the
impact of whitelisting by adding an element with id adBlock. This
element would be active via the whitelist when normal ads were not.

17hg.adblockplus.org/exceptionrules/rev/8bdf815a5291
18hg.adblockplus.org/exceptionrules/rev/feb913d65a21
19hg.adblockplus.org/exceptionrules/rev/9c5f8032d88b

! A46
@@ || kayak . com . au ^ $elemhide
@@ || kayak . com . br ^ $elemhide
@@ || checkfelix . com ^ $elemhide

! A50
@@ || twcc . com ^ $elemhide
@@ || google . com / adsense / search / ads .

js$domain = twcc . com

@@ || google . com / ads / search / module / ads /*/

search . js$script , domain = twcc . com

Figure 11: Subset of A-ﬁlter groups. In contrast to typical ﬁlters, A-ﬁlter
groups do not contain a comment with a link to the forum. Insofar as we can
determine, none of these ﬁlters were publicly disclosed by Eyeo. In total, we
uncovered 59 A-ﬁlter groups.

A-List ﬁlters. There are 61 instances of Eyeo adding whitelist ﬁlters
without community vetting—many of which are exceptions for large
companies. We refer to these as A-ﬁlters because of the nondescript
comments preceding each group in the whitelist, e.g. !A1. Figure 11
shows four example sets. Insofar as we can determine, none of
these ﬁlters were publicly disclosed. In other words, none of the
A-ﬁlter groups appear in Eyeo’s notiﬁcation forum. Nearly all A-
ﬁlter additions use the same repository commit message, “Updated

116whitelists.”20 In contrast, for other ﬁlters, Eyeo includes a link to
the appropriate forum post in both the commit message and with a
comment in the whitelist itself.

Eyeo ﬁrst added A-ﬁlters in Rev. 28721, with sets A1 and A2.
Since the addition of these ﬁrst ﬁlters, Eyeo has continued to add A-
ﬁlters to the whitelist. The most recent one being A61 in Rev. 955.22
Over time they have also removed 5 A-ﬁlter groups; one of these
was re-added as a different A-ﬁlter, i.e. A7 as A28 in Rev. 625.23
Among the ﬁlters added are exceptions for large companies such
as Walmart and Time Warner Cable. Domains within an A-ﬁlter
group appear to be closely related, possibly under the same parent
organization, e.g., media company IAC owns both about.com and
ask.com.24

In Rev. 78925 Eyeo added A59. This ﬁlter group includes an unre-
stricted ﬁlter for Google’s AdSense for search service. Speciﬁcally,
this ﬁlter allows nearly all domains to show Google search ads.26
As we see in Table 4, this AdSense exception was the ninth most
popular ﬁlter in our survey, having been observed on 78 distinct
domains.

8.

INCREASING TRANSPARENCY

Acceptable Ads can beneﬁt both users and publishers. Users are
no longer subjected to annoying and intrusive advertising, while
publishers—who use advertising as the primary means to support
their work—can avoid erecting paywalls or reducing content. How-
ever, our analysis suggests several program areas in need of im-
provement. Namely, the current process lacks full transparency.
Such transparency is essential for this laudable tradeoff between
user desires and economic needs to become reality.

We largely agree with the Acceptable Ads criteria, but recommend
that Eyeo take additional steps to reassure users that the company is
acting in good faith. We recommend the following for improving
the whitelisting process and policies.

Disclose ﬁnancial entanglements. Other than a few isolated exam-
ples, users must guess at which ﬁlters and domains originate from a
paid agreement. Eyeo claims that roughly 90% of those companies
added to the list did not have to pay, however full disclosure of
these statistics would strengthen public trust in the Acceptable Ads
initiative.

Eyeo should clearly identify why certain sites have to pay and
others do not. Eyeo states that whitelisting is free for small and
medium-sized sites, but they do not say how they make this deter-
mination or if this is the only criterion. For instance, Alexa ranks
reddit.com higher than Microsoft’s Bing search; however, the for-
mer has stated they do not pay for their whitelist exceptions, while
the latter does. Further, do all whitelisted ad networks pay Eyeo?

Public disclosure of whitelist agreements is especially impor-
tant when one considers that a single company may own multiple
domains. For instance, both ask.com and about.com are in the
whitelist, and both are owned by the same parent company, IAC.27

Document all whitelist modiﬁcations. Currently, Eyeo notiﬁes
their users of whitelist changes through their online forum. However,

20 Rev. 304 used the message “Added new whitelists.”
21hg.adblockplus.org/exceptionrules/rev/b60864b2ab92
22hg.adblockplus.org/exceptionrules/rev/5a666fbe3612
23hg.adblockplus.org/exceptionrules/rev/8a9d97588927
24http://iac.com/brands
25hg.adblockplus.org/exceptionrules/rev/c182d9dc5600
26The ﬁlter deﬁnes a set of 43 domains for which the AdSense ﬁlter
will not apply.
27http://iac.com/brands

as we discussed in previous sections, Eyeo does not give all ﬁlters
the chance to be publicly vetted, e.g. kayak.com. It is unclear why
some proposals are included in the forums and others are not.

The inclusion of forum links and a short description for groups of
ﬁlters contained in the whitelist allow users to easily ﬁnd relevant
information. However, ﬁlter groups with nondescript titles, e.g. A3,
are opaque.

Avoid overly general ﬁlters. A single unrestricted (or sitekey) ﬁlter
in the whitelist may apply to any number of domains, making it
impossible for a user to determine the ﬁlter’s full scope. Overly
general ﬁlters obscure whitelist understanding.

Identify whitelisted advertisements. In Google Chrome, the Ad-
block Plus extension logo includes a number indicating the number
of blocked elements on the page. Moreover, a greyed-out logo ap-
pears when the user manually disables Adblock Plus on a page. How-
ever, there is no visible indication as to the number of whitelisted
elements. Conversely, the Firefox version includes a “Blockable
Items” toolbar that displays a list of page objects along with any trig-
gered ﬁlters and the list from where the ﬁlter originates: EasyList,
whitelist, etc. All Adblock Plus versions would beneﬁt from such
functionality by allowing interested users to determine which page
elements were blocked and which ones were allowed (and why).

Practice good whitelist hygiene. The whitelist contains redundant,
obsolete, and malformed ﬁlters. In addition to 35 duplicate ﬁlters,
we observed at least 8 malformed exception ﬁlters, all of which
appear to have been erroneously truncated (in Rev. 326) at a max
length of 4095 characters. Similarly, AdSense for search exceptions
are no longer required for individual domains. A process for retiring
needed ﬁlters should be created and documented; and superﬂuous,
malformed, and outdated ﬁlters should be purged.

9. CONCLUSIONS

This paper provides an analysis of Acceptable Ads: a program
with the goal of changing Internet advertising for the better by allow-
ing non-intrusive ads. Our study shows that the program has grown
aggressively over the last four years. There is a diversity of sites
being whitelisted, but a seeming (and understandable) concentration
of whitelisting on popular sites. Yet, the complexity of the lists and
their interaction with other web systems makes a full understanding
difﬁcult.

To us, the way forward seems clear. Public disclosures of ﬁnan-
cial relationships and more process transparency will foster trust and
allow users to make informed choices about how they use blocking
and ultimately what sites they visit. This community voice is essen-
tial because an open discussion is perhaps the only means of reach-
ing a universally acceptable resolution in the blocking/whitelisting
debate.

10. ACKNOWLEDGMENTS

Research was sponsored by the Army Research Laboratory and
was accomplished under Cooperative Agreement Number W911NF-
13-2-0045 (ARL Cyber Security CRA). The views and conclusions
contained in this document are those of the authors and should not be
interpreted as representing the ofﬁcial policies, either expressed or
implied, of the Army Research Laboratory or the U.S. Government.
The U.S. Government is authorized to reproduce and distribute
reprints for Government purposes notwithstanding any copyright
notation here on.

11711. REFERENCES
[1] Allowing acceptable ads in adblock plus.

https://adblockplus.org/en/acceptable-ads.
Accessed Sept. 2014.

[2] Amazon mechanical turk.

https://www.mturk.com/mturk/welcome. Accessed April,
2015.

[3] Is adblock plus for chrome (formerly adthwart) superior...
https://adblockplus.org/forum/viewtopic.php?f=
10&t=6509, Dec. 2010.

[4] S. Alrwais, K. Yuan, E. Alowaisheq, Z. Li, and X. Wang.

Understanding the dark side of domain parking. In
Proceedings of the 23rd USENIX Security Symposium, 2014.
[5] B. Brinkmann. Wie adblock plus mit werbung geld verdient.

http://www.sueddeutsche.de/digital/
browsererweiterung-in-der-kritik-wie-adblock-
plus-mit-werbung-geld-verdient-1.1715051, July
2013. Accessed Oct. 2014.

[6] H. Cett. Adblock founder faida calls for transparency in ad
industry. http://www.gomonews.com/adblock-founder-
faida-calls-for-transparency-in-ad-instustry/,
Dec. 2013. Accessed Feb. 2015.

[7] N. Chachra, D. McCoy, S. Savage, and G. Voelker.

Empirically characterizing domain abuse and the revenue
impact of blacklisting. In Proceedings of the Workshop on the
Economics of Information Security (WEIS), 2014.

[8] N. Cohen. An ad blocker opens the gate, ever so slightly.

http://www.nytimes.com/2012/01/02/business/media/
adblock-plus-allowing-some-online-
advertisements.html?pagewanted=all&r=1&_r=0, Jan.
2012.

[9] R. Cookson. Google, microsoft and amazon pay to get around

ad blocking tool.
http://www.ft.com/intl/cms/s/0/80a8ce54-a61d-
11e4-9bd3-00144feab7de.html#axzz3QbaQtkaZ, Feb.
2015. Accessed Feb. 2015.

[10] F. Dahlke. Adblock plus 1.3.3 for opera released.

https://adblockplus.org/releases/adblock-plus-
133-for-opera-released, Nov. 2012.

responds-to-german-lawsuit, July 2014. Accessed Jan.
2015.

[17] K. Levchenko, A. Pitsillidis, N. Chachra, B. Enright,

M. Félegyházi, C. Grier, T. Halvorson, C. Kanich, C. Kreibich,
H. Liu, et al. Click trajectories: End-to-end analysis of the
spam value chain. In Security and Privacy (SP), 2011 IEEE
Symposium on, pages 431–446. IEEE, 2011.

[18] H. Li, S. M. Edwards, and J.-H. Lee. Measuring the

intrusiveness of advertisements: Scale development and
validation. Journal of advertising, 31(2):37–47, 2002.

[19] Z. Li, K. Zhang, Y. Xie, F. Yu, and X. Wang. Knowing your

enemy: understanding and detecting malicious web
advertising. In Proceedings of the 2012 ACM conference on
Computer and communications security, pages 674–686.
ACM, 2012.

[20] D. McCoy, A. Pitsillidis, G. Jordan, N. Weaver, C. Kreibich,

B. Krebs, G. M. Voelker, S. Savage, and K. Levchenko.
Pharmaleaks: Understanding the business of online
pharmaceutical afﬁliate programs. In Proceedings of the 21st
USENIX conference on Security symposium, pages 1–1.
USENIX Association, 2012.

[21] S. McCoy, A. Everard, P. Polak, and D. F. Galletta. The

effects of online advertising. Commun. ACM, 50(3):84–88,
Mar. 2007.

[22] M. McHugh. Media maﬁosos: Is adblock plus shaking down

websites for cash to let ads through?
http://www.digitaltrends.com/web/adblock-plus-
accused-of-shaking-down-websites/, Feb. 2013.

[23] M. McHugh. Media maﬁosos: is adblock plus shaking down

websites for cash to let ads through?
http://www.digitaltrends.com/web/adblock-plus-
accused-of-shaking-down-websites/, Feb. 2013.
Accessed Jan. 2015.

[24] R. L. Mitchell. The business of ad blocking: A q&a with

adblock plus lead investor tim schumacher. http:
//www.computerworld.com/article/2475721/desktop-
apps/the-business-of-ad-blocking--a-q-a-with-
adblock-plus-lead-investor-tim-schumacher.html,
Jan. 2014.

[11] M. Ermert. First court hearing of broadcasters and adblock

[25] S. Noack. Adblock plus for safari beta released.

plus.
http://policyreview.info/articles/news/first-
court-hearing-broadcasters-and-adblock-plus/347,
Dec. 2014. Accessed Dec. 2014.

[12] S. Gandhe. Adblock plus sued by german marketing

companies. http://www.neowin.net/news/adblock-plus-
sued-by-german-marketing-companies, July 2014.
Accessed Jan. 2015.

[13] IAB. Q3 2014 internet advertising revenues hit $12.4 billion,

making it the highest quarter on record. http://
www.iab.net/about_the_iab/recent_press_releases/
press_release_archive/press_release/pr-121814,
Dec. 2014.

[14] C. Kanich, N. Weaver, D. McCoy, T. Halvorson, C. Kreibich,

https://adblockplus.org/releases/adblock-plus-
for-safari-beta-released, Jan. 2014.

[26] PageFair. Acceptable ads soothe google pain.

http://blog.pagefair.com/2013/acceptable-ads-
soothe-google-pain/?cmp=17, Aug. 2013. Accessed Oct.
2014.

[27] PageFair and Adobe. Adblocking goes mainstream 2014

report. http://downloads.pagefair.com/reports/
adblocking_goes_mainstream_2014_report.pdf, Sept.
2014. Accessed Oct. 2014.

[28] W. Palant. Adblock plus for google chrome (beta) 1.0.22

released. https://adblockplus.org/releases/adblock-
plus-for-google-chrome-beta-1022-released, Dec.
2010.

K. Levchenko, V. Paxson, G. M. Voelker, and S. Savage.
Show me the money: Characterizing spam-advertised revenue.
In USENIX Security Symposium, pages 15–15, 2011.

[29] W. Palant. Adblock plus 1.0 for internet explorer released.
https://adblockplus.org/releases/adblock-plus-
10-for-internet-explorer-release, Aug. 2013.

[15] L. Kelion. Adblock plus defeats german publishers in court.
http://www.bbc.com/news/technology-32409952, April
2015. Accessed April, 2015.

[16] L. Leong. Adblock plus responds to german lawsuit.

http://news.en.softonic.com/adblock-plus-

[30] W. Palant. Adblock plus for android removed from google
play store. https://adblockplus.org/blog/adblock-
plus-for-android-removed-from-google-play-store,
Mar. 2013.

118[31] L. Stampler. Google saved an estimated $887 million by

paying adblock plus to show its ads.
http://www.businessinsider.com/google-saved-an-
estimated-887-million-by-paying-adblock-plus-
to-show-its-ads-2013-8, Oct. 2013. Accessed Oct. 2014.

[32] J. Steinschaden. Google ist geldgeber von adblock plus.

http://www.horizont.at/home/detail/google-ist-
geldgeber-von-adblock-plus.html, July 2013. Accessed
Oct. 2014.

hﬁlteri ::= hblockingi

|

hexceptioni

hblockingi ::= hrequesti

|

helement-hidei

hexceptioni ::= ‘@@’hrequesti

|
|

helement-exceptioni
hsitekeyi

[33] B. Williams. Restating the obvious: adblocking declared legal.

hsitekeyi ::= ‘@@$sitekey=’hpub-keyi∗(‘|’hpub-keyi)#([‘∼’]hoptioni)

https://adblockplus.org/blog/restating-the-
obvious-adblocking-declared-legal, April 2015.

[34] A. Zarras, A. Kapravelos, G. Stringhini, T. Holz, C. Kruegel,

and G. Vigna. The dark alleys of madison avenue:
Understanding malicious advertisements. In Proceedings of
the 2014 Conference on Internet Measurement Conference,
pages 373–380. ACM, 2014.

APPENDIX

A. FILTER SYNTAX

A ﬁlter is structured like a regular expression with additional
modiﬁers and options for changing action and scope. A blocking
ﬁlter prevents web content from loading or showing, and an excep-
tion ﬁlter overrides blocking ﬁlters to allow content. Options and
modiﬁers adjust the scope of ﬁlters to affect only speciﬁc content or
domains.

Adblock Plus provides documentation for the syntax of ﬁlters on
its website.28 Although Adblock Plus uses regular expressions to
parse ﬁlters, we provide a BNF grammar in Figure 12, which can be
used to understand how ﬁlters are created.

A.1 Blocking Filters

The simplest blocking ﬁlter is hrequesti with just hrequest-matchi.
The hrequest-matchi is made primarily of a regular expression that
deﬁnes the path to be blocked, hregex-URL-pathi. The ﬁlter expres-
sion

1

http :// example . com / ads / advert777 . gif

will block the speciﬁed gif advertisement loaded from the given
address. The use of wildcards can increase the effectiveness of a
single ﬁlter. For convenience, each ﬁlter regular expression has
an implicit wildcard operator at the beginning and end of the ﬁlter
expression. For instance, the ﬁlter expression, /ad-frame/, will
affect any domain and will block all page elements that are requested
from the ad-frame subdirectory.

A ‘|’ can be added at the beginning or end of hregex-URL-pathi
to override the implicit wildcard operators. Additionally, the ‘||’
string appears before a domain to allow subdomains and multiple
protocols, such as http:// and https://. The following ﬁlter

1

|| example . com / ad . jpg |

matches both http://good.example.com/ad.jpg and https://
example.com/ad.jpg, but not https://example.com/ad.jpg.
exe.

Moreover, the ‘ˆ’ character matches any and all separator char-
acters within a URL, and may be placed at the beginning or end of
hregex-URL-pathi. Separator characters appear as “anything but a
letter, a digit, or one of the following: _ - . %.”29 For example,
the ﬁlter

28https://adblockplus.org/en/filters
29https://adblockplus.org/en/filters#separators

hrequesti ::= hrequest-matchi[‘$’1#(hno-neg-opti | [‘∼’]hoptioni)]

helement-hidei ::= #([‘∼’]hpage-domaini)‘##’helem-selectori

helemhide-excepti ::= #([‘∼’]hpage-domaini)‘#@#’helem-selectori

hrequest-matchi ::= [‘||’ | ‘|’ | ‘ˆ’]hregex-URL-pathi[‘|’ | ‘ˆ’]

hoptioni ::= ‘script’

|
|
|
|
|
|
|
|
|
|
|

‘image’
‘stylesheet’
‘object’
‘xmlhttprequest’
‘object-subrequest’
‘subdocument’
‘document’
‘elemhide’
‘other’
‘third-party’
‘collapse’

hno-neg-opti ::= ‘domain=’[‘∼’]hpage-domaini

∗(‘|’[‘∼’]hpage-domaini)
‘sitekey=’hpub-keyi ∗(‘|’hpub-keyi)
‘match-case’
‘donottrack’

|
|
|

Figure 12: Adblock Plus Filter Syntax BNF Grammar.

1

^ www . google . com ^

will match http://www.google.com/#q=foo, where the sepa-
rator characters are bolded, but this expression will not match
http://scholar.google.com due to the replacement of www with
scholar.

Request Filters and Options. While a request ﬁlter can consist of
only a regular expression with modiﬁers, the addition of options can
tune the scope of a request ﬁlter. The ‘$’ character is placed after
hrequest-matchi to indicate the start of an option list. An option
list consists of 1 or more hoptionis or hno-neg-optis separated by
a comma. A ‘∼’ character is the negation operator, and it can
be coupled with an hoptioni to apply the inverse. However, there
are some options that cannot be negated: hno-neg-opti. Refer to
Section A.4 for more information on each ﬁlter option.

Element Hiding. Elements refer to text or page areas embedded
into the web page itself through the source code. An element hiding
ﬁlter is required to hide and block these elements. The element
hiding ﬁlter requires at least ‘##’ followed by helem-selectori to
match the target page elements.

119The helem-selectori is most commonly a CSS element selec-
tor,30 however this is not always the case.31 Selectors can name
the element explicitly, as ##.ButtonAd, or just specify the id at-
tribute to hide, ###sideads, which is a more general match. Like
hregex-URL-pathi, selectors may contain regular expressions.

In the current implementation of Adblock Plus, restricting el-
ement hiding ﬁlters to a certain domain requires the use of full
domain names.32 Multiple domains are separated by a comma and
apply to the same selector:

1

mnn . com , streamtuner . me ### adv

A negation operator, ‘∼’, may also be applied to domain names to
create an exception for element hiding ﬁlter.

A.2 Exception Filters

An exception ﬁlter allows the user to view page content that would
otherwise be blocked by one or more blocking ﬁlters. Exception
ﬁlter syntax is very similar to that of blocking ﬁlters. An hexceptioni
can be either a hrequesti or an helement-exceptioni, like blocking
ﬁlters. The main differences are found at the beginning of request
ﬁlters and in the middle of element ﬁlters.

Request Filters. An exception hrequesti ﬁlter takes the form of
‘@@’hrequesti, where ‘@@’ must preﬁx all hrequestis. Refer to Sec-
tion A.1 and the formation of hrequesti for further details. If only
hrequesti appears in the ﬁlter (no options), then the string acts like
a regular expression and matches all requests containing that string.
The following example appears in the whitelist allowing Dou-

bleClick advertisements on references.net:

1

@@ || g . doubleclick . net / pagead / $subdocument

, domain = references . net

The ‘domain’ option speciﬁes the domain for which this ﬁlter ap-
plies, and the ‘subdocument’ option indicates that the DoubleClick
advertisement will be embedded in the ‘references.net’ page.

Element Filters. Element exception ﬁlters allow page elements
to be viewed. An helemhide-excepti is very similar in form to
helem-hidei. However, instead of the string ‘##’ for element hiding,
an helemhide-excepti uses ‘#@#’ to denote that it is an exception.
Refer to Section A.1 for more information on element hiding.

The next example also appears in the whitelist and is an ele-
ment hide exception that allows references.net to show the above
DoubleClick ad example on the page.

1

references . net # @ #. adunit

Without this ﬁlter, a request to DoubleClick is established and the ad
is loaded, but an element hiding ﬁlter hides it from view. The struc-
ture of this ﬁlter includes hpage-domaini ﬁrst, and the element’s
class name, ‘.adunit’, second.

A.3 Sitekey Filters

Sitekey ﬁlters primarily occur as exception ﬁlters with ‘document’
as hoptioni, to allow all advertisements. These ﬁlters cover all sites
that return a valid public key and signature. Section 4.2.3 explains
how sitekeys work.

The syntax for hsitekeyi is an exception hrequesti without a
hrequest-matchi and only specifying ‘sitekey’ and ‘document’ as
hoptionis:

1

@@$sitekey = MFwwDQYJK ... wEAAQ , document

30http://www.w3.org/TR/css3-selectors/
31See https://adblockplus.org/en/filters#elemhide for
more details.
32https://adblockplus.org/en/filters#elemhide_domains

The ‘sitekey’ option is given an RSA public key created by a
multi-domain owner, e.g., Sedo. The ﬁlter matches all domains that
have the same public sitekey and return a signature signed with the
private RSA key. The ‘document’ option indicates that the entire
page is permitted to show ads; even allowing third-party requests.

A.4 Filter Options Explained

Filters may include a number of options to further specify their
effects on page elements and scope.33 An overview of these ﬁlters
is presented in the following text.

Some options can be grouped by the speciﬁc type of element
loaded from the request. For instance, ‘script’ limits the ﬁlter
to block (or whitelist for exception ﬁlters) the HTML script tag
that loads external scripts. Other similar options include ‘image’,
‘stylesheet’, ‘object’ (where browser plugins like Flash or Java
handle page content), ‘xmlhttprequest’ (for requests by the XML-
HttpRequest object34), ‘object-subrequest’ (for requests started
by browser plugins), and ‘subdocument’ (for pages that are embed-
ded within the page, usually through HTML frames). The ‘other’
option covers requests that are absent from the previous list.

Additional options specify a broader content selection. The
‘document’ option may only be included in an exception ﬁlter and
disables all blocking ﬁlters on affected domains and requests. Simi-
larly, ‘elemhide’ also only applies to exception ﬁlters and disables
all element-hiding ﬁlters. In contrast, the ‘third-party’ option
limits a ﬁlter only to external requests from a different origin than
the current web page. These and all previous options can be preﬁxed
with ‘∼’ to invert their original meaning.

Further, the ‘domain’ option restricts the ﬁlter to certain domains,
which are separated by commas. To not apply the ﬁlter on a certain
domain, the domain can be preﬁxed with the negation operator. If
the ‘domain’ option is not speciﬁed, the request ﬁlter applies to all
domains.

More options are also included in the ﬁlter syntax. The option
‘match-case’ ensures that the request is matched on a case-sensitive
basis. A ‘collapse’ option will guarantee that the element is hid-
den.35 The ‘collapse’ option can also be negated. A ‘donottrack’
option will send a Do-Not-Track header36 to the web page as long
as there is no matching exception rule with a ‘donottrack’ option
on the same page.

Finally, there are deprecated options that still exist for backwards
compatibility, but their use is discouraged: ‘background’, ‘xbl’,
‘ping’, and ‘dtd’.37

33https://adblockplus.org/en/filters#options
34http://www.w3.org/TR/XMLHttpRequest/
35This option is only found once in EasyList and might be depre-
cated.
36http://donottrack.us/
37https://adblockplus.org/en/filters#options

120