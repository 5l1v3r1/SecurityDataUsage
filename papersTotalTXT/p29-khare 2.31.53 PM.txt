Concurrent Preﬁx Hijacks: Occurrence and Impacts∗

Varun Khare

vkhare@cs.arizona.edu
The University of Arizona

Qing Ju

qingju@cs.arizona.edu
The University of Arizona

Beichuan Zhang

bzhang@cs.arizona.edu
The University of Arizona

ABSTRACT
A concurrent preﬁx hijack happens when an unauthorized
network originates IP preﬁxes of multiple other networks.
Its extreme case is leaking the entire routing table, i.e., hi-
jacking all the preﬁxes in the table. This is a well-known
problem and there exists a preventive measure in practice
to safeguard against it. However, we investigated and un-
covered many concurrent preﬁx hijacks that didn’t involve
a full-table leak. We report these events and their impact
on Internet routing. By correlating suspicious routing an-
nouncements and comparing it with a network’s past routing
announcements, we develop a method to detect a network’s
abnormal behavior of oﬀending multiple other networks si-
multaneously. Applying the detection algorithm to BGP
routing updates from 2003 through 2010, we identify ﬁve to
twenty concurrent preﬁx hijacks every year, most of which
are previously unknown to the research and operation com-
munities at large. They typically hijack preﬁxes owned by a
few tens of networks, last from a few minutes to a few hours,
and pollute routes at most vantage points.

Categories and Subject Descriptors
Computer Systems Organization [Computer-Communication
Networks]: Network Operations—Network Monitoring

General Terms
Algorithms, Measurement, Veriﬁcation

Keywords
BGP Security, Preﬁx Hijacking
∗The material in this article is based upon the work par-
tially supported by DHS grant N66001-08-C-2028 and by
Open Project of Shenzhen Key Lab of Cloud Computing
Technology & Applications (SPCCTA). Any opinions, ﬁnd-
ings, and conclusions or recommendations expressed in this
material are those of the author(s) and do not necessarily
reﬂect the views of the sponsors.

Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
IMC’12, November 14–16, 2012, Boston, Massachusetts, USA.
Copyright 2012 ACM 978-1-4503-1705-4/12/11 ...$15.00.

1.

INTRODUCTION

The Internet is an interconnection of tens of thousands of
independently administered Autonomous Systems (ASes),
which originate their allocated IP preﬁxes to the Internet
via the Border Gateway Protocol (BGP). Due to the lack of
authentication of BGP messages, an unauthorized network
can originate preﬁxes owned by other networks [24, 18], i.e.,
hijacking other preﬁxes, to divert traﬃc for those preﬁxes to-
wards unauthorized network. Malicious attackers have been
known to use preﬁx hijacking to hide their network iden-
tity in sending spam [28], inﬂict denial-of-service attacks by
dropping traﬃc, or even manipulate content of the traﬃc be-
fore forwarding it to destination [14]. Conﬁguration errors
in BGP routers have also caused preﬁx hijacking, leading to
service outages for other networks.

A concurrent preﬁx hijack is an event where an unau-
thorized network announces preﬁxes of multiple other net-
works. Its extreme case is leaking the entire routing table,
i.e., hijacking all the preﬁxes in its BGP table. The ﬁrst
well-known case of such preﬁx hijacking is the full table
leak from AS 7007 [1] on April 25, 1997, which lasted for
hours and disrupted services for many networks. A more
recent event was in September 2008 when AS 8997 falsely
announced 117K preﬁxes [3].

A commonly held belief is that full-table or near full-table
leaks is becoming rare. The wide awareness of the problem
helps reduce conﬁguration errors and a new BGP conﬁgura-
tion option called “max-preﬁx limit” helps stop such leaks.
Once conﬁgured for a BGP session, the max-preﬁx limit
speciﬁes the maximum number of preﬁxes that can be re-
ceived from a peer, and if that limit is exceeded, the BGP
session by default is reset to stop the potential table leak.
However without actual data on preﬁx hijacks it is unclear
if such a belief is close to reality. Furthermore it is unclear
whether concurrent preﬁx hijacks of medium or small scales
happen on the Internet or not. If they do occur then what
are their characteristics, e.g., when did they occur, who in-
stigated them, how many victim preﬁxes were hijacked, how
often did they happen and how long did they last, etc.

Detecting preﬁx hijacks is a hard problem. Existing tech-
niques fall into two categories. In schemes such as [16, 23,
10, 32, 34], authoritative preﬁx ownership is known a priori
and is used to compare against observed routing messages or
forwarding paths. The knowledge of preﬁx ownership allows
accurate detection of preﬁx hijacks, but in many scenarios
complete and up-to-date ownership information is not avail-
able. Detection schemes such as [6, 4, 29, 27] do not require
such authoritative information. They collect preﬁx origin

29information from routing updates or Internet registrars and
apply various ﬁlters to identify suspicious events. However,
since preﬁx hijacks and some legitimate operational prac-
tices have similar behaviors [33], pinpointing real hijacks
without preﬁx ownership information has been a notoriously
hard problem. These schemes usually generate a large num-
ber of alarms, many of which may be false positives.

While individual hijacks are diﬃcult to identify, concur-
rent hijacks are relatively easier even without preﬁx own-
ership information. When a network originates preﬁxes of
another network, it can be a hijack or due to an operational
arrangement not known to the public. But when a net-
work simultaneously originates preﬁxes of many other net-
works, it is highly likely to be a real hijack since operational
arrangements with many diﬀerent networks are unlikely to
take eﬀect at the same time. Based on this observation, we
develop a scheme that detects concurrent preﬁx hijacks by
correlating suspicious origin announcements and identifying
networks that are oﬀending many other networks simultane-
ously. In order to facilitate real-time detection and reaction,
we tune the scheme’s parameters to minimize false positives.
Applying this scheme to RouteViews Oregon BGP data
from 2003 through 2010, we detect 5 to 20 concurrent preﬁx
hijacks each year. They typically hijack preﬁxes of a few
tens of other networks, last from a few minutes to a few
hours, and pollute routes at most vantage points, meaning
that the damage to data traﬃc could be widespread. We
verify detected events in 2008, 2009, and 2010 via email
communication with network operators. We sent 582 emails
and received 63 valid replies, from which 53 conﬁrmed pre-
ﬁx ownership, and 51 of those conﬁrmed an individual preﬁx
hijack. All the 21 detected events were conﬁrmed as real hi-
jacks as each event had at least one conﬁrmed individual
preﬁx hijack. This means that our scheme detected concur-
rent preﬁx hijacks with zero false positive in these three years
. Interestingly most events are not mentioned in operator
mailing lists such as NANOG [9] or identiﬁed in research
literature, implying that the network community in general
is not aware of these hijacks. Furthermore, most operators
of victim preﬁxes told us that they were unaware of their
preﬁxes being hijacked. To our best knowledge, this is the
ﬁrst time these under-radar preﬁx hijacks are discovered,
veriﬁed, and documented.

The rest of the paper is organized as follows. Section 2
describes the detection scheme. Section 3 reports detected
incidents and analyzes the results. We discuss related work
in Section 4 and conclude the paper in Section 5.

2. THE DETECTION ALGORITHM

While our current focus is to identify and analyze con-
current preﬁx hijacks from archived data, we also have a
long-term goal of being able to automatically detect and re-
solve these hijacks based on real-time BGP updates. There-
fore we have the following two requirements on the detec-
tion algorithm: (1) requiring no authoritative preﬁx own-
ership information, and (2) minimizing false positives. The
ﬁrst one allows anyone who has access to BGP updates to
be able to detect preﬁx hijacks. For example, if YouTube
preﬁxes are hijacked, any ISP or monitoring service (e.g.,
Cyclops [16]) that has received the false routing announce-
ments would be able to detect it. The second requirement
allows fast response to hijacks. If there are signiﬁcant false
positives, operators have to be involved to judge whether

a detected event is a real hijack or not, which takes time.
For instance, when a YouTube preﬁx was hijacked in 2008,
it took 80 minutes for YouTube to launch the ﬁrst counter-
measure [13]. Minimizing false positives helps automate and
speed up response to detected hijacks. Inevitably our detec-
tion algorithm will have more false negatives. These are
easily covered by existing detection schemes which report a
large number of suspicious events and can be examined by
operators later.

The current detection algorithm processes archived BGP
tables and updates in ﬁve steps to detect routing events
where one network hijacks preﬁxes of multiple other net-
works at the same time.

Step A: single view of origin changes.

We collect preﬁx origin changes observed from a single
BGP monitor. Every BGP update contains a preﬁx and an
AS path, and we treat the last AS in AS path as origin of
the preﬁx. As we process data yearly, the algorithm reads
all BGP tables and updates from a single monitor in one
year and records which AS originates which preﬁx during
which time period. This time series of (preﬁx, origin AS)
set forms a single monitor’s view of origin changes.

Step B: global view of origin changes.

Since BGP is a path vector protocol, diﬀerent monitors
see diﬀerent things depending upon where they are relatively
to the routing events. When a network hijacks preﬁxes of
multiple other networks, some monitors may not see it at
all, and some monitors may only see part of it. Therefore
in the second step we combine the single views of individual
monitors into a global view of origin changes. The result is
a time series of (preﬁx, origin AS) set over the entire year.
It is origin AS set because a preﬁx can be announced by
multiple ASes for legitimate reasons [33].

Step C: ﬁlter out potentially legitimate changes.

Since many origin changes are legitimate, in this step we
try to ﬁlter them out to reduce noise in later steps. Ac-
curately identifying all legitimate origin changes is almost
impossible, otherwise we would be able to identify all preﬁx
hijacks accurately. What we do here is to run a few best-
eﬀort heuristics to discard origin changes that are likely to
be legitimate. As long as the heuristics are reasonable, their
accuracy is not critical to ﬁnal results. If some legitimate
origin changes are kept, they will become noise and be ﬁl-
tered out in a later step. If some illicit origin changes are
discarded in this step, the worst case is some more false
negatives in the ﬁnal results, and as we explained earlier,
false negatives can be captured by existing schemes and our
scheme focuses on minimizing false positives.

Every preﬁx is associated with a stable set and a related
set containing ASes that probably can legitimately announce
the preﬁx.

Stable Set captures ASes that are likely owners of a pre-
ﬁx. Usually the owner AS of a preﬁx is expected to an-
nounce the preﬁx persistently for a long duration. Figure 1
shows the CDF of cumulative announcement duration of ev-
ery (preﬁx, origin AS) pair in 2009. While about 55% of
preﬁx-origin AS pairs are live throughout the entire year,
25% are live for somewhere between one day and one year,
and 20% are extremely short-lived, lasting less than one day.
Further analysis shows that the middle section of the curve

30Figure 1: Lifetime of Preﬁx-
Origin pairs in 2009

Figure 2: Lifetime of AS relation
pairs in 2009

Figure 3:
Events in 2009

Oﬀense Value of

are due to new preﬁxes that start to be announced during
the year or preﬁxes that ceased to be announced sometime
in the middle of the year. This leaves about 20% short-lived
announcements that are deemed to be suspicious. There-
fore any AS announcing a preﬁx cumulatively for one day
or more within a year is included in the preﬁx’s stable set.
We choose one day as a threshold because (1) it is near the
knee point of the curve, and (2) we assume operators are
watching their networks and hijacks are dealt with within
24 hours mostly.

Related Set captures ASes that are not the owner of
the preﬁx but can legitimately announce it in operation.
It is impossible to enumerate all operational practices that
lead to such legitimate announcements. We have found the
following four cases useful for our detection algorithm.

First, an AS in a preﬁx’s stable set also belongs to related
set of all its sub-preﬁxes. This captures the case where ISPs
de-aggregate preﬁxes and announce the sub-preﬁxes. Some-
times operators implementing TE de-aggregate preﬁxes to
steer traﬃc within particular IP address range through spe-
ciﬁc paths [25].

Second, for all ASes in a preﬁx’s stable set, their direct
provider ASes also belong to this preﬁx’s related set. This
captures the case where a provider network may announce
its customer’s preﬁxes, e.g.., during failures.

For this purpose we use a simple heuristic to identify sta-
ble provider-customer inter-AS links. We start with a list
of well-known tier-1 ASes, and given an AS path, the link
from a tier-1 AS to a non-tier1 AS is provider-customer,
and any link after that is also provider-customer due to the
commonly deployed No-Valley policy. This can be consid-
ered as a subroutine in most of the existing AS relationship
inference algorithms (e.g., [19]), and thus the accuracy in
inferring provider-customer relationship should be similar,
although we do not need to infer peer-peer or sibling-sibling
relationship, which is the challenging part of general AS re-
lationship inference.

Since we are processing continuous routing updates, there
is an issue that existing relationship inference algorithms
do not deal with: the lifetime of links and relationships.
Figure 2 presents CDF of the announcement duration of
every AS relation pair in 2009. About 33% of AS relation
pairs are live for the entire year, about 41% are live for
somewhere between a day and a year, and nearly 26% are
extremely short-lived, lasting less than a day. The short-
lived links are more likely to be caused by conﬁguration

errors or route leaks. Thus we consider a provider-customer
relationship stable if the link has been announced for one
day or more cumulatively in a year. One day is chosen as
the threshold since it is near the knee point of the curve.
Only when the relationship is stable will the provider AS be
added into the related set of customer’s preﬁxes.

Third, ASes participating in an Internet Exchange Point
(IXP) (as listed on IRL [7]) can legitimately announce the
IXP’s preﬁxes, and similarly the IXP AS can also legiti-
mately announce the preﬁxes of its participating ASes.

Fourth, ASes belonging to the same organization are re-
lated and can legitimately announce each others preﬁxes.
We simply infer such relation from the domain name of the
contact emails listed in the WHOIS [12] database.

Step D: offense value.

Any AS not belonging to a preﬁx’s stable set or related set
but originating the preﬁx is deemed to be an oﬀending AS,
attempting to potentially hijack the preﬁx. In such case, we
also say that the AS is oﬀending the preﬁx’s stable set, which
represents the owner of the preﬁx. For an oﬀending AS, we
deﬁne its oﬀense value as the number of unique stable
sets that this AS is oﬀending at any given moment. The
oﬀense value captures how many other networks are being
potentially hijacked simultaneously. Based on the ﬁltered
global view of origin changes, we compute oﬀense value for
every AS for the entire year.

Step E: concurrent preﬁx hijacks.

Figure 3 presents the distribution of oﬀense values of all
possible concurrent hijack events in 2009. Most events pose
small oﬀense values of less than three and some of them
are found to be legitimate cases after detailed analysis. We
choose 10 as a threshold for identifying real concurrent preﬁx
hijacks:
if the oﬀense value is no less than 10, then the
event is reported as a concurrent hijack. This value is chosen
because (1) it is close to the knee point in Figure 3, (2) it
is conservative than the actual knee point so as to minimize
false positive, and (3) it is not too conservative to capture
non-trivial hijacks, that is, hijacks other than full-table or
near-full-table leaks.

Summary.

Algorithm 1 summarizes the above steps. It uses one year
of archived BGP tables and updates, available at Route
Views Oregon monitors [11], to construct stable and re-

 0 10 20 30 40 50 60 70 80 90 100 0 40 83 125 167 208 250 291 333 375CDF of prefix-origin AS pairsLifetime of prefix-origin AS pairs (in days) 0 5 10 15 20 25 0 10 20 30 40(in hours) 0 10 20 30 40 50 60 70 80 90 100 0 40 83 125 167 208 250 291 333 375CDF of AS relation pairsLifetime of AS relation pairs (in days) 0 5 10 15 20 25 30 0 10 20 30 40(in hours) 0 500 1000 1500 2000 2500 3000 3500 4000 4500 0 20 40 60 80 100 120Number of offense eventsOffense Value (number of offended stable sets) 0 50 100 150 200 250 300 350 400 0 2 4 6 8 10 12 1431Date

mm/dd/yy
04/08/10
04/22/10
05/19/10
08/12/10
09/10/10
10/04/10
02/14/09
04/07/09
05/05/09
07/12/09
07/22/09
08/12/09
08/13/09
12/04/09
12/15/09
04/28/08
06/17/08
08/26/08
09/22/08
12/31/08
12/31/08

Stub

Type of
Network
Small ISP
Small ISP
Small ISP

Oﬀender
ASN
23724
11269
10834
5
27986
33770
8895
36873
Small ISP
10834
Small ISP
29568
Small ISP
8997
Small ISP
4800
Small ISP
4800
31501
Small ISP
39386 Large ISP
Small ISP
44237
Small ISP
8953
Small ISP
24739
8897
Small ISP
1967
6849 Large ISP

Small ISP
Small ISP
Small ISP

Stub

Stub

Oﬀense Victim Victim
ASes Preﬁxes
2289
12115
83
19
85
14
32
15
356
18
20
188
243
31
45
15
1108
91
17
56
351
173
39
13
492
68
77
19
24
67
21
13
218
113
42
16
15270
116,753
49
17
38
52

Value
2365
19
15
15
18
20
27
13
99
15
170
13
75
18
23
13
105
16
17686
17
37

Victim
IP Addresses
113,924,096
731,904
141,824
98,816
628,480
393,216
289,280
27,392
1,713,664
20,480
101,500,416
18,176
685,568
1,574,400
664,064
82,688
113,920
107,008
1,511,397,056
469,504
25,856

Duration Monitor
Pollution
94.4%
94.6%
94.6%
10.8%
94.6%
91.9%
95.35%
95.12%
95.23%
50.00%
4.76%
95.23%
95.23%
21.43%
88.10%
86.4%
90.9%
95.3%
40.5%
26.2%
85.7%

21 mins
2.32 mins
42.90 mins
5.28 mins
9.07 mins
20.67 mins
1.96 hours
9.98 mins
3.06 hours
23.45 mins
1 min
0.53 mins
7.82 hours
1.02 mins
1 min
7.91 mins
2.12 mins
17.98 mins
21.95 hours
5.72 mins
2.21 hours

Table 1: Concurrent Preﬁx Hijacking Events in 2008, 2009 and 2010 (all conﬁrmed)

Algorithm 1 Concurrent Preﬁx Hijacks Detection

for all BGP routing message

if AS X announces preﬁx p at time t

if AS X /∈ StableSet(p) or RelatedSet(p)

Update AS X oﬀense value by StableSet(p)

elsif AS X withdraws preﬁx p at time t

if AS X /∈ StableSet(p) or RelatedSet(p)

Reduce AS X oﬀense value by StableSet(p)

Report hijack: if AS oﬀense value >= 10

lated sets. Thereafter every BGP routing announcement
is checked whether it is suspicious or legitimate by checking
origin AS against stable and related set of preﬁx. Anytime
the oﬀense value of an AS exceeds the threshold of 10, it is
reported to be a concurrent hijack.

3. CONCURRENT PREFIX HIJACKING RE-

SULTS

In this section, we report detected concurrent preﬁx hi-
jacks and the veriﬁcation, followed by some major charac-
teristics and a case study.
3.1 Concurrent Preﬁx Hijacks in 2008–2010
Table 1 lists concurrent preﬁx hijacks detected in 2010,
2009 and 2008 using BGP data collected by RouteViews
Oregon collector. For each event, we classify oﬀending AS
as a large ISP if it has more than 50 customers, or a small
ISP if it has less than 50 customers, or a stub network if it
has no customers. Most of these events are caused by small
ISPs with 50 or less customers.

To verify the detection results, we contacted operators of
victim networks via emails. The email addresses were ex-

tracted from WHOIS [12] records of victim preﬁxes. Given
that preﬁx ownership, ISP peering relationship and opera-
tion practices change over time, older results may not be
reliably veriﬁed. Thus we did not attempt to verify results
older than 2008. We are in the process of verifying results
of 2011 and 2012, and plan to publish them online [8] once
available.

In the emails we asked about two things: (1) whether the
victim preﬁx is owned by AS(es) in its stable set or not, and
(2) whether the hijack routing announcement on the given
date and time is legitimate or not. The ﬁrst question is
intended to evaluate the accuracy of stable set inference (i.e.,
preﬁx ownership), and the second question is to evaluate the
accuracy of detecting individual hijack announcement. A
hijack event is conﬁrmed if at least one preﬁx origination by
the oﬀending AS is illicit. For each email reply received, we
ﬁrst check the response to the ﬁrst question. Only after the
operator has conﬁrmed preﬁx ownership will we consider the
response to the second question.

We sent out 582 emails in total and received 63 valid
replies, among which 53 networks conﬁrmed that they own
the preﬁxes but 10 networks said that they did not own
the preﬁxes. The latter was caused by outdated or inaccu-
rate WHOIS [12] records. For example, some operators said
that the preﬁx was an old allocation that had been returned
to their providers. Among the 53 responses that conﬁrmed
preﬁx ownership, 51 networks reported that all ASes in the
preﬁx’s stable set are legitimate, while 2 networks reported
that some ASes in the stable set are not legitimate. This
shows that in most cases the stable set captures preﬁx own-
ership correctly, but there exist cases (2 out of 53) where
ASes in the stable set do not own the preﬁx, i.e., their pre-
ﬁx origination are not legitimate, which may cause small
false negatives in the ﬁnal detection result.

32Figure 4: Hijacks per year Figure 5: Oﬀended ASes Figure 6: Victim Preﬁxes Figure 7: Event Duration

In the 53 emails that conﬁrmed preﬁx ownership, 51 of
them conﬁrmed that the suspicious routing announcement
was indeed false, i.e., individual preﬁx hijacks. The other 2
emails explained that the suspicious routing announcements
were legitimate. In one case the preﬁx owner peered with the
oﬀending AS, and in the other case the preﬁx owner and the
oﬀending AS belonged to the same company. However, these
2 cases did not cause any false positive in the ﬁnal result. All
the 21 events listed in Table 1 were conﬁrmed as real hijack
events since each event had at least one conﬁrmed individual
preﬁx hijack. Therefore by correlating suspicious routing
announcements along the time dimension, our algorithm was
able to identify a signiﬁcant number of concurrent preﬁx
hijacks with zero false positive.

Among the 51 conﬁrmed individual preﬁx hijacks, 49 op-
erators stated that they were unaware of the hijacks; only
2 operators had knowledge of the hijacks and had resolved
it by contacting the provider of attacker AS. To some ex-
tent this is expected since when a preﬁx is being hijacked,
the preﬁx owner network does not see the false routing an-
nouncement due to BGP’s path vector routing. We made
attempts to verify whether the network community knew
about these events. NANOG is a forum where network
operators regularly discuss and attempt to resolve network
problems. We scanned the NANOG mailing list on the dates
when these preﬁx hijacks occurred in 2008, 2009 and 2010
and only found discussions about a couple of very large leaks
by AS 8997 in 2008 [3] and by AS23724 in 2010 [2]. Further-
more research literature does not report more events than
NANOG. The fact that many hijacks happened but went un-
noticed highlights the need for fast and accurate detection
schemes.
3.2 Concurrent Preﬁx Hijacks in 2003–2010
Applying our algorithm to BGP data collected by Route-
Views Oregon collector, we detect totally 60 concurrent pre-
ﬁx hijacks from 2003 through 2010, with about 5 to 20 events
each year (Figure 4). The details of all the events are pro-
vided online [8]. Here we present some major characteristics
of the events.

3.2.1 General Impacts
We measure the impacts of these hijack events by the
number of ASes, the number of preﬁxes, and the number
of monitor they aﬀected and also the duration of the events.
Figure 5 shows the CDF of the number of ASes whose pre-
ﬁxes were hijacked during these events. The top 20% of
hijacks aﬀected thousands of ASes, while the next 20% af-
fected between 30 to 100 ASes and ﬁnally the remaining 60%
aﬀected 30 or less ASes. During these events multiple victim
preﬁxes were hijacked.

Figure 6 shows the CDF of the number of victim preﬁxes
per event. The top 20% of concurrent hijacks involve thou-
sands of preﬁxes and sometimes as much as half the size of
global routing table. The next 20% involve 100 or more pre-
ﬁxes and the remaining 60% involve less than 100 preﬁxes.
Figure 7 presents the CDF of the duration of each event.
Most concurrent preﬁx hijacks are short-lived, lasting from
a few minutes to a couple of hours, but still 20% of them
lasted for more than 3 hours. The very short-lived events
might be caused by typos in router conﬁgurations and were
quickly caught and ﬁxed. Adopting tools like router conﬁg-
uration checker [17] may help prevent these from happening.
However, the existence of hijacks that lasted for a few hours
or more raises the concern of serious damage to the preﬁx
owner’s network service.

Figure 8 shows the CDF of the percentage of monitors
that were polluted in each hijack event. We say a monitor
is polluted if it accepts at least one of the hijack routing
announcements.
In other words, if the monitor is a real
router, it would forward traﬃc towards the hijacker. Since
the RouteViews Oregon collector peers with BGP monitors
in many diﬀerent ISPs, the percentage of polluted monitors
reﬂects the scope of the hijack’s impacts. The ﬁgure shows
that the top 70% of hijacks pollute 85% or more monitors,
which means most hijack announcements propagate to most
of the Internet.

3.2.2 Locality of Victim Preﬁxes
Concurrent preﬁx hijacking is caused by an AS falsely
originating multiple victim preﬁxes at the same time. But
what are the geographical locations of these victim preﬁxes?
For instance, are these preﬁxes close to the attacker AS or
distributed across the globe? We capture the locality of
victim preﬁxes by the percentage of victim preﬁxes that are
originated within the same country as the attacker AS. The
geographic locations of victim preﬁxes were found by using
Geo-Lite City [5], and the geographic location of attacker
AS was found by looking up its WHOIS [12] record.

Majority of concurrent hijacks involved victim preﬁxes in
the same country as oﬀending AS. Figure 9 presents locality
of victim preﬁxes for hijack events in years 2008 to 2010.
For 55% of events more than 80% of victim preﬁxes are
within the same country as attacker AS. Furthermore for
about 35% of events every victim preﬁx is within the same
country as attacker AS. This suggests that the false rout-
ing announcements do not involve random preﬁxes but are
most likely meant to aﬀect traﬃc for networks within a lo-
cal region. Note that though victim preﬁxes are often in the
same country as the attacker AS, the false routing updates
are propagated to most of the Internet, causing wide-spread
reachability problem to victim preﬁxes.

 0 5 10 15 20 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011Number of eventsYear 0 10 20 30 40 50 60 70 80 90 100 0 2K 4K 6K 8K 10K 12K 14KCDF of eventsNumber of offended ASes 0 10 20 30 40 50 60 70 80 90 100 0 20K 40K 60K 80K 100K 120KCDF of eventsNumber of offended prefixes 0 10 20 30 40 50 60 70 80 90 100 0 5 10 15 20 25CDF of eventsDuration of events (in hours)33Figure 8: Monitor pollution

Figure 9: Locality of victim pre-
ﬁxes

Figure 10: Preﬁx Hijacks by AS 8895
in 2009

3.2.3 A Case Study
Based on received operator emails, we now present an
in-depth study of a veriﬁed concurrent preﬁx hijack that
occurred in 2009. This event was caused by AS 8895 on
February 14th, 2009 when it falsely originated 243 preﬁxes,
which could potentially impact 289K IP addresses belonging
to 34 ASes in Saudi Arabia. The event lasted for nearly 2
hours during which network services of all the involved Saudi
ASes were interrupted. The scope of event was global as 41
out of 43 RouteViews Oregon monitors reported the false
announcements. Most individual suspicious announcements
were conﬁrmed by oﬀended ASes as illegitimate thereby ver-
ifying the event.

The network operators of victim preﬁxes and the oﬀend-
ing AS conﬁrmed that the stated hijacks were due to router
misconﬁguration. The network operator of AS 8895, i.e.,
ISU/KACST stated that they used to be the major Internet
gateway in the Saudi Arabia region and therefore an up-
stream provider for many local Saudi ISPs. In the past two
years other Internet gateways have been launched within
the region, one of them being AS 39386, i.e., Saudi Tele-
com. In that period ISU/KACST shifted focus on educa-
tional sectors, universities, libraries and etc. Both these
things resulted in many local ISPs switching providers to
Saudi Telecom. But due to router misconﬁguration AS 8895
kept announcing preﬁxes of many of its ex-customers which
had switched providers to AS 39386.

Figure 10 illustrates how the oﬀense value of AS 8895
reveals this event. Recall that oﬀense value is the num-
ber of stable sets whose preﬁxes are hijacked by the of-
fending AS. The oﬀense value of AS 8895 was zero for the
entire year except February 14th, 2009 when the leak oc-
curred. The false announcement started at 11:10AM when
AS 8895 announced preﬁxes of an increasing number of its
ex-customers. The oﬀense value ﬂuctuated a couple of times
but remained near constant at 34 for more than an hour.
Finally oﬀense value started to drop and got back to zero
at 1:10 PM when the misconﬁguration was ﬁxed and false
routing announcements stopped.
4. RELATED WORK

False BGP routing announcements are a well-known prob-
lem [15].
It includes hijacking allocated address space, as
well as unallocated or private address space [18]. A number
of solutions have been proposed to eradicate the problem of
false routing announcements. They can be categorized into
two categories: prevention [22, 26, 30, 21, 31], and detec-
tion [32, 23, 27, 16, 6].

The prevention techniques attempt to restrict ASes from
making false routing announcements. Many prevention pro-
posals [22, 26, 30] require extensive cryptographic key dis-
tribution infrastructure, and/or a trusted central database,
and hence are diﬃcult to deploy. PGBGP [21] and QBGP [31]
attempts to prevent propagation of suspicious announce-
ments. Each router monitors the origin AS for each pre-
ﬁx, any new preﬁx origination is considered anomalous, and
router avoids using anomalous routes if old route is available.
The detection techniques focus on identifying preﬁx hijack
events through monitoring of control plane or data plane and
therefore can be categorized as (a) traceroute based solution
and (b) control-plane based solution. These detection solu-
tions do not require changes to BGP protocol and thus are
more easily deployable. Traceroute based solutions, such as
iSPY [32] and Lightweight Probing [34], periodically probe
data paths to a speciﬁc preﬁx. Thus they are best to be used
by preﬁx owners to protect their allocated preﬁx block.

Control-plane-based solutions, such as [27], can monitor
the entire routing table passively, but they usually suﬀer
from too many false positives as well as false negatives due
to limited vantage points and the lack of ground truth of
operational practices [20]. Certain control-plane-based solu-
tions, such as PHAS [23] and MyASN [10], use information
provided by preﬁx owners to ﬁlter out false positives, thus
they are most eﬀective when preﬁx owners register their pre-
ﬁxes and keep the registration up to date.

5. CONCLUSIONS

By identifying networks that announce preﬁxes of mul-
tiple other networks, we are able to discover 5 to 20 con-
current preﬁx hijacks every year from 2003 through 2010.
For most of these events it is the ﬁrst time they are discov-
ered, veriﬁed, and documented. They typically last from a
few minutes to a few hours and aﬀect most monitors, im-
plying these events may inﬂict signiﬁcant damage to data
traﬃc. Email communication with network operators veri-
ﬁes that the results of 2010, 2009, and 2008 have no false
positives. Encouraged by the success of this method, we are
implementing an online detection system that will process
real-time BGP updates to generate up-to-date results.

6. ACKNOWLEDGEMENT

We are grateful to our shepherd, Sharon Goldberg, for her
guidance and help in revising the paper. We would also like
to thank anonymous reviewers for their valuable comments.

 0 10 20 30 40 50 60 70 80 90 100 0 20 40 60 80 100CDF of LRL eventsPercentage of polluted monitors 0 10 20 30 40 50 60 70 80 90 100 0 20 40 60 80 100CDF of eventsPercentage of locality 0 5 10 15 20 25 30 351/12/13/14/15/16/17/18/19/110/111/112/11/1Offense ValueTime in 2009 (month/day) 0 5 10 15 20 25 30 3511:0011:3012:0012:3013:0013:30Time on 02/14/2009347. REFERENCES
[1] AS 7007 incident.

http://en.wikipedia.org/wiki/AS 7007 incident.

[2] ASN 23724.

www.merit.edu/mail.archives/nanog/msg07826.html.

[3] ASN 8997.

www.merit.edu/mail.archives/nanog/2008/msg00704.html.

[4] BGPmon. http://www.bgpmon.net.
[5] GeoLite City.

http://www.maxmind.com/app/geolitecity.

[6] Internet Alert Registry. http://iar.cs.unm.edu/.
[7] Internet Topology Collection.

http://irl.cs.ucla.edu/topology.

[8] LRL. dyadis.cs.arizona.edu/projects/lsrl-events.
[9] North American Network Operators’ Group.

http://www.nanog.org.

[10] RIPE myASn System. http://www.ris.ripe.net/myasn.
[11] Route Views Project. http://www.routeview.org.
[12] Whois Database. http://www.whois.net/.
[13] YouTube Hijacking: A RIPE NCC RIS case study.

http://www.ripe.net/news/study-youtube-
hijacking.html.

[14] Ballani, H., Francis, P., and Zhang, X. A Study
of Preﬁx Hijacking and Interception in the Internet. In
ACM SIGCOMM (2007).

[15] Butler, K., Farley, T., McDaniel, P., and

Rexford, J. A survey of bgp security issues and
solutions. Proceedings of the IEEE 2010, 1 (Jan.
2010), 100–122.

[16] Chi, Y.-J., Oliveira, R., and Zhang, L. Cyclops:
AS-level Connectivity Observatory. SIGCOMM CCR
38, 5 (2008), 5–16.

[17] Feamster, N., and Balakrishnan, H. Detecting
BGP Conﬁguration Faults with Static Analysis. In
Proc. NSDI (2005).

[18] Feamster, N., Jung, J., and Balakrishnan, H.
An empirical study of “bogon” route advertisements.
SIGCOMM Comput. Commun. Rev. 35, 1 (Jan. 2005),
63–70.

[19] Gao, L. On Inferring Autonomous System

Relationships in the Internet. In IEEE ACM
Transactions on Networking (2000), vol. 9,
pp. 733–745.

[20] Hu, X., and Mao, Z. M. Accurate Real-time
Identiﬁcation of IP Preﬁx Hijacking. In IEEE
Symposium on Security and Privacy (2007).

[21] Karlin, J., Forrest, S., and Rexford, J. Pretty
Good BGP: Improving BGP by Cautiously Adopting
Routes. In ICNP (2006).

[22] Kent, S., Lynn, C., Mikkelson, J., and Seo, K.

Secure Border Gateway Protocol (S-BGP). IEEE
JSAC 18 (2000), 103–116.

[23] Lad, M., Massey, D., Pei, D., Wu, Y., Zhang, B.,
and Zhang, L. PHAS: A Preﬁx Hijack Alert System.
In USENIX Security (2006).

[24] Mahajan, R., Wetherall, D., and Anderson, T.

Understanding bgp misconﬁguration. In SIGCOMM
’02 (2002).

[25] Meyer, D., Zhang, L., and Fall, K. Report from

the IAB Workshop on Routing and Addressing.
draft-iab-raws-report-01.txt, 2007.

[26] Ng, J. BGP Extensions for Secure Origin BGP, April

2004. ftp://ftp-eng.cisco.com/sobgp/drafts/draft-ng-
sobgp-bgp-extensions-02.txt.

[27] Qiu, J., Gao, L., Ranjan, S., and Nucci, A.

Detecting Bogus BGP Route Information: Beyond
Preﬁx Hijacking. In SecureComm (2007).
[28] Ramachandran, A., and Feamster, N.

Understanding the Network Level Behavior of
Spammers. In ACM SIGCOMM (2006).

[29] Siganos, G., and Faloutsos, M. Neighborhood
Watch for Internet Routing. In IEEE INFOCOM
(2007).

[30] Subramanian, L., Roth, V., Stoica, I., Shenker,

S., and Katz, R. Listen and Whisper: Security
Mechanisms for BGP. In NSDI (2004).

[31] Zhang, M., Liu, B., and Zhang, B. Safeguarding
Data Delivery by Decoupling Path Propagation and
Adoption. In INFOCOM (2010).

[32] Zhang, Z., Zhang, Y., Hu, Y. C., Mao, Z. M.,

and Bush, R. iSPY: Detecting IP Preﬁx Hijacking on
My Own. In SIGCOMM (2008).

[33] Zhao, X., Pei, D., Wang, L., Massey, D.,

Mankin, A., Wu, S., and Zhang, L. BGP Multiple
Origin AS Conﬂicts. In IMW (2001).

[34] Zheng, C., Ji, L., Pei, D., Wang, J., and Francis,

P. A Light-Weight Distributed Scheme for Detecting
IP Preﬁx Hijacks in Real-Time. In ACM SIGCOMM
(2007).

35