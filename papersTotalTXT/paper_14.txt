Hard Drive Side-Channel Attacks using

Smartphone Magnetic Field Sensors

(Short Paper)

Sebastian Biedermann1, Stefan Katzenbeisser1 and Jakub Szefer2

1 Security Engineering Group, Technische Universit¨at Darmstadt

{biedermann, katzenbeisser}@seceng.informatik.tu-darmstadt.de
2 Computer Architecture and Security Laboratory, Yale University

jakub.szefer@yale.edu

Abstract. In this paper we present a new class of side-channel attacks
on computer hard drives. Hard drives contain one or more spinning disks
made of a magnetic material. In addition, they contain diﬀerent magnets
which rapidly move the head to a target position on the disk to perform
a write or a read. The magnetic ﬁelds from the disk’s material and head
are weak and well shielded. However, we show that the magnetic ﬁeld due
to the moving head can be picked up by sensors outside of the hard drive.
With these measurements, we are able to deduce patterns about ongoing
operations. For example, we can detect what type of the operating system
is booting up or what application is being started. Most importantly, no
special equipment is necessary. All attacks can be performed by using an
unmodiﬁed smartphone placed in proximity of a hard drive.

1

Introduction

Hard drives are an integral part of almost any computer as they are the persis-
tent storage medium for code and data. Operation of the hard drive is directly
correlated with the type of workload being processed on the computer. The
movement of the hard drive head is enabled by a magnetic ﬁeld. This magnetic
ﬁeld can be picked up by sensors outside of the disk drive, and thus enables our
new side-channel attacks. Whenever data is being written to, or read from, the
head mechanism has to move, causing disturbance in the magnetic ﬁeld which
we can detect. Disk drives have previously been subject to research on covert
timing channels, e.g. [3]. However, these attacks required direct access to the tar-
get computer. The magnetic side-channel, on the other hand, is a non-invasive
attack which can be carried out without physical contact. This attack falls under
the broad class of electromagnetic (EM) attacks. EM attacks have been carried
out on various computer components, such as CMOS chips [5], or smart cards [1].
Disk drives, however, have not been subject to such attacks. Our research was
motivated by two trends in industry. First, there has been a great prolifera-
tion of smartphones with various sensors. The key sensor which we focus on is
the digital compass, also called the magnetometer. Today’s phones have sensors

which can pick up magnetic ﬁelds having a strength of µT (micro Tesla, where
Tesla is the unit of magnetic ﬁeld strength or magnetic ﬂux density). Second,
the industry is constantly working on optimizing the size of the servers and com-
puter equipment. This has led to smaller and thinner computers. The reduced
size means there is less shielding and shorter distance from the disk drive to the
outside of the computer chassis. This creates a situation where magnetic ﬁeld
ﬂuctuations can be more easily detected using sensors such as those available on
today’s phones. In particular, our side-channel attacks allow us to:

– detect the operating system that is used;
– distinguish between known applications being started;
– distinguish Virtual Machine activity on a server;
– match ongoing network traﬃc to a server; and
– detect ﬁle caching based on disk activity.

These attacks are performed by using a simple application running on an un-
modiﬁed smartphone.

2 Magnetic Field and Hard Drives

In this section we provide a short summary on magnetic ﬁelds and magnetic disk
drives. More information is available in a variety of books, such as [7].

2.1 Magnetic Fields

Tesla (T ) is the unit of magnetic ﬁeld strength, often denoted as B. The magnetic
ﬁeld can also be expressed in units of gauss (G), where 1 gauss equals 100 µT.
As a point of reference, Earth’s magnetic ﬁeld ranges between 50 to 75 µT.
Meanwhile the magnetic ﬁeld strength in close proximity of a hard drive can vary
due to the disk operation and the magnets inside the disk drive. In particular,
the movement of mechanisms inside the hard drive when accessing hard drive
data causes the magnetic ﬁeld strength to ﬂuctuate by about 3 µT when sensed
next to hard drive (d ≈ 0 cm). The ﬁeld strength B decreases as a square of the
distance d with B ∝ 1
d2 from a point source. Given the magnetic ﬁeld strength
B1 at distance d1 from the source, the strength B2 at distance d2 can be inferred
from B1
. Background magnetic ﬁeld ﬂuctuation (i.e. noise) always is about
B2
0.1 µT in magnitude in our experiments. Thus, realistic maximum measurement
distances di are constrained by the fact that the ﬁeld changes need to be above
the background noise, thus Bi > 0.1 µT.

∝ d2

2
d2
1

2.2 Hard Drive Magnetic Fields

There are three sources of magnetic ﬁelds in a standard hard drive: a) magnetic
disk platters, b) the disk drive head, and c) the mechanisms for moving the disk
drive head. Both a) and b) are too weak to be detected outside a disk drive

chassis. We show, however, that detecting the strength of c) is feasible. In a
hard drive, there are two magnets, one above and one below the head movement
assembly. The head movement assembly includes a coil of wire. When current
is passed through the wire, a magnetic ﬁeld is generated, which causes the head
assembly to displace. Depending on the direction of the current, the generated
ﬁeld interacts with the ﬁxed magnets and causes the head movement assembly
to move left or right from its rest position. At rest the head assembly is either
all the way to the left or all the way to the right, depending on the particular
disk in use. The strength of the ﬁeld determines how far the head is displaced.

2.3 Magnetic Field Sensors on Mobile Devices

On a modern smartphone the magnetic ﬁeld sensor measures the strength of the
magnetic ﬁeld along three axes. On Android-based devices, applications may ac-
cess the TYPE MAGNETIC FIELD sensor to get the ﬁeld readings. The sensor
outputs data on the strength of magnetic ﬁeld in units of µT along three axes.
We experimentally verify that when placing the phone next to a drive, the z
axis measurements give the least noisy readings. If the phone is placed on top of
the drive, the x or y axis measurements provide best results assuming minimal
curvature with the z axis perpendicular to both. Note, however, that the earth’s
magnetic ﬁeld is parallel to most surfaces (x or y axis when the phone is laying
ﬂat on some surface) which can cause high noise along these axis. Thus, ideally
the axis perpendicular to the earth’s surface should be used for the measure-
ments, which need not always be the z-axis.

2.4 Magnetic Field Measurements

In our experiments we use unmodiﬁed Samsung Galaxy S4 Mini and Samsung
Galaxy S2 smartphones. We access their magnetometer using a custom applica-
tion, however one which requires no special permissions (unlike applications that
may require permissions to use camera or other sensors). Before any experiment
is performed, the application measures the background magnetic ﬁeld in order
to calibrate subsequent measurements. This is done by taking 100 measurements
along the x, y and z axis and computing the mean of all measurements. This
way the average ﬁeld strength (¯x, ¯y, ¯z) of the background noise can be estab-
lished. Once the background magnetic ﬁeld strength is measured, the application
records measurements Mi along the x, y and z axis which correspond with the
diﬀerence between the newly measured value and the average background noise,
Mi = (timestampi, xi − ¯x, yi − ¯y, zi − ¯z).

3 Magnetic Side-Channel Attacks

This section presents a variety of magnetic side-channel attacks which we have
explored. We focus on two targets. First, we launch attacks against a laptop in an
oﬃce-type environment. Second, we launch attacks against a server co-located
in a server rack with other running servers.

3.1 Attack Composition

The activity of the hard drive can be matched to changes in the magnetic ﬁeld
strength, since the head is moved each time ﬁles are written or read on diﬀerent
locations. Additionally, the magnitude of the magnetic ﬁeld strength can be
matched to diﬀerent locations on a hard drive on which the head currently
operates. These two diﬀerent factors create characteristic ﬁngerprints over time
that can be matched to ongoing operations of a hard drive. The smartphone
should be located closely, at best in a distance of 3 − 4 cm to the target hard
drive. In order to detect certain operations on an arbitrary target hard drive,
we analyze correlations between measurements taken in an enrollment phase
and attack measurements. During enrollment, we record several measurements
of the same hard drive operation and compute the average of all measurements,
which yields to a characteristic enrollment vector for one speciﬁc activity. Before
computing the average, we synchronize all individual measurements. We do this
by shifting the measured vectors by ±0.5 seconds; the shift which produces the
best correlation with the previous measurements is taken. In the attack phase, we
compute the correlation between a new measurement and all stored enrollment
vectors. Again, in order to synchronize the new measurement with the enrollment
vectors, we shift it by ±0.5 seconds. Finally, we classify the measurement to the
enrollment class which achieves the highest correlation.

3.2 Example Attacks against Laptop

The target laptop is an Acer Aspire 5733z with a Toshiba 320 GB disk drive
with 5400 rpm. The attack setup is shown in Figure 1. The smartphone is placed
in front of the laptop, near where the disk drive is mounted.

As one possible scenario, we envision a malware-infested smartphone. The
malware, which the user downloaded when searching for a “digital compass”
application, is running in the background on the phone and collecting magnetic
sensor readings once it is triggered. The unsuspecting user may place the phone

Fig. 1. Laptop attack setup, shown with
the Samsung Galaxy S4 Mini.

Fig. 2. Field strength while booting
Linux and Win7 (average of 20 runs).

024681012141618200.51.01.52.0time [seconds]magnetic field strength [µT]  Ubuntu Linux 12.04Windows 7 SP1OS bootupin close proximity to the laptop when working on the laptop in the oﬃce or in a
cafe. In this position, the malware can launch a number of attacks, such as OS
or application startup detection.

OS Boot-Up Detection: First, we use the measurements to investigate which
operating system (OS) is booted on the laptop. Figure 2 shows recorded mea-
surements during the boot-up of Ubuntu Linux 12.04 (64 Bit) and Windows 7
SP1 (64 Bit) on the same laptop, each taken for 20 seconds right after turning
on the notebook. The ﬁrst nine seconds are very similar in both curves, since
ﬁrst the BIOS is loaded and the hard drive is initialized. After nine seconds, the
OS starts booting and diﬀerences in the course of the magnetic ﬁeld can clearly
be seen. These characteristic deviations are based on the diﬀerent underlying ﬁle
system as well as on diﬀerent processes which are starting during boot-up. Dur-
ing enrollment we record vectors with 1000 measurements (ten seconds) starting
nine seconds after the ﬁrst change in the magnetic ﬁeld could be detected. This
way, we skip the BIOS and the ﬁrmware and only use the characteristic measure-
ments of the operating system’s boot-up. The enrollment vectors are averages
over ten independent trials. Table 1 shows the average Pearson correlation be-
tween ten measurement vectors taken from diﬀerent boot-ups of diﬀerent OSs
and enrollment vectors for Ubuntu Linux, Windows 7 and Windows Vista. In
each case, the strongest correlation occurs between the measurement vector and
the enrollment vector of the same OS. The correlation to other enrollment vec-
tors of other OSs is small in comparison. We can use the correlation between
attack measurements and enrollment measurements in order to decide which OS
was booting. In this experiment, we use ﬁve measurements of each OS boot-up
procedure for enrollment and ten new measurements which we classify to one
of the three OS classes depending on their highest correlation. The results of
this simple classiﬁcation approach lead to an average error rate of 3% across 20
enrollments and 20 attack measurements in each OS setup with which an attack
vector was not correctly classiﬁed.

Application Start-Up Detection: In the next attack, we use the changes in
the strength of the magnetic ﬁeld to detect the start of some known applica-
tions. We use the same setup as before. The laptop runs Windows 7 SP1 (64
Bit) and has three diﬀerent browsers, namely Microsoft Internet Explorer (ver.
8), Google Chrome (ver. 34) and Mozilla Firefox (ver. 28). Our attack goal is

measurement
Linux
Win7
WinVista

Linux
0.40 ± 0.22
0.08 ± 0.04
0.04 ± 0.13

enrollment vectors
Win7
0.09 ± 0.08
0.29 ± 0.10
0.06 ± 0.12

WinVista
0.12 ± 0.10
0.14 ± 0.06
0.37 ± 0.22

Table 1. Average correlation between new attack measurements recorded during boot-
ing diﬀerent operating systems and the enrollment vectors.

measurement
IE
Chrome
Firefox

IE
0.34 ± 0.11
0.29 ± 0.14
0.22 ± 0.13

enrollment vectors
Chrome
0.23 ± 0.10
0.47 ± 0.11
0.13 ± 0.15

Firefox
0.23 ± 0.08
0.07 ± 0.19
0.49 ± 0.16

Table 2. Average correlation between new attack measurements recorded during start
of diﬀerent browsers and the corresponding enrollment vectors.

to determine which browser was started. Table 2 shows the average Pearson
correlation between measurements and enrollment vectors recorded during the
start of IE, Chrome and Firefox. In each case, the strongest correlation occurs
between the measurements and the enrollment vectors of the same browser.

Based on the highest correlation, we can classify new samples to a browser
class with an average error rate of 23%. The results indicate that the start-up
of diﬀerent applications can be distinguished with a good accuracy.

3.3 Example Attacks against Servers

In this section we present attacks against a server co-located in a server rack
with other servers. The target server is a Dell R210 with a 2TB (7.2K RPM
SATA) disk drive. The smartphone is placed on top of the server, near where
the disk drive is mounted. In order to successfully mount the attack and to be
able to place the smartphone, at least one rack above the target server needs
to be empty. This also results in a distance of at least 1 3
4 inches (1 Rack Unit)
between our target server and the next server. The distance greatly decreases the
inﬂuence of other operating hard drives in the same server rack. As one possible
attack scenario, we envision an unscrupulous data center employee who wants
to gain information about processes running on the servers.

VM Activity Detection: In this example, an attacker tries to gather insights
about virtual machines (VMs). Our server runs the Xen hypervisor 4.2 and
diﬀerent VMs, each having a storage of 128 GB. We measure the magnetic ﬁeld
during writing a ﬁle in diﬀerent VMs vm01, vm02 and vm03. Figure 3 shows
the average magnetic ﬁeld measurements. The average strength can be used
to estimate which VM is currently operating on the server’s hard drive. Given
an attack measurement, we again compute the average magnetic ﬁeld strength
and perform a classiﬁcation based on the smallest diﬀerence to an enrollment
measurement. Results showed that the activity of the server’s hard drive can be
assigned to vm01 or vm03 with an average error rate of 35%. The diﬀerences
between the magnetic ﬁeld strengths of the VMs are small, but detectable.

Host Server Detection: As another example, the attacker may know that a
website is hosted on a server in a data center and she wants to ﬁnd out exactly
which server actually hosts the site. To reach this goal, the attacker triggers
downloads from the website with the smartphone while measuring the magnetic

ﬁeld radiated by servers in the rack in multiple trials. This way, the attacker can
determine if a server created a magnetic ﬁeld corresponding to a read operation
of a data block having the appropriate size that matches the download. In or-
der to test the eﬀectiveness of our attack, we use ten enrollment measurements
recorded during downloading a 32 MB ﬁle from our Web server and computed
and average enrollment vector. We found that the attack and enrollment mea-
surements correlate with 0.33 ± 0.11 if the ﬁle is downloaded from the server
on which the smartphone is located, while the attack measurements correlate
only with 0.12 ± 0.07 if the ﬁle is not downloaded from this server. Classifying
20 new attack measurements based on the highest correlation to the enrollment
vector while only during 10 of the measurements the ﬁle is downloaded lead to
an average error rate of 15%. The correlation can be used to reveal the server
that hosts the website which provides the download.

File Caching Detection: If a server caches ﬁles in memory, then host server
detection attack can be prevented. However, detection of the caching behavior is
also an interesting attack objective. Frequently accessed ﬁles can be distinguished
from infrequently accessed ones – thus leaking information whether a ﬁle has
recently been in use. Figure 4 shows disk activity (darker red regions show a
larger change in the magnetic ﬁeld over time) when several ﬁles of 16 MB are
accessed, in this case downloaded from the Web server. Two of the ﬁles (namely
5 and 11) have been accessed before the test and became cached. To test the
attack, we perform 10 enrollment measurements while downloading ﬁles and
10 enrollment measurements without downloading. Subsequently, we perform
20 attack measurements while downloading 20 diﬀerent ﬁles, 10 of them were
already downloaded before and are cached, 10 of them were never downloaded.
We classify the attack measurements to one of the two classes “is read from hard
drive” or “is not read from hard drive”, the latter means the ﬁle was cached in
memory. We do this by choosing the class that yields to the highest correlation.
According to our results, an attacker can distinguish if a ﬁle has already been
accessed or not on a Web server with an average error rate of 5%.

Fig. 3. Strength during writing data in
vm01, vm02 and vm03 (50 runs).

Fig. 4. Field while downloading ﬁles;
05 and 11 have already been accessed.

01230.10.20.30.40.50.60.7time [seconds]magnetic field strength [µT]  vm01vm02vm034 Related Work

These are other side-channel attacks, but they require access to the victim sys-
tem or physical connection to measure the power usage, while our attack requires
no physical connection, but only physical proximity. In 1984, Gold et al. [3] pre-
sented analysis of covert channels due to placement of the disk arm. While by
1991, Karger et al. [4] presented research on storage channels due to hard disk
drive head movement. However, the majority of the past work on electromagnetic
(EM) side-channels has focused on processors. Researchers used specialized mag-
netic sensors to sense emanations and recover a secret key [5]. Other work has
shown that the electromagnetic attack on processors can obtain at least as much
information as power consumption based side-channels [6]. Given the need for
proximity when working with electromagnetic emanations, research has focused
on smart cards where physical access and proximity are easy. Researchers have
shown electromagnetic side-channel attacks on various smart cards with diﬀer-
ent hardware protections, and still were able to recover the encryption keys [2].
Others were even able to propose a model that completely and quantitatively
expresses the information leaked from electromagnetic side-channel in CMOS de-
vices, such as smart cards [1]. Purely using magnetic ﬁeld measurements against
hard drives has not been explored yet.

5 Conclusion

In this paper we presented a new class of side-channel attacks on computer
hard drives. From measurements of the magnetic ﬁeld, which carries informa-
tion about the movement of the hard drive mechanisms, we are able to deduce
patterns about ongoing operations. All experiments were performed using a mod-
ern, unmodiﬁed smartphone which was placed in proximity to a hard drive, even
outside a laptop or a server chassis.

References

1. D. Agrawal, B. Archambeault, J. Rao, and P. Rohatgi. The em side channel(s). In

Cryptographic Hardware and Embedded Systems, volume 2523, pages 29–45. 2003.

2. K. Gandolﬁ, C. Mourtel, and F. Olivier. Electromagnetic analysis: Concrete results.

In Cryptographic Hardware and Embedded Systems, pages 251–261. 2001.

3. B. D. Gold, R. Linde, and P. F. Cudney. Kvm/37o in retrospect. In IEEE Sympo-

sium on Security and Privacy, pages 13–23, 1984.

4. P. A. Karger and J. C. Wray. Storage channels in disk arm optimization. In IEEE

Symposium on Security and Privacy, pages 52–63, 1991.

5. E. Mateos and C. Gebotys. Side channel analysis using giant magneto-resistive

(gmr) sensors. In COSADE workshop proceedings published by CASED, 2011.

6. J.-J. Quisquater and D. Samyde. Electromagnetic analysis (ema): Measures and
counter-measures for smart cards. In Proceedings of the Int. Conference on Research
in Smart Cards: Smart Card Programming and Security, pages 200–210, 2001.

7. N. Rao. Fundamentals of Electromagnetics for Electrical and Computer Engineering.

Pearson Education, 2011.

