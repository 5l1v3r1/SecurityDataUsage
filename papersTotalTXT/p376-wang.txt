Walls Have Ears! Opportunistically Communicating Secret

Messages Over the Wiretap Channel: from Theory to

Practice

Qian Wang†

qianwang@whu.edu.cn

Chenbo Xia†

microwall@whu.edu.cn

Kui Ren‡,§

kuiren@buffalo.edu

Xiaobing Chen†

chenxb002@whu.edu.cn

Guancheng Li†

sunatum@whu.edu.cn
Zhibo Wang†, Qin Zou†
{zbwang,qzou}@whu.edu.cn

†State Key Lab of Software Engineering, School of Computer Science, Wuhan University, P. R. China

‡Dept. of Computer Science and Engineering, The State University of New York at Buffalo, USA

§College of Information Science and Technology, Jinan University, P. R. China

ABSTRACT
Physical layer (PHY) security has aroused great research
interest in recent years, exploiting physical uncertainty of
wireless channels to provide communication secrecy without
placing any computational restrictions on the adversaries
under the information-theoretic security model. Particu-
larly, researches have been focused on investigating Wyner’s
Wiretap Channel for constructing practical wiretap codes
that can achieve simultaneous transmission secrecy and re-
liability. While theoretically sound, PHY security through
the wiretap channel has never been realized in practice, and
the feasibility and physical limitations of implementing such
channels in the real world are yet to be well understood. In
this paper, we design and implement a practical opportunis-
tic secret communication system over the wireless wiretap
channel for the ﬁrst time to our best knowledge. We show
that, our system can achieve nearly perfect secrecy given
a ﬁxed codeword length by carefully controlling the struc-
ture of the parity-check matrix of wiretap codes to strike
the proper balance between the transmission rate and se-
crecy. Our system is implemented and evaluated extensively
on a USRP N210-based testbed. The experimental results
demonstrate the physical limitations and the feasibility of
building practical wiretap channels in both the worst chan-
nel case and the case where the sender has only the knowl-
edge of instantaneous channel capacities. Our system design
and implementation successfully attempts towards bridging
the gap between the theoretical wiretap channel and its prac-
tice, alleviating the unrealistic and strong assumptions im-
posed by the theoretical model.

Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage and that copies bear this notice and the full cita-
tion on the ﬁrst page. Copyrights for components of this work owned by others than
ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or re-
publish, to post on servers or to redistribute to lists, requires prior speciﬁc permission
and/or a fee. Request permissions from Permissions@acm.org.
CCS’15, October 12–16, 2015, Denver, Colorado, USA.
c(cid:13) 2015 ACM. ISBN 978-1-4503-3832-5/15/10 ...$15.00.
DOI: http://dx.doi.org/10.1145/2810103.2813702.

Categories and Subject Descriptors
C.2.0 [Computer-Communication Networks]: [General–
Security and Protection]
Keywords
Wiretap channel; physical layer security; channel capacity;
low-density parity check code
1.
INTRODUCTION

Diﬀerent from classical cryptography, information-theoret
-ic security guarantees message secrecy without relying on
the computational hardness of mathematical problems [9,
20]. Based on the information-theoretic security principles,
physical layer (PHY) security places no computational re-
strictions on adversaries, and it can provide an additional
layer of security besides cryptographic protocols implemented
in the upper layers. Due to its unique properties, PHY se-
curity has aroused considerable research interest in recent
years.

To achieve PHY security, there are two main research
streams: generating secret keys from correlated observa-
tions between the legitimate sender and receiver [7, 3], and
transmitting secret messages between the legitimate sender
and receiver by leveraging their physical advantage over the
eavesdropper’s channel through wiretap coding [20, 9, 19].
By separately dealing with reliability and security constraints,
secret key generation from correlated observations turns out
to be a much simpler problem, and many eﬀective key-
agreement protocols have been proposed by exploiting the
inherent randomness of wireless fading channels [13, 16].
The fundamental limits of secret key generation from source
or channel models, however, are not as well understood
as those of secret communications over wiretap channels,
mainly due to harder analysis of two-way communications
than the one-way paradigm. Meanwhile, wiretap codes ca-
pable of guaranteeing communication reliability and secrecy
have been proved to exist. Consequently, over years re-
searchers have put a great deal of eﬀort into constructing
practical wiretap codes to achieve asymptotic perfect se-
crecy [19, 11, 10]. Based on these codes, the secrecy (outage)
capacity under diﬀerent constraints, e.g., transmission delay
and power, have also been investigated recently [6, 12, 8].

376While theoretically sound, so far PHY security through the
wiretap channel has not been realized in practice due to its
design and implementation challenges brought by strong as-
sumptions made in theory and the dynamic feature of wire-
less channels, and the feasibility and physical limitations of
implementing the wiretap channel in the real world are yet
to be well understood.

Can we realize the theoretical wiretap channel in the real
world? We answer this question in the aﬃrmative by pre-
senting a practical opportunistic secret communication sys-
tem, letting the legitimate sender communicate secret mes-
sages right away over wireless channels under the wiretap
channel model. The key advantage of our system over cryp-
tographic solutions is in terms of information-theoretic physical-
layer security. As an immediate application, it enables key
exchange between two trusted parties without pre-knowledge
of any shared secret or certiﬁcates to be set up a priori. We
show that it is always possible to establish a secure mes-
sage communication channel which has a “physical advan-
tage” over the eavesdropper in wireless indoor environments.
We, for the ﬁrst time, design and implement a software de-
ﬁned secret communication system on a USRP N210 based
testbed. Our system design has to address several challenges
unique to the nature of multipath fading channels and the
asymptotic assumptions made in theory. To this end, we
present a novel and eﬃcient technique to trade moderate
transmission rate for high secrecy, which takes the advan-
tage of the internal structure of wiretap code construction.
Our experimental results show that there exist multiple “re-
stricted zones”, where if the eavesdropper locates, secret
communications over the wiretap channel can be realized
in the worst channel case. When the knowledge of the chan-
nel statistics are available at the sender, we estimate in-
stantaneous channel capacities on the main channel and the
eavesdropper’s channel in terms of bits per channel use us-
ing measured bit error rates (BERs). To sum up, the main
contributions of our work are as follows.
• We present the design of a secure and reliable secret
communication system under the wireless wiretap chan-
nel. We investigate both the worst channel application
scenario without dynamic knowledge of channel statis-
tics and the scenario where channel statistics are avail-
able for dynamic code selection.

• We tackle the challenges of tuning the theoretical cod-
ing channel to the physical channel, alleviating unreal-
istic and strong assumptions imposed on the theoreti-
cal model, and accessing the instantaneously changing
channel state information in practice.

• We present the implementation and an extensive eval-
uation of our system in a typical indoor environment.
Our results provide a detailed characterization of the
system and uncover the feasibility and constraints for
realizing the wiretap channel in practice.

The remainder of the paper is organized as follows. We
describe the system model and background in Section 2,
and discuss the gap between theory and practice for wire-
tap channel in Section 3. We present the software deﬁned
design of the secret communication system in 4. Extensive
evaluations using simulations are shown in Section 5. We
implement the wiretap channel in the real world and eval-
uate its performance in Section 6. Finally, we conclude our
paper in Section 7.

Figure 1: The wireless wiretap channel model.

2. SYSTEM MODEL AND BACKGROUND
2.1 System Overview

We design and implement a secret wireless communica-
tion system based on the classic wiretap channel model as
illustrated in Fig. 1. In this model, a legitimate sender (Al-
ice) transmits messages to a legitimate receiver (Bob) over
a multipath fading channel (called the main channel), while
an eavesdropper (Eve) passively listens to the messages over
another independent multipath fading channel (called the
eavesdropper’s channel). For the multipath fading chan-
nel, we consider “approximately” quasi-static fading chan-
nels, where fading coeﬃcients remain approximately con-
stant over the transmission of two or more codewords. The
time required to send a single symbol is much smaller than
the duration of a coherence interval. The experimental re-
sults suggest that this theoretical model is most consistent
with our system implementation in indoor environments.

In a slotted system, a codeword is transmitted over N
channel uses. At the end of the transmission of codeword t,
the observed signals at the receiver and at the eavesdropper
are given by:

Y(t) = Hm(t)X(t) + Nm(t) and Z(t) = He(t)X(t) + Ne(t), (1)
respectively, where X(t) ∈ CN is the transmitted signal vec-
tor, Y(t) ∈ CN is the received signal vector by the legiti-
mate receiver, and Z(t) ∈ CN is the received signal vector
by the eavesdropper. The fading coeﬃcient Hm(t) of the
main channel and the fading coeﬃcient He(t) of the eaves-
dropper accounts for the multipath interference in wireless
transmissions. Furthermore, the processes {Hm(t)}t≥1 and
{He(t)}t≥1 are mutually independent and i.i.d., and the
square of the magnitude of the fading coeﬃcients Gm =
||Hm||2 and Ge = ||He||2 are called fading gains.
The transmitted signals are corrupted by the noise vectors
{Nm(t)}t≥1 and {Ne(t)}t≥1, which are i.i.d. complex Gaus-
sian with Nm(t) ∼ CN (0, σ2
e ) at the
receiver and at the eavesdropper, respectively. Finally, the
transmission of {X(t)}t≥1 is subject to a short-term power
constraint 1
N

m) and Ne(t) ∼ CN (0, σ2

E[Xi(t)2] ≤ P .

(cid:80)N

i=1

We consider two typical secret message transmission appli-
cation scenarios in an indoor environment: with the noiseless
main channel and with the noisy main channel. Our exper-
imental results indicate that when Alice communicates to
Bob in a room, the channel between them (i.e., the main
channel) is fairly good and is advantageous over Eve’s chan-
nel (i.e., the eavesdropper’s channel), who hides at certain
locations behind walls.
In the theoretical model, Alice is
always required to know the instantaneous channel state
H = (Hm(t), He(t)). The knowledge of Hm(t) is reason-
able since the legitimate transceivers can always cooperate
to characterize the main channel. We show in Section 4
that, this assumption can be further eliminated when the

ENCODERDECODERALICEBOBEVEDECODERMXHmHeNmNeYZ377main channel is fairly good. When the knowledge of the
channel statistics is necessary to Alice, we place multiple
USRP N210-based sensors around the communicating area,
facilitating channel capacity estimation in a practical set-
ting.
In the system, we also assume that Eve knows the
coding scheme used by Alice.

For each codeword t, by the results in [9] the secrecy
rate that can be achieved in additive white Gaussian noise
(AWGN) channels is
Cs(t) = [Cm(t) − Ce(t)]+,

(2)

= [B log(1 +

P(H)Gm

σ2
m

) − B log(1 +

P(H)Ge

σ2
e

)]+,

where the channel bandwidth B can be normalized to 1,
Cm(t) and Ce(t) denote the capacity of the main channel
(instantaneous maximum achievable rate for the legitimate
receiver) and the capacity of the eavesdropper’s channel (in-
stantaneous maximum achievable rate for the eavesdrop-
per), respectively, P(H) is the power allocation function,
and [x]+ = max{0, x}. The secrecy capacity is the maxi-
mum transmission rate that is achievable, i.e., the number
of bits the receiver can decode per second with no decodable
bits at the eavesdropper. Theoretically, we can transmit
messages securely and reliably with a non-zero transmission
rate (called secrecy rate) whenever the eavesdropper’s obser-
vation Z(t) is “noisier” than Y(t). Note that, in this paper,
we take the ﬁrst step towards the realization of secret com-
munications under the wiretap channel model in practice,
and we do not consider optimal power allocation with the
variations of wireless channels in our system and assume
that the transmit power remains constant during the proto-
col execution. Obviously, by jointly considering the power
allocation the system performance can be further improved,
and we leave it as our future work.
2.2 Wiretap Codes: Properties and Availabil-

ity

To achieve secure and reliable transmission under positive
secrecy rate (the transmission rate is equal to the secrecy
rate when all transmissions are secured), we rely on chan-
nel coding techniques that asymptotically guarantee both
reliability at the intended receiver and secrecy against the
eavesdropper. Such codes are called wiretap codes. In the
coding function, it is the local randomness introduced by
the source (only available to the sender) that enables trans-
mission secrecy. While reliability calls for the introduction
of redundancy to mitigate the eﬀect of channel noise, too
much redundancy will aﬀect the secrecy. These two seem-
ingly contradictory requirements can be precisely controlled
by carefully-designed codes. A typical wiretap code should
satisfy two properties: i) the same message should be rep-
resented by multiple codewords uniquely and the choice of
codewords should be random; ii) the codewords are a func-
tion of original messages M’s and the local randomness R,
which are independent with each other. Using the results
in [2], in our paper we deﬁne the information leakage to the
eavesdropper as

L(Cn) = I(M; Zn|Cn)

= I(Xn; Zn|Cn) − H(R|Cn) + H(R|ZnMCn).

(3)

To achieve reliable communications in full secrecy, we must
choose code Cn that at least ensures the leakage rate 1
≤ ε for arbitrarily small ε > 0.

n L(Cn)

Note that, in this paper, we restrict ourselves to the de-
sign, the implementation and the evaluation of secret com-
munications under the wiretap channel model other than
the design of wiretap codes. In the following discussions, we
introduce two eﬃcient code constructions for our purpose.
2.2.1 Type-I Code: Secrecy Codes for Binary Era-

sure Eavesdropper’s Channel

V

(cid:1), where

1 GT )(cid:0)M

We ﬁrst restrict ourselves to a wiretap channel model
where the main channel is noiseless but the eavesdropper’s
channel is a binary erasure channel (BEC) with erasure
probability . Thus, the resulting capacity of a BEC is 1− .
In real life, this corresponds to the scenario where the le-
gitimate sender and the legitimate receiver communicates
to each other at a short range (e.g., in a room). Due to
the “favorable” main channel, it can be assumed that any
codeword sent by the sender is correctly received by the re-
ceiver. The wiretap codes can be eﬃciently implemented as
follows [19].
Let C0 be an (n, n − k) low-density parity-check (LDPC)
code with a generator matrix G ∈ GF (2)(n−k)×n and a
parity-check matrix H ∈ GF (2)k×n. Under a BEC chan-
n has a threshold ∗ ≥ 
nel, assume C0 with rate r = n−k
to ensure reliability. The encoder maps a k-bit message
M to a n-bit codeword X as X = (GT
G1 ∈ GF (2)k×n is composed of k independent row vec-
tors chosen from {0, 1}n\C0, and V ∈ GF (2)n−k is chosen
uniformly at random. The decoder recovers the message
as M = H1X, where H1 is generated from H. As can be
seen from the above encoding process, one coset code of C0
(which has 2k coset codes) is chosen for every message M,
and the use of V is to choose one codeword from this coset
code. Obviously, 2k possible M’s are corresponding to 2k
possible coset codes. Given its observation Z, which is the
erasured version of X, the eavesdropper’s uncertainty about
M can be ensured if all cosets of C0 are consistent with Z
and they contain the same number of codewords that agree
with Z in the unerased bits. It has been proved in [19] that
when G is the parity-check matrix with an erasure threshold
∗ > 1 − , the leakage rate to the eavesdropper is bounded
n L(Cn) ≤ δ(n), where δ(n) approaches zero as n goes
by 1
to inﬁnity.
It is easy to see that this wiretap code has a
typical binning structure [19] and its security guarantee is
n L(Cn) ≤ ε. In coding theory, a code that
consistent with 1
satisﬁes 1 − r = ∗ is called a capacity-achieving code. Note
that this wiretap code established under the noiseless main
channel does not rely on any capacity-achieving property.
However, the price paid is that the rates arbitrarily close to
the secrecy capacity cannot be achieved.
2.2.2 Type-II Code: Secrecy Codes for Binary Era-
sure Main Channel and Eavesdropper’s Chan-
nel

We move on to another wiretap channel model, in which
the main channel and the eavesdropper’s channel are both
binary erasure channels, with erasure probabilities m and
e (m < e) respectively. In this application scenario, the
legitimate sender and the legitimate receiver are not close
enough to establish an error-free main channel. The wiretap
code is constructed as follows [19].
Let C2 be an (n, nr2) LDPC code with parity-check matrix
H2 ∈ GF (2)n(1−r2)×n, with rate satisfying 1 − r2 ≥ ∗
m ≥
m is the erasure threshold of C2. Let C1 be an
m, where ∗

378(n, nr1) LDPC code with parity-check matrix H1 =(cid:0)H2
(cid:1) ∈
(cid:1), and chooses one codeword uni-
all satisfy (cid:0)H2

e ≥ e ≥ 1 − r2, where
GF (2)n(1−r1)×n, satisfying 1 − r1 ≥ ∗
e is the erasure threshold of C1. The encoder maps an n(r2−
∗
r1) message M to an n-bit codeword Xi (i ∈ [1, 2nr1 ]) which

(cid:1)XT
i = (cid:0) 0

H2

MT

H2

formly at random. The decoder ﬁrst gets all the solution(s)
of H2YT = 0 (Y is the erasured codeword) and then calcu-
lates MT = H2XT to recover the message(s). As n goes to
m ≥ m, the legitimate receiver gets only
inﬁnity, because ∗
one message which is the original one. But the eavesdrop-
per gets 2n(e−(1−r2)) = 2n(r2−r1) diﬀerent messages which
e = e = 1 − r1. This means
cover all possible messages if ∗
that C1 is a capacity-achieving code. The leakage rate to
I(M; Zn|Cn) =
the eavesdropper is then 1
H(R|ZnMCn) = r1 −
I(Xn; Zn|Cn) − 1
limn→∞ 1
n
n log2(2nr1 ) + 0 = 0.
1
3. WIRETAP CHANNEL: THE GAP BETW

n L(Cn) = limn→∞ 1
H(R|Cn) + 1

n

n

n

-EEN THEORY AND PRACTICE

Over the years, the famous wiretap channel for providing
information-theoretic secrecy of communications has been
revisited by many researchers in literature. The results ob-
tained so far are theoretically sound, but there exists a gap
between the wiretap channel model and its secure and eﬃ-
cient implementation in practice. To bridge the gap, we have
to contend with the limitations of unpractical assumptions
in theory and the peculiarities of wireless communication
medium.
3.1 Physical Channel Is More than A Coding

Channel

While constructing codes capable of guaranteeing reliable
communication and at the same time satisfying a secrecy
condition is the key to the success of secret communications
over the wiretap channel, secure and reliable message trans-
mission in a wireless communication system is subject to
many factors, such as data modulation, fading gain, power
allocation, and shift recovering (including time, frequency
and phase shifts) etc. The current state-of-the-art on wire-
tap channel are mainly focused on the construction of prac-
tical and eﬃcient wiretap codes for very general channels
to meet theoretic reliability and security criteria. We found
that multipath channel fadings have a great impact on both
the reliability and security constraints, and the requirement
of optimal conﬁgurations in every step in the theory is hard
to achieve in practice. These ﬁndings inform that the de-
sign and implementation of our secure communication sys-
tem should carefully take into account all practical factors
and integrate them in a systematic way.
3.2 Asymptotic Assumptions Are Not Easy to

Achieve

Modern cryptography usually relies on mathematical prob-
lems assumed to be hard to solve. Diﬀerent from the con-
cept of computational security, information-theoretic secu-
rity skillfully uses asymptotic notions to obtain security guar-
antee. As the wiretap channel model, the security and reli-
ability of the theoretical construction are feasible only when
the code length n of the wiretap codes tends to inﬁnity. Be-
sides, in some speciﬁc channels the communication security
highly relies on capacity-achieving codes, the existence of
which is also proved using the asymptotic notion theoreti-

(a) Capacity vs. distance

Figure 2: The average variations of capacity with
the increase of communicating distance. Here, Alice
and Bob are inside our lab, and Eve, which is behind
a wall, is located and tested in diﬀerent positions
along the hallway.

cally. In the real world, however, the code length cannot be
extremely long due to the eﬃciency concern. From the prac-
tical perspective, it is necessary to alleviate the strict and
strong asymptotic assumptions, and our experimental ﬁnd-
ings inform the practicability of exploiting a small concrete
code length and the relaxation of the strict requirement of
capacity-achieving codes in the implementation.
3.3 The Accessibility of Changing Channel St

-ate Information

In theory, for ease of analysis it is explicitly assumed that
channel statistics are known a priori. From the practical
perspective, the assumption that the statistics of the main
channel are perfectly known can be reasonable because the
legitimate transceivers can always cooperate to characterize
their pairwise channel. However, the assumption that the
eavesdropper’s channel statistics are known ahead of time
remains questionable. The good news is that theoretical re-
sults inform this stringent requirement can be somewhat al-
leviated for a class of stochastically degraded channels when
the wiretap channel ensures equivocation for the worst chan-
nel case [2] (i.e., the most favorable eavesdropper’s channel
from Eve’s perspective). So, the question becomes does the
“worst channel” exist in the real life? Also, as presented in
Section 4.1.1, our experimental results show that the chan-
nel capacity at any ﬁxed position varies quite fast from time
to time. How to deal with the changing channel state in-
formation also poses a challenging problem to the practical
and secure system design.

4. THE SOFTWARE DEFINED SECRET C

-OMMUNICATION SYSTEM DESIGN

Our system implements a software deﬁned radio for en-
abling secret communications between Alice and Bob. At
the start of the communication, Alice ﬁrst performs chan-
nel coding and adds barker code to help synchronize the
encoded data. Then, she modulates the coded data into
complex signals and scrambles them. Finally, Alice trans-
mits the signals to Bob over the wireless channel. At the re-
ceiver end, Bob ﬁrst executes shift recovering on the received
channel-attenuated signals. Then, he uses the matched de-
scrambler to descramble the signals and demodulates them
into bit streams, from which barker codes are applied to gen-
erate data frames. Finally, Bob performs channel decoding
to recover the original message. From the perspective of the
eavesdropper, Eve follows exactly the same signal processing

010203040506000.10.20.30.40.50.60.70.80.91Distance (m)Capacity (bit/channel use)d0d1379(a) Restricted zones.

(b) Capacity of the main channel. (c) Capacity of the eavesdropper’s channel.
Figure 3: Characterization of restricted zones for Eve under the worst channel in indoor wireless environ-
ments. The right two ﬁgures demonstrate the feasibility of establishing a secret message transmission system
over the wiretap channel. Here, each block on the ﬂoor is of 0.36m2, and each frame is the time interval
between the transmission of two consecutive codewords.

procedures as Bob, but as a result of our wiretap codes, she
is kept ignorant of the original message. Rather than de-
scribing the well-known aspects of wireless communications,
in this section we focus on the whole design thoughts and
solutions unique to our implementation.
4.1 Dealing with Dynamic Changes of Chan-

nel State Information

For short-range wireless communications in an indoor en-
vironment, there are mainly three circumstances. As can
be seen in Fig. 2, when the distance d between two com-
municating parties is less than a threshold d0, the signal
that arrives at the receiver is strong enough for successfully
recovering the original message, albeit with amplitude ﬂuc-
tuations due to the channel fading. When d0 ≤ d ≤ d1, the
receiver receives the signal with weak strength such that it
is more easily aﬀected by noise interference. As the distance
exceeds d1, the original signal is overwhelmed by noise. Due
to the changing wireless environment, the values of d0 and
d1 may vary over a period of time.

The variation of wireless channels mainly comes from the
path loss, reﬂection, diﬀraction, scattering and shadowing
etc. Speciﬁc to the indoor wireless communication, walls
have a great impact on signal blocking. Measures in [17]
indicate that when the communicating parities operating at
900MHz are separated by a single wall/ﬂoor, the attenua-
tion ranges from 10 to 20dB. Meantime, the signal propaga-
tion path is also changing frequently, and it directly aﬀects
the phase of the received signal. In our implementation, we
choose carrier frequency fc = 850MHz. When d0 ≤ d ≤ d1,
the fast phase change causes the ﬂuctuation of the strength
of the combined signal. Accordingly, the eﬀect of multipath
fading is the signiﬁcant cause for channel capacity varia-
tions. In our implementation, we use phase compensation
algorithm [15] to alleviate the eﬀect of phase variations. We
also use the numerically-controlled oscillator and the phase-
locked loop to combat frequency drift at the sender and the
receiver, respectively.

In order to achieve the maximum secret rate, the coding
matrix for channel coding is determined by channel capaci-
ties Cm and Ce, i.e., the coding matrix should be dynami-
cally generated with the variations of Cm and Ce (The im-
plementation of Type-I and Type-II wiretap codes will be
discussed in detail in Section 6). Obviously, the faster chan-
nel capacities change the higher eﬃciency requirements of
matrix generation and wiretap channel coding. In practice,
the dynamic matrix generation approach will be unaccept-
able if the coding matrix generation time is larger than the

coherence time. In this subsection, we present and charac-
terize our two designs through real world measurements on
a USRP N210-based testbed.

4.1.1 Characterizing Restricted Zones for Eve Un-

der the Worst Channel

The secrecy and reliability of wiretap channel coding are
highly sensitive to the changes of Cm and Ce. To deal with
the dynamic changes of channel capacity, our ﬁrst idea is to
choose the worst channels of both the main channel and the
eavesdropper’s channel for wiretap coding. Before present-
ing the scheme, we ﬁrst illustrate the intuition behind this
idea by looking at the following deﬁnition and propositions.
Deﬁnition 1. (Stochastically degraded channel [1, 4])(X ,
pZ|X,Z) is stochastically-degraded with respect to (X , pY|X,Y)
if there exists a channel (Y, pZ|Y,Z) such that ∀(x, z) ∈

X × Z, pZ|X(z|x) =(cid:80)

y∈Y pZ|Y(z|y)pY|X(y|x).

Proposition 1. (Robustness of worst-case design [2]) Given
a class of stochastically-degraded eavesdropper’s channels, a
wiretap code ensuring equivocation for the worst channel
guarantees at least the same equivocation E for any eaves-
dropper’s channel in the class.

Here, the eavesdropper’s equivocation is the average uncer-
tainty of Eve about message M. Proposition 1 tells us that a
wiretap code that guarantees the security through an eaves-
dropper’s channel can guarantee the security through any
channel that is a degraded version with respect to this wire-
tap channel. The above theoretical results motivate us to
seek the worst channel case (i.e., the most favorable eaves-
dropper’s channel from Eve’s perspective) and validate if
there exist a class of stochastically-degraded eavesdropper’s
channels physically.

Fig. 3 depicts the characterization of the capacity distribu-
tion for the eavesdropper’s channel, on the basis of capac-
ity measurements in our indoor environment. Speciﬁcally,
Fig. 3 (b) shows the cases where Cm achieves the maximum
capacity 1 for a noiseless channel, and it is above a thresh-
old 0.7 for a noisy channel all over the time. Such favorable
channels can be easily obtained when Alice and Bob commu-
nicates in a room, e.g., as large as 97m2 in our test. For the
eavesdropper behind a wall, Fig. 3 (c) shows that although
Ce varies with time, there exist a number of locations where
the capacity is always below a certain value, e.g., 0.4 in the
ﬁrst location and 0.8 in the second location. This visible
capacity diﬀerence between Cm and Ce can be leveraged to

12345051000.51Width (# of blocks)Length (# of blocks)Capacity (bit/channel use)Zone 2Zone 105010015020025030000.51Time (# of frames)Capacity (bit/channel use)Noiseless main channel0501001502002503000.50.60.70.80.9Time (# of frames)Noisy main channel05010015020000.51Eavesdropper's Channel (location 1)05010015020000.51Eavesdropper's Channel  (location 2)05010015020000.51Eavesdropper's Channel  (location 3)Time (# of frames)Capacity (bit/channel use)380e

e

m ∈ (0, 1]. Obviously, Cmin

build a secret message transmission system under the wire-
tap channel model. Our experimental results in Fig. 3 (a)
further suggest that around Alice and Bob there exist cer-
tain “restricted zones”, where the eavesdropper’s channel ca-
pacities in this area are all below a threshold, denoted by
∈ (0, 1). That is, in such a restricted zone, no mat-
Cmax
ter how channel state changes with the time-varying eaves-
dropper’s channel, Ce will not exceed Cmax
. We call it the
worst channel with respect to the eavesdropper’s channel.
On the other hand, the worst channel with respect to the
main channel is the minimum channel capacity achieved by
Alice and Bob in their communicating area, and we denote
it by Cmin
m = 1 for a noiseless
main channel. In practice, it is easy to obtain a reasonably
high Cmin
m when Alice and Bob are not far away. Once ob-
taining Cmax
> 0, it is
possible to provide the communication security and reliabil-
ity guarantee no matter how the channel state changes over
time. Note that, our experimental results also indicate that
unless the environment changes dramatically, the movement
of people and objects does not aﬀect the thresholds much.
In the real world, potential eavesdroppers can always be
considered to be located at some restricted areas, and the
legitimate communicating parties are not likely to talk with
each other unless the potential eavesdropper is kept at an
alert area. As can be seen from the discussion above, the
solution of characterizing restricted zones for Eve under the
worst channel case does not require the knowledge of the
eavesdropper’s channel capacity in real time, which elimi-
nates the strong assumption of knowledge of the instanta-
neous channel states.

m satisfying Cmin

m − Cmax

and Cmin

e

e

e

e

m and C ins

4.1.2 Enabling Dynamic Channel Capacity Feedback
While the ﬁrst solution to contend with time-varying chan-
nels requires the characterization of restricted zones for the
eavesdropper, our second idea is to cover a wide range of area
for communication security. To this end, Alice needs to ob-
tain the instantaneous channel capacities C ins
to
dynamically adjust the coding strategy. As discussed before,
Alice and Bob can always cooperate to characterize the main
channel. To facilitate the acquisition of the instantaneous
capacity of the eavesdropper’s channel, we place multiple
USRP N210-based sensors as the helper nodes to compute
and feed back C ins
to Alice. Fig. 4 depicts the cumulative
distribution function (CDF) of channel capacity diﬀerences
over the transmission time of two codewords at diﬀerent lo-
cations in our indoor environment. It can be seen that, for
most of the time, the capacity diﬀerence is less than 0.3,
which is applicable in our system implementation. Our re-
sults show that given an eﬃcient wiretap code, it is suﬃcient
to measure and utilize fed-back C ins
as the input of chan-
nel coding. Similar to the worst channel case, we can also
adopt a conservative strategy to contend with the coding
eﬃciency and the dynamic changes of channel capacity. To
do so, the coding matrix corresponding to a speciﬁed capac-
ity pair (C std
) can be pre-determined, and the secure
transmission strategy works as follows: Alice transmits mes-
sages coded using the pre-determined coding matrix to Bob
if and only if both C ins
m and C ins
hold; oth-
erwise Alice does not transmit anything.

m ≥ C std

e ≤ C std

m , C std

e

e

e

The advantage of utilizing dynamic channel capacity feed-
back is to place no restrictions on the eavesdropper’s lo-
cations.
It applies to the application scenario where it is

Figure 4: Capacity diﬀerence between two consecu-
tive frames. A frame is approximately the time for
one codeword transmission.

diﬃcult to ﬁnd the “worst case”, e.g., the worst channel ca-
pacity of the main channel Cmin
m is too bad and/or the worst
channel capacity of the eavesdropper’s channel Cmax
is too
good. In Section 6, we will implement and analyze both of
the above two solutions.
4.2 Estimating Channel Capacity for Dynamic

e

Code Selection

As described in Section 4.1.2, our second solution requires
the feedback of channel capacity updates to determine the
message transmission strategy. In general, channel estima-
tion is widely used in telecommunication systems to obtain
the channel state information for counteracting the eﬀect
of multipath fading and/or facilitating optimal allocation
of transmit power. Diﬀerent from existing telecommunica-
tion systems, the channel statistics concerned in our system
are channel capacities. In information theory, the notion of
channel capacity is deﬁned as the maximum of the mutual
information between the input and the output of the chan-
nel, where the maximization is taken with respect to the
input distribution

C = sup
pX(x)

I(X; Y),

(4)

where the supremum is taken over all possible choices of
pX(x). Note that, if the channel is a binary input and output
channel, C is measured as bits per channel use. As seen in
Eq. (2), if speciﬁc to an AWGN fading channel, the capacity
or the achievable rate can be written as

C = B log(1 + SNR)

= B log(1 +

P(H)Gm

σ2
m

(5)

),

where the channel bandwidth B can be normalized to one
and SNR is the signal-to-noise ratio. As for this metric, C
is measured in bits per second if the logarithm is taken in
base 2.

Note that, metric (5) is a special case of metric (4). With
metric (5), we can make more use of the characteristics of
wireless channels such as dynamically allocating transmis-
sion power by using fading coeﬃcients and performing adap-
tive modulation, which will lead to a higher rate. However,
for simplicity, we don’t use metric (5) in our implementa-
tion. We leave the realization of dynamic power control and
adaptive modulation as our future work.

Since quadrature phase shift keying (QPSK) leads to a
symmetric error rate, we can abstract the wireless channel
into the Binary Symmetric Channel (BSC). Then, the in-
stantaneous bit error rate (BER) is the cross-over probabil-
ity of the BSC. Now it is easy to get metric (4) through chan-

00.10.20.30.40.50.60.70.50.550.60.650.70.750.80.850.90.951Capacity difference of two consecutive framesCDF distribution  Location 1Location 2Location 3Location 4381nel transfer matrix by using the formulation of the BSC ca-
pacity or iteration algorithms [14]. In order to obtain a more
accurate estimation, we compute the instantaneous BER
by transmitting training sequences before message transmis-
sion. Note that, our channel has been abstracted into the
BSC, and thus no more than one bit message can be trans-
mitted per channel use, causing the maximum capacity in
bits per channel use to be one, which is more convenient for
our coding design.
4.3 Achieving Practical Coding for the Wire-

tap Channel

Proposition 1 tells us that a wiretap code designed for a
speciﬁc eavesdropper’s channel can be used over any other
eavesdropper’s channel due to the stochastically-degraded
channel property. The following proposition shows that all
binary-input channels are stochastically degraded with re-
spect to binary erasure channels with certain erasure prob-
ability.

Proposition 2. ([2]) A memoryless binary-input channel
({0, 1}, pY|X,Y) is stochastically degraded with respect to
an erasure channel with erasure probability

(6)

(cid:90)

y

 =

(cid:0) min

u∈[0,1]

pY|X(y|u)(cid:1)dy.

This implies that wiretap codes designed for an eavesdrop-
per’s BEC can be used over any binary-input channel by
simply converting the channel into a stochastically-degraded
version of BEC. This proposition gives the suﬃcient con-
dition for realizing secret communications over non-BECs.
As shown in Section 6, our experimental ﬁndings indicate
that this proposition actually provides a conservative solu-
tion, and a much higher transmission rate can be achieved
by properly overestimating the capacity of eavesdropper’s
channel.

As discussed in Section 2.2, in theory the existing avail-
able wiretap codes can asymptotically guarantee both se-
crecy and an arbitrarily small probability of error at the
intended receiver. In a practical system, however, the code-
word length n cannot be arbitrarily large. Our design and
implementation restrict the codeword length n to an accept-
able range, which is suﬃcient for achieving reliability and se-
crecy. Speciﬁcally, under a practically short codeword length
n, we propose to sacriﬁce moderate amount of transmission
rate for secrecy when the main channel is noiseless (using
Type-I code) or noisy (using Type-II code). In the follow-
ing discussion, we show how to achieve our goal through
elaborate analysis.

Proposition 3. ([19]) Let an (n, n − k) code C have a gen-
erator matrix G = [a1, ..., an], where ai is the i-th column
of G. Consider an instance of the eavesdropper’s obser-
vation Z ∈ {0, 1, ?}n with µ unerased positions given by
{i : Zi (cid:54)=?} = {i1, i2, ..., iµ}. Z is secured by C iﬀ the matrix
Gµ = [ai1 , ai2 , ..., aiµ ] has rank µ.

Proposition 4. ([2]) Let H be the parity-check matrix of a
length-n LDPC code selected uniformly at random in an en-
semble whose block error probability threshold under belief-
propagation decoding for the erasure channel is ∗. Form
a submatrix H(cid:48) of H by selecting each column of H with
probability  < ∗. Let the block error probability be Pe.
Then, P[rank(H(cid:48)) = n] = 1 − Pe = 1 − δ(n).

Based on Propositions 3 and 4, we have the following the-

orem for Type-I wiretap code.

Theorem 1. For Type-I wiretap code, under a ﬁxed code-
word length n the information leakage L(Cn) can be reduced
by overestimating the capacity of the eavesdropper’s channel
Ce.

Proof. According to Propositions 4 and the construction
of Type-I code, if we use the parity-check matrix H of a
LDPC code with threshold ∗ as the generator matrix G and
the capacity of the eavesdropper’s channel BEC(e) satisﬁes
1− e < ∗, then for a ﬁxed codeword length n, a submatrix
formed by selecting each column of H with probability 1−e
will have full rank with probability 1 − δ(n). According to
Propositions 3, because the number of unerased bits is also
n(1 − e), this is equivalent to say that Eve’s observation Z
is secured with probability 1 − δ(n).

Motivated by this observation, for Type-I wiretap code
we can deﬁne the block leakage probability Pl, which de-
notes the probability that Z is not secured. That is to say,
the information leakage L(Cn) = nPl. Note that, a gen-
eral LDPC code focuses on the reliability and thus uses
the block error probability Pe as the performance metric,
which denotes probability that the erased bits’ correspond-
ing columns in the generator matrix are not in full rank. Our
Type-I wiretap code focuses on the secrecy and thus uses the
block leakage probability Pl, which denotes the probability
that the unerased bits’ corresponding columns in the gen-
erator matrix are not in full rank.
Inherently, Pe and Pl
both denote the probability that the selected columns with
a speciﬁc probability  ( ≤ ∗) from the generator matrix
are not in full rank. When the two probabilities ’s are the
same, which means the number of erased bits in the ﬁrst
case is the same as the number of unerased bits in the sec-
ond case, they are equal in value. Obviously, we can have
L(Cn) = nPl = nδ(n), where n is ﬁxed. Note that δ(n) not
only approaches 0 as n goes to inﬁnity but also does when
Ce approaches 0. This is because when Ce approaches 0,
the eavesdropper’s channel becomes worse. Hence, with a
ﬁxed code, the leakage to the eavesdropper obviously be-
comes less, i.e., Pl, which shares the same value as δ(n),
approaches 0. In the extreme case, if we apply the code for
BEC(e) to the eavesdropper’s channel with erasure prob-
ability 1, then δ(n) = 0. So L(Cn) is reduced to 0. This
approach that applies codes used in C +
e > Ce)
is called an overestimation of eavesdropper’s channel. That
is, if we obtain an eavesdropper’s channel with capacity Ce,
we overestimate it as C +
e , based on which we select the code
e > Ce. Then L(Cn) is reduced.
with threshold β∗ > C +

e to Ce (C +

Remarks. While the overestimation of Ce reduces the in-
formation leakage, it also reduces the transmission rate si-
multaneously. Note that in this paper, the transmission rate
is discussed in the context of secrecy, i.e., the transmission
rate is the secrecy rate when the message is transmitted at
a rate lower than the secrecy capacity. The proof indicates
that we can measure the tradeoﬀ between the transmission
e − Ce in our experiments for
rate and the secrecy by ∆ = C +
Type-I wiretap code.

In our implementation, we adopt ﬁxed wiretap codes for
the worst channel case. The idea of utilizing a ﬁxed wire-
tap code (i.e., keep the generation and parity-check matrices
constant) can be considered as a conservative strategy when

382reliability of decoding cannot be fully guaranteed. In this
case, the possible decoded codeword is not unique, so we use
θ to measure the results when errorless transmissions over
the eavesdropper’s channel are not available.

Theorem 2. For Type-II wiretap code, under a ﬁxed code-
word length n, C1, C2 and C2 have code rates r1, r2 and
r2 − r1 and parity-check matrices H1, H2 and H2, respec-
tively. The information leakage L(Cn) can be reduced by
using a non-capacity-achieving code C2.

Proof. Assume that the eavesdropper’s channel has era-
sure probability e, and the main channel has erasure prob-
ability m. Then Y has nm erased bits and Z has ne erased
bits. Let θ be the equivocation loss/information entropy loss
after decoding by H2Z = 0. As n goes to inﬁnity, the leak-
age L(Cn) = n(r2 − r1 − e) + θ. If C1 is a capacity-achieving
code, then e = 1 − r1. When θ ≤ n(1 − r2), the leak-
age is zero. For a ﬁxed codeword length n, the leakage will
not be zero. We denote the leakage rate induced by a ﬁxed
codeword length n by δ(n). The leakage now increases to
n(r2 − r1 − e) + θ + nδ(n). We use a non-capacity achieving
code C2 with threshold ∗ < 1 − r2 and a capacity-achieving
code C1. Thus, we have e = 1 − r1. Now the leakage be-
comes n(r2 − 1) + θ + nδ(n). If (1− r2)− ∗ is large enough,
by Lemma 1, we can make θ close to n(1− r2)− nδ(n), then
the leakage is approaching zero. As shown in Fig. 5, the
equivocation loss θ can be carefully controlled to approach
n(1 − r2) − nδ(n) by adjusting the code rate r2. The inter-
section point indicates the leakage can be reduced to zero.
However, if C2 is capacity-achieving, then ∗ = 1 − r2 and
θ has only one value, i.e., n∗ = θ = n(1 − r2). So, we
have L(Cn) = nδ(n). When the codeword length n is ﬁxed,
then δ(n) > 0 and the leakage L(Cn) cannot be reduced to
approach zero.

Theorem 2 shows the information leakage can be reduced
by using a non-capacity-achieving code C2. The following
theorem shows that the strict requirement of the capacity-
achieving property for C1 can be further relaxed.

Theorem 3. For Type-II wiretap code, under a ﬁxed code-
word length n, secrecy can be guaranteed by using the non-
capacity-achieving codes C2 and C1.

Proof. Based on Theorem 2, when C1 is not a capacity-
achieving code, we have e < 1 − r1. Denote the diﬀerence
between e and 1 − r1 by µ, so e + µ = 1 − r1. Due to the
use of a ﬁxed code length n and a non-capacity-achieving
code C1, the leakage L(Cn) = n(r2 − r1 − e) + θ + nδ(n) =
n(r2 + µ− 1) + θ + nδ(n). Similar to Theorem 2, when C2 is
a non-capacity-achieving code and the diﬀerence (1 − r2) −
∗ is large enough, θ can be adjusted to make it close to
n(1 − r2 − µ) − nδ(n). So, secrecy can be achieved without
requiring C1 to be a capacity-achieving code given a ﬁxed
codeword length n.

As can be seen, for Type-II wiretap code, the diﬀerence
(1−r2)−∗ measures how much C2 is not capacity-achieving,
so we measure the tradeoﬀ between the transmission rate
and the secrecy by ∆ = (1−r2)−∗ = (1−r2)−m = Cm−r2
when ∗ = m.

Theorems 1, 2 and 3 lay the foundations for trading trans-
mission rate for secrecy (leakage reductions). In Section 6,
we show the eﬀectiveness of trade-oﬀs for achieving nearly
perfect secrecy given a ﬁxed codeword length n.

Figure 5: Control of equivocation/information en-
tropy loss θ to approach n(1− r2)− nδ(n). Here, code-
word length n = 120, the erasure probability of the
eavesdropper’s channel e = 0.75 and the threshold
∗ = 0.25.

there is no channel state information feedback. We ﬁnd
that the adoption of a ﬁxed code is equivalent to the over-
estimation of Ce. For example, if the ﬁxed code can only
be suitable for the eavesdropper’s channel with capacity less
than or equal to 0.7, then we actually overestimate Ce when
applying the code to the channel with Ce less than 0.7.

In wiretap coding approaches, capacity-achieving codes
are more preferred due to their high eﬃciency. As discussed
in Section 2.2.2, for Type-II wiretap code, C1 must be a
capacity-achieving code to guarantee secrecy. Intuitively, it
seems that selecting a capacity-achieving code as C2 is also
the best choice. However, our following ﬁndings reveal that
the use of a non-capacity-achieving code for C2 can enhance
the security strength by sacriﬁcing moderate transmission
rate.

Lemma 1. Assume code C2 is a length-n LDPC code for
a BEC() with threshold ∗ and code rate r, H2 is the
parity-check matrix of C2, Z the BEC()-attenuated ver-
sion of transmitted codeword X, and θ is the equivocation
loss/information entropy loss after decoding by H2Z = 0. If
∗ ≤ 1 − r, ∗ ≤  ≤ 1, then θ can be controlled in the range
n∗ ≤ θ ≤ n(1 − r) by adjusting the relationship between
∗,  and r.

Proof. When ∗ ≤  ≤ 1, θ increases with the increase
of . The equivocation loss/information entropy loss θ after
decoding is determined by the rank of columns correspond-
ing to the erased bits in H2. Because rank(H2) = n(1 − r),
we have θ ≤ n(1 − r). We next deﬁne two erasure chan-
nels BEC(1) and BEC(2) with 1 < 2. Because the
average number of erased bits of BEC(2) are more than
those of BEC(1), the number of columns corresponding
to BEC(2)’s erased bits is larger than that of BEC(1).
Consequently, the average rank of randomly selecting n2
columns from H2 is larger than that of randomly selecting
n1 columns from H2. This implies that the information en-
tropy loss after decoding over BEC(2) is deﬁnitely larger
than that over BEC(1).
We next determine the range of θ. If  = ∗, then θ = n∗
as n goes to inﬁnity; if  = 1, then θ is obviously equal to
n(1 − r). So, we can adjust the relationship between ∗, 
and r to increase or decrease θ between n∗ and n(1−r).

Remarks. In the above Lemma, we deﬁne θ as the infor-
mation entropy loss other than information bits that can be
recovered after decoding. Note that when  < ∗, both of
them are equal to n. In our Type-II wiretap code, we focus
on the case  > ∗ for the eavesdropper’s channel, where the

0.250.30.350.40.450.50.550.60.650.7406080100120140160Code rate r2Information entropy (bits)  n(1-r2)-n(n)3835. SIMULATION RESULTS

In this section, we provide a comprehensive simulation
study to evaluate the system performance. In the next sec-
tion, we further implement the wiretap channel in a real
system and report experimental performance results. The
following metrics are used to evaluate the system perfor-
mance in both simulation and experimental studies.

• Equivocation (E): E is deﬁned as the entropy of Md,
where Md is a random variable representing the mes-
sage decoded by the eavesdropper, and the original
message set is denoted by M. Therefore, E = H(Md) =
m∈M pm log pm, where pm is the probability that

−(cid:80)

Md = m.

• Bit Error Rate (BER): the ratio of the number of bits
in the decoded message diﬀerent from the original mes-
sage to the total number of bits in the original message.
• Block Error Rate (BLER): the ratio of the number of
decoded messages diﬀerent from the original messages
to the total number of the original messages.

Here, E and BLER are used to measure the system secu-
rity performance and reliability performance, respectively.
Note that, we can use BER to measure both the system se-
curity performance (with respect to the eavesdropper) and
reliability performance (with respect to the legitimate re-
ceiver).

To evaluate the system performance, our strategy is to
randomly generate a message, and then encode the message
thousands of times to get thousands of wiretap codewords,
which are transmitted over the main channel and the eaves-
dropper’s channel. Note that, the number of times to encode
and transmit a message increases exponentially with the in-
crease of the message bit length k. As a result, it is extremely
time-consuming to evaluate the system performance on the
oﬀ-the-shelf machines when the message bit length is rela-
tively large. Without loss of generality, to solve this problem
and improve the practicality of the system, we limit k to be
a small value in our simulations and experiments, say 10bits.
Note that the message length does not aﬀect the evaluation
of the system security and reliability performance.
5.1 Wiretap Code Implementation

In this subsection, we present the implementation details

of wiretap codes introduced in Section 2.2.

Theoretically, we need to convert the BSC with cross-over
probability p(p < 1
2 ) into a degraded version of BEC, and
then generate coding matrices by using the threshold ∗ of
LDPC code and the erasure probability . While the con-
version does help us to achieve nearly perfect secrecy, it does
not make full use of channel characteristics [2], and there-
fore sacriﬁcing too much transmission rate especially when
the code threshold ∗ is much smaller than 1 − r. Our ex-
periments demonstrate that we can transmit messages at
a much higher rate by merely using the transmission rate
tradeoﬀ ∆ (we proposed), rather than converting a BSC to
a degraded version of BEC, to achieve nearly perfect secrecy
performance.

In both Type-I and Type-II wiretap codes, we adopt regu-
lar LDPC codes and use Gallager’s algorithm [5] for parity-
check matrix generation and Message-Passing decoding al-
gorithm [18] for LDPC decoding. To implement Type-I wire-
tap code, we ﬁrst determine a suitable codeword length n

Figure 6: Distribution of uniformly randomly gen-
erated messages.

(a) ∆ = 0.06

(b) ∆ = 0.16

(c) ∆ = 0.32

Figure 7: Message distribution when n = 60.

(cid:1).

V

1 GT )(cid:0)M

e according to Theorem 1, i.e., C +

through preliminary experimental results. Based on Ce, we
overestimate it as C +
e >
e × n LDPC parity-check
Ce. Then we can construct a nC +
matrix H as the generator matrix G in X = (GT
For a non-capacity-achieving LDPC code, we can determine
k = n(1− C +
e ). To obtain G1, we generate a k1 × n (k1 > k)
parity-check matrix, from which k rows are selected as G1’s
k independent vectors x1, . . . , xk satisfying Hexi (cid:54)= 0, where
HHT
e = 0, i.e., He is the parity-check matrix of H when
H is used as G. To implement Type-II Wiretap Code, we
also choose a ﬁxed codeword length n. Based on Cm and
Ce, we ﬁrst construct an n(1 − r1) × n parity-check matrix
H1 (we assume C1 is a capacity-achieving LDPC code for
ease of exposition, however, according to Theorem 3 a non-
capacity-achieving LDPC code can also be used for C1 with-
out loss of privacy guarantee). So we have r1 = Ce. Then,
we select n(1 − r2) rows from H1 as H2 (corresponding to
a non-capacity-achieving LDPC code C2), where Cm > r2
and H2 ensures the reliability at the receiver. Finally, the
remaining n(r2 − r1) rows constitute H2.

In our system design, we introduce transmission rate trade-
oﬀs to enhance the system security (i.e., message secrecy)
and make the Type-I and Type-II codes practical in real sys-
tems by alleviating the theoretical assumption of requiring
a large codeword length n. In the simulation study, since
we mainly focus on evaluating the eﬀects of transmission
rate tradeoﬀ ∆ on the system performance, the capacities of
both the main channel and the eavesdropper’s channel are
assumed to remain constant over time.
5.2 Performance Evaluation for the Noiseless

Main Channel

When the main channel is noiseless, Type-I code is adopted
for encoding. We only evaluate the secrecy performance
since channel reliability is readily satisﬁed for a noiseless
channel. We evaluate the performance under diﬀerent code-
word length n and transmission rate tradeoﬀ ∆. Note that
we keep the coding matrices (or say C +
e ) and message length
unchanged but change the tradeoﬀ value, the real capacity
of the eavesdropper’s channel will change correspondingly.
Fig. 6 shows the distribution of the uniformly randomly
generated messages and its equivocation E = 9.9921. We
call this distribution as perfect distribution, which is used as
the benchmark. Figs. 7, 8 and 9 show the distributions of

Message Index2004006008001000Probability10-300.20.40.60.811.21.4Message Index2004006008001000Probability10-3012345Message Index2004006008001000Probability10-300.511.52Message Index2004006008001000Probability10-300.20.40.60.811.2384C+
e
∆
Ce
E

BERe

Codeword length n = 60
0.8332
0.8332

0.8332

0.06

0.7732
9.9714
0.4998

0.16

0.6732
9.9917
0.4996

0.32

0.5132
9.9923
0.5000

Codeword length n = 120 Codeword length n = 240
0.9139
0.9563

0.9139

0.9139

0.9563

0.9563

0.06

0.8539
9.9902
0.4994

0.12

0.7939
9.9923
0.4993

0.19

0.7239
9.9928
0.4998

0.02

0.9363
9.9678
0.5000

0.04

0.9163
9.9915
0.5000

0.06

0.8963
9.9923
0.4991

Table 1: Performance comparison under diﬀerent n and ∆ for Type-I code.

(a) ∆ = 0.06

(b) ∆ = 0.12

(c) ∆ = 0.19

Figure 8: Message distribution when n = 120.

(a) ∆ = 0.2667

(b) ∆ = 0.4167

Figure 10: Message distribution when n = 60.

(a) ∆ = 0.02

(b) ∆ = 0.04

(c) ∆ = 0.06

Figure 9: Message distribution when n = 240.

the received messages at the eavesdropper for diﬀerent val-
ues of n and ∆, respectively. Generally speaking, the more
similar between the distribution of the received messages
and the perfect distribution, the higher message secrecy of
the system.

As can be observed, the distribution of received messages
becomes more and more similar to the perfect distribution
when the transmission rate tradeoﬀ ∆ increases for the same
codeword length n. Accordingly, as shown in Table 1, the
equivocation E increases as the value of transmission rate
tradeoﬀ ∆ increases for the same codeword length n. It is
shown that when n = 60 and ∆ = 0.32, the equivocation
E = 9.9923, which is very close to 9.9921, i.e., the equiv-
ocation of perfect distribution. Therefore, we can conclude
that the system achieves nearly perfect secrecy by introduc-
ing the transmission rate tradeoﬀ. More importantly, it can
be observed that the introduction of ∆ can also weaken the
inﬂuence of the codeword length n to the message secrecy
performance. Meanwhile, by introducing the tradeoﬀ the
bit error rate BERe is very close to 0.5, which also implies
that the system achieves nearly perfect secrecy. Moreover,
as expected, only a smaller ∆ is required for a larger n to
achieve the same equivocation.

It is worth noting that in theory the wiretap channel
achieves perfect secrecy when the codeword length goes to
inﬁnity. However, with the help of the transmission rate
tradeoﬀ, the wiretap channel can also achieve nearly perfect
secrecy even for a small codeword length, which validates
the correctness of Theorem 1.
5.3 Performance Evaluation for the Noisy Main

Channel

We next consider the second scenario where the main
channel is noisy and Type-II wiretap code is adopted for
message encoding. Note that we keep the message length
unchanged but change r2, and thus Ce and r1 will change
correspondingly.

Figs. 10, 11 and 12 show the distributions of received mes-
sages under diﬀerent values of n and ∆. As in the noiseless

(a) ∆ = 0.2083

(b) ∆ = 0.5491

Figure 11: Message distribution when n = 120.

(a) ∆ = 0.2748

(b) ∆ = 0.3552

Figure 12: Message distribution when n = 240.

∆
Cm
Ce
E

BERe
BERm
BLERm

n = 60

n = 120

n = 240

0.2667
0.8056
0.3199
9.9623
0.4885
0.0017
0.0084

0.4167
0.8056
0.1699
9.9929
0.4996

0
0

0.2083
0.8056
0.4706
9.7384
0.5001
0.0005
0.0024

0.5491
0.8056
0.1298
9.9928
0.499

0.000097

0.0009

0.2748
0.8056
0.4802
9.9037
0.4664
0.0019
0.0071

0.3552
0.8056
0.3998
9.9921
0.4991

0.000008
0.00005

Table 2: Performance comparison under diﬀerent n
and ∆ for Type-II code.
main channel case, the equivocation E increases as ∆ in-
creases. The block error rate BLERm and the bit error rate
BERm of the main channel are shown in Table 2. It is easy
to see that both BERm and BLERm are very close to 0.
That means the system can achieve nearly perfect secrecy
and reliability by introducing the transmission rate trade-
oﬀ.

Compared to the noiseless scenario, Type-II wiretap code
can be used for a noisy main channel, so it can work well for
long-range communications. However, when the main chan-
nel is noisy, a much larger ∆ has to be used to realize nearly
perfect secrecy, i.e., a larger capacity diﬀerence between Cm
and Ce is required and Ce cannot be very large.

Message Index2004006008001000Probability10-300.511.522.5Message Index2004006008001000Probability10-300.511.52Message Index2004006008001000Probability10-300.20.40.60.811.2Message Index2004006008001000Probability10-300.511.522.5Message Index2004006008001000Probability10-300.511.52Message Index2004006008001000Probability10-300.20.40.60.811.2Message Index2004006008001000Probability10-300.511.5Message Index2004006008001000Probability10-300.20.40.60.811.21.4Message Index2004006008001000Probability10-301234Message Index2004006008001000Probability10-300.20.40.60.811.21.4Message Index2004006008001000Probability10-300.511.522.5Message Index2004006008001000Probability10-300.20.40.60.811.21.4385(a) Prototype

(b) Device deployment

Figure 13: Prototype and deployment of devices

Figure 15: Message distribution when n = 120.

n

240
120

e

Cmax
0.5051
0.5051

m

Cmin
0.8777
0.8777

∆

0.1667
0.1667

E

9.9929
9.9928

BERe
0.4996
0.4993

BERm BLERm
1.2E-4
2.8E-5
7.8E-5
5.1E-4

Table 4: Performance for the worst channel case.

n

120

∆
0.3
0

E

9.9925
9.9923

BERe
04954
0.4931

n

60

∆
0.3
0

E

9.9926
9.9933

BERe
0.4975
0.4867

(a) ∆ = 0.23

(b) no tradeoﬀ

Table 5: Performance for the feedback scheme.

Figure 14: Message distribution with and without
using ∆ when n = 240.

n

240

120

e

Cmax
0.3562
0.5862
0.3562
0.5862

∆

0.23

0

0.23

0

BERe
0.4998
0.4984
0.4986
0.4938

E

9.9928
9.9926
9.9926
9.9932

Table 3: Performance for the worst channel case.

6. SYSTEM IMPLEMENTATION AND EX-

PERIMENTAL RESULTS

In this section, we ﬁnally implement the wiretap chan-
nel and use real-world experiments to evaluate the system
performance. As shown in Fig. 13 (a), we build a commu-
nication prototype consisting of three USRP N210 devices
with WBX daughter boards operating in the 850MHz as Al-
ice, Bob and Eve, respectively. Alice and Bob are deployed
and tested in the green area, Eve is deployed and tested in
the red area. Note that, in the blue area, the eavesdropper’s
channel may be too good that it is not suitable for gener-
ating enough capacity diﬀerence to implement the wiretap
channel (in the worst channel case).

In our experiment, we evaluate the performance of the
worst channel case and the case where instantaneous channel
capacity feedback is available to deal with the variation of
channel states. Similar to the simulation study, we limit
the message to be 10bits, and transmit 100000 codewords.
Finally, we calculate the equivocation and the bit error rate
at the eavesdropper, and the bit error rate and the block
error rate at the receiver.
6.1 Performance Evaluation of the Worst Cha

-nnel Case

For the worst channel case, the maximum capacity of the
eavesdropper’s channel is obtained by experiments over a
long period of time, but the real-time capacity of the eaves-
dropper’s channel is not available. Through experiments, we
ﬁnd that the main channel is almost error-free if the receiver
is close to the sender, say they are within one room.

We ﬁrst evaluate the system performance when the main
channel is noiseless and Type-I wiretap code is adopted for
message encoding. In the experiments, it is required that

e

Eve is within “restricted zones” such that the eavesdrop-
per’s channel capacity is always below the speciﬁc Cmax
.
Fig. 14 shows the distribution of the received messages for
the worst channel case with and without transmission rate
tradeoﬀ ∆ when n = 240, respectively. Table 3 shows E and
BERe for n = 120 and 240. The results indicate that the
system performance is almost the same for the worst channel
cases with and without introducing ∆. This is because the
worst channel case inherently has overestimated the capac-
ity of the eavesdropper’s channel, and additional tradeoﬀs
may not be needed to guarantee nearly perfect secrecy. Due
to this reason, the system can achieve nearly perfect secure
communications for the worst channel case without using
our proposed tradeoﬀ approach.

We then evaluate the system performance when the main
channel is noisy and Type-II wiretap code is adopted for
message encoding. In the experiments, it is required that
the receiver is located in the area with Cm always larger
than the speciﬁc Cmin
m while the eavesdropper is located
in the “restricted zones” with Ce always smaller than the
speciﬁc Cmax
. Fig. 15 shows the distribution of the received
messages, and the bit error rate and the block error rate
are shown in Table 4. It can be seen that the system also
achieves nearly perfect secrecy and high reliability.

e

In summary, the advantage of communicating message un-
der the worst case channel is that we do not need to know
the real-time channel state information for obtaining secrecy
and reliability, but it faces a limitation that the eavesdrop-
per should be restricted to be certain areas.
6.2 Performance Evaluation of the Dynamic

Feedback Case

In this application scenario, we deploy additional USRP
N210 nodes on the ﬂoor to help estimate and transmit the
instantaneous capacities of the main channel and the eaves-
dropper’s channel. As shown in Fig. 4, the capacity only
changes slightly between two frames. Thus, in our imple-
mentation a training sequence is transmitted to help esti-
mate the channel capacities, based on which we can dynam-
ically adjust the coding design.

We ﬁrst evaluate the system performance when then main
channel is noiseless and Type-I wiretap code is adopted for
message encoding.
In order to guarantee secrecy, we set

Message Index2004006008001000Probability10-300.20.40.60.811.21.4Message Index2004006008001000Probability10-300.20.40.60.811.21.4386(a) ∆ = 0.3

(b) no tradeoﬀ

Figure 16: Message distribution with and without
using ∆ when n = 120.

Figure 17: Message distribution when n = 120.

n

120
60

∆

0.3333
0.3333

E

9.9931
9.9924

BERe
0.4993
0.4991

BERm
0.000035
0.000109

BLERm
0.00013
0.00047

Table 6: Performance for the feedback scheme.

the transmission rate tradeoﬀ ∆ = 0.3. Fig. 16 shows the
distribution of the received messages at the eavesdropper,
and Table 5 reports the corresponding bit error rate and
block error rate. Similar conclusions can be drawn as those
of the worst channel case.

We then evaluate the system performance when the main
channel is noisy and Type-II wiretap code is adopted for
message encoding. Fig. 17 shows the distribution of the re-
ceived messages, and Table 6 reports the results under our
pre-deﬁned evaluation metrics. Not surprisingly, nearly per-
fect secrecy can also be guaranteed. With dynamic capacity
feedbacks, the eavesdropper does not have to be constrained
in “restricted zones”, but additional nodes need to be de-
ployed to help to estimate the channel capacities.

7. CONCLUSIONS

This paper investigated the design and implementation
of a secret message communication system under the classic
wireless wiretap channel model. This is the ﬁrst work to pro-
vide practical solutions with a comprehensive performance
evaluation to our best knowledge. We tackled many chal-
lenges in the protocol design and implementation, and be-
lieve that the results and ﬁndings in this work can be viewed
as the ﬁrst step towards bridging the gap between the the-
oretical wiretap channel and its practice. Our immediate
future work is to jointly consider the power allocation in
optimizing the system performance in terms of secrecy rate
and also explore the practicality of other advanced wiretap
coding technqiues in the system implementation.

8. ACKNOWLEDGMENTS

We thank Ness Shroﬀ for the inspiring discussions on
the subject and the anonymous reviewers for their valu-
able feedbacks. Qian’s research is supported in part by Na-
tional Natural Science Foundation of China under Grant

No. 61373167, National Basic Research Program of China
(973 Program) under Grant No. 2014CB340600, and Na-
tional High Technology Research and Development Program
of China under Grant No. 2015AA016004. Kui’s research is
supported in part by US National Science Foundation un-
der grants CNS-1421903, CNS-1318948 and CNS-1262275.
Zhibo is the corresponding author, and his research is sup-
ported in part by National Natural Science Foundation of
China under Grant No.
61502352, and Natural Science
Foundation of Hubei Province under Grant No. 2015CFB203.

9. REFERENCES
[1] Bergmans, P. Random coding theorem for broadcast channels

with degraded components. IEEE Transactions on
Information Theory 19, 2 (1973), 197–207.

[2] Bloch, M., and Barros, J. Physical-layer security: from

information theory to security engineering. Cambridge
University Press, 2011.

[3] Chou, T.-H., Draper, S. C., and Sayeed, A. M. Key generation

using external source excitation: Capacity, reliability, and
secrecy exponent. IEEE Transactions on Information Theory
58, 4 (2012), 2455–2474.

[4] Cover, T. M. Comments on broadcast channels. IEEE

Transactions on information theory 44, 6 (1998), 2524–2530.

[5] Gallager, R. G. Low-density parity-check codes. IEEE

Transactions on Information Theory 8, 1 (1962), 21–28.

[6] Gungor, O., Tan, J., Koksal, C. E., El-Gamal, H., and Shroff,

N. B. Secrecy outage capacity of fading channels. IEEE
Transactions on Information Theory 59, 9 (2013), 5379–5397.

[7] Kanukurthi, B., and Reyzin, L. Key agreement from close

secrets over unsecured channels. In Proc. of EUROCRYPT’09
(2009), pp. 206–223.

[8] Khalil, K., Koyluoglu, O. O., Gamal, H. E., and Youssef, M.

Opportunistic secrecy with a strict delay constraint. IEEE
Transactions on Communications 61, 11 (2013), 4700–4709.

[9] Leung-Yan-Cheong, S., and Hellman, M. E. The gaussian

wire-tap channel. IEEE Transactions on Information Theory
24, 4 (1978), 451–456.

[10] Ling, C., Luzzi, L., Belfiore, J., and Stehl´e, D. Semantically

secure lattice codes for the gaussian wiretap channel. IEEE
Transactions on Information Theory 60, 10 (2012), 6399–6416.
[11] Mahdavifar, H., and Vardy, A. Achieving the secrecy capacity
of wiretap channels using polar codes. IEEE Transactions on
Information Theory 57, 10 (2011), 6428–6443.

[12] Mao, Z., Koksal, C. E., and Shroff, N. B. Achieving full

secrecy rate with low packet delays: An optimal control
approach. IEEE Journal on Selected Areas in
Communications 31, 9 (2013), 1944–1956.

[13] Mathur, S., Trappe, W., Mandayam, N., Ye, C., and Reznik, A.

Radio-telepathy: extracting a secret key from an
unauthenticated wireless channel. In Proc. of MobiCom’08
(2008), ACM, pp. 128–139.

[14] Meister, B., and Oettli, W. On the capacity of a discrete,

constant channel. Information and Control 11, 3 (1967),
341–351.

[15] Pan, B., Kemao, Q., Huang, L., and Asundi, A. Phase error
analysis and compensation for nonsinusoidal waveforms in
phase-shifting digital fringe projection proﬁlometry. Optics
Letters 34, 4 (2009), 416–418.

[16] Patwari, N., Croft, J., Jana, S., and Kasera, S. K. High-rate

uncorrelated bit extraction for shared secret key generation
from channel measurements. IEEE Transactions on Mobile
Computing 9, 1 (2010), 17–30.

[17] Seidel, S. Y., and Rappaport, T. S. 914 mhz path loss

prediction models for indoor wireless communications in
multiﬂoored buildings. IEEE Transactions on Antennas and
Propagation 40, 2 (1992), 207–217.

[18] Sharon, E., Litsyn, S., and Goldberger, J. An eﬃcient

message-passing schedule for ldpc decoding. In Proc. of IEEE
Convention of Electrical and Electronics Engineers (2004),
IEEE, pp. 223–226.

[19] Thangaraj, A., Dihidar, S., Calderbank, A. R., McLaughlin,

S. W., and Merolla, J.-M. Applications of ldpc codes to the
wiretap channel. IEEE Transactions on Information Theory
53, 8 (2007), 2933–2945.

[20] Wyner, A. D. The wire-tap channel. The Bell System

Technical Journal 54, 8 (1975), 1355–1387.

Message Index2004006008001000Probability10-300.20.40.60.811.21.4Message Index2004006008001000Probability10-300.20.40.60.811.21.4Message Index2004006008001000Probability10-300.20.40.60.811.21.4387