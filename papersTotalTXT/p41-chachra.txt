Afﬁliate Crookies: Characterizing Afﬁliate Marketing Abuse

Neha Chachra

nchachra@cs.ucsd.edu

Stefan Savage

savage@cs.ucsd.edu

Geoffrey M. Voelker
voelker@cs.ucsd.edu

Department of Computer Science and Engineering

University of California, San Diego

ABSTRACT

Modern afﬁliate marketing networks provide an infrastructure for
connecting merchants seeking customers with independent mar-
keters (afﬁliates) seeking compensation. This approach depends
on Web cookies to identify, at checkout time, which afﬁliate should
receive a commission. Thus, scammers “stuff” their own cookies
into a user’s browser to divert this revenue. This paper provides
a measurement-based characterization of cookie-stufﬁng fraud in
online afﬁliate marketing. We use a custom-built Chrome exten-
sion, AffTracker, to identify afﬁliate cookies and use it to gather
data from hundreds of thousands of crawled domains which we ex-
pect to be targeted by fraudulent afﬁliates. Overall, despite some
notable historical precedents, we found cookie-stufﬁng fraud to
be relatively scarce in our data set. Based on what fraud we de-
tected, though, we identify which categories of merchants are most
targeted and which third-party afﬁliate networks are most impli-
cated in stufﬁng scams. We ﬁnd that large afﬁliate networks are
targeted signiﬁcantly more than merchant-run afﬁliate programs.
However, scammers use a wider range of evasive techniques to tar-
get merchant-run afﬁliate programs to mitigate the risk of detection
suggesting that in-house afﬁliate programs enjoy stricter policing.

Categories and Subject Descriptors

K.4 [Computers and Society]: Electronic Commerce—Security

Keywords

Measurement; Online Advertising; Afﬁliate Marketing; Security

1.

INTRODUCTION

Afﬁliate marketing is a popular form of pay-per-action or pay-
per-sale advertising whereby independent marketers are paid a com-
mission on “converting trafﬁc” (e.g., clicks that culminate in a sale).
Heralded as the “the holy grail” of online advertising a decade
ago [17], afﬁliate marketing has become prevalent across the Web,
complementing more traditional forms of display advertising.

Often described as a “low-risk” proposition for merchants who
pay out only upon successful completion of sales, afﬁliate market-

ing attracts signiﬁcant investment from almost every major online
retailer, some of whom also invest in multiple third-party afﬁliate
advertising programs. Similarly, it is an attractive proposition for
independent marketers as they can create online content (e.g., book
reviews) that can be monetized simultaneously as a means to at-
tract likely converting trafﬁc and to host contextual advertising. Of
the two approaches, afﬁliate marketing is frequently the more prof-
itable option with earnings typically between 4 and 10% of sales
revenue [2, 18].

Like almost all economic activity on the Web, afﬁliate market-
ing also attracts the attention of fraudsters looking to make easy
cash. Afﬁliate fraud garnered widespread media attention in 2013
with the indictment of Shawn Hogan, an EBay afﬁliate indicted for
wire fraud of $28M through the use of a technique called cookie-
stufﬁng [8] whereby the Web cookies used to determine the likely
source of user trafﬁc are overwritten without the user’s knowledge.
There have been multiple similar legal disputes over afﬁliate mar-
keting since then [6]. Besides media attention, afﬁliate marketing
has also been a subject of academic research to understand the in-
centives in the ecosystem and the extent of afﬁliate fraud [7, 16].
In this paper, we characterize popular cookie-stufﬁng techniques.
From crawling likely sources of cookie-stufﬁng, we ﬁnd that large
afﬁliate networks such as CJ Afﬁliate (formerly Commission Junc-
tion) and Rakuten LinkShare (recently renamed to Rakuten Afﬁli-
ate Network) are implicated in cookie-stufﬁng orders of magnitude
more than afﬁliate programs run by merchants themselves, such
as the Amazon Associates Program. Lower attempted fraud cou-
pled with the much higher use of evasive cookie-stufﬁng techniques
against in-house afﬁliate programs suggests that such programs en-
joy stricter policing, thereby making them difﬁcult targets of fraud.
We also ﬁnd that retailers in the Apparel, Department Stores, and
Travel and Hotels sectors of e-commerce are disproportionately tar-
geted by afﬁliate fraud, usually through domains typosquatted on
the merchant’s trademarks. Finally, we evaluate data from a two-
month in situ user study with 70+ users and ﬁnd that afﬁliate mar-
keting is dominated by a small number of afﬁliates while cookie-
stufﬁng fraud is rarely encountered. Overall, our targeted crawl and
user study both suggest that the problem, while real, appears to be
less prevalent than suggested by previous reports.

Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage and that copies bear this notice and the full cita-
tion on the ﬁrst page. Copyrights for components of this work owned by others than
ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or re-
publish, to post on servers or to redistribute to lists, requires prior speciﬁc permission
and/or a fee. Request permissions from Permissions@acm.org.
IMC’15, October 28–30, 2015, Tokyo, Japan.
© 2015 ACM. ISBN 978-1-4503-3848-6/15/10 ...$15.00.
DOI: http://dx.doi.org/10.1145/2815675.2815720.

2. BACKGROUND

Online merchants beneﬁt from afﬁliate marketing through cus-
tomized and targeted advertising for their products. For example,
when an afﬁliate reviews a bicycle on a blog dedicated to biking,
the bicycle merchant can receive sales from the readers of the blog
without the merchant having to produce an advertising creative or
directly advertise to the blog subscribers.
Instead, the merchant
pays a commission to the afﬁliate for each such sale made.

41Signs up 

Receives aﬃliate links 



Pays aﬃliate 

AFFILIATE 

<a>Affiliate link</a>

i a t e   U R L  
i d e n < f y i n g   a ﬃ l

 

f e t c h e s   a ﬃ l
 B r o w s e r
    R e t u r n s   c o o k i e  

AFFILIATE 

NETWORK 

i a t e  

AFFILIATE 

  s e n d s   c o o k i e   w i
r a c k i n g   p i x e l

 

B r o w s e r

f o r

t

 

Clicks on aﬃliate link 



 Visits merchant site 
containing tracking pixel 

 

Purchases goods 

r e q u e s t

 

t h  

AFFILIATE 

NETWORK 

Pays aﬃliate 

network 

USER 

MERCHANT 

USER 

MERCHANT 

Figure 1: Different actors and revenue ﬂow in the afﬁliate marketing ecosystem. The left half of the ﬁgure depicts a potential customer
receiving an afﬁliate cookie, while the right half shows the use of the afﬁliate cookie to determine payout upon a successful transaction.

To recruit afﬁliates for advertising goods and services, an online
merchant can either run its own afﬁliate program or join one run by
a larger afﬁliate network. While some merchants like Amazon and
HostGator run their own afﬁliate programs, most online retailers
(particularly those whose expertise is on the brick-and-mortar side
of the business) market through large afﬁliate networks such as CJ
Afﬁliate and Rakuten LinkShare. Figure 1 provides an overview
of the afﬁliate marketing ecosystem where a merchant is part of a
large afﬁliate network that acts as a link between afﬁliates, who are
typically content publishers, and merchants.

Afﬁliates who sign up for an afﬁliate network can choose to mar-
ket for one or more merchants who are members of the network.
Afﬁliate networks generally assign unique identiﬁers to all afﬁliates
(afﬁliate IDs) and merchants (merchant IDs). Upon signup, afﬁli-
ates receive special links from the afﬁliate network that encode the
identiﬁers for the afﬁliate and the merchant for whom the afﬁliate
is advertising. An afﬁliate includes these afﬁliate links in published
content (e.g., a product review site) such that, when a potential
buyer visits an afﬁliate’s Web site and clicks on the link, it redi-
rects the visitor to the merchant site via the afﬁliate program. The
afﬁliate link GET request to the afﬁliate program returns an HTTP
cookie (i.e., an afﬁliate cookie) that associates the user’s visit with
the corresponding afﬁliate. These cookies uniquely identify the re-
ferring afﬁliate for up to a month after the initial visit. If the user
visits the merchant site during this period and completes a transac-
tion, the afﬁliate network can identify the referral using the afﬁliate
program’s tracking pixel on the merchant’s site. The referring af-
ﬁliate usually earns between 4 and 10% on a completed transaction
as a commission from the afﬁliate network who, in turn, is paid by
the merchant for sourcing the sale.1 In-house programs work simi-
larly, with the network replaced by infrastructure maintained by the
merchant itself.

Afﬁliate cookies remain in a user’s browser until they expire,
are overwritten by a different afﬁliate’s cookie, or the user deletes
them manually.
If a user clicks on links for the same merchant
from multiple afﬁliates in the same afﬁliate program, the cookie
is overwritten and only the last afﬁliate to refer the user earns a
commission.

These behaviors — that the presence of a cookie determines pay-

1This is a general description. The details of the commission, the
allowed duration for conversion and the implementation details (in-
cluding the afﬁliate URL and cookie structures) can vary consider-
ably among afﬁliate programs.

out and that the most recent cookie “wins” — are at the core of the
cookie-stufﬁng technique that allows fraudulent afﬁliates to obtain
illicit commissions. In Figure 1, instead of using the afﬁliate URL
as a clickable link, a fraudulent afﬁliate may cause the browser to
directly fetch her afﬁliate URL on a page controlled by her without
any explicit clicks from the user, thereby tricking the afﬁliate pro-
gram into returning a cookie that then identiﬁes the fraudulent afﬁl-
iate as the referrer for the user’s transactions. As a result, not only
does an afﬁliate program pay a non-advertising afﬁliate, but the
fraudulent cookie overwrites any existing afﬁliate cookie that may
have already been present, thereby potentially stealing the commis-
sion from a legitimate afﬁliate. Furthermore, cookie-stufﬁng fraud
is typically completely opaque to an end user and goes against the
advertising guidelines issued by the Federal Trade Commission for
marketers, which require declaration of any ﬁnancial relationship
with advertisers [9]. As a result, most afﬁliate programs explicitly
forbid cookie-stufﬁng. For instance, the HostGator afﬁliate pro-
gram states that “sales made through cookie stufﬁng methods will
be considered invalid” [10].

In prior work, Moore et al. found several typosquatted domains
that belong to fraudulent afﬁliate marketers [13]. Kapravelos et
al. also found popular browser extensions that were cookie-stufﬁng
major afﬁliate networks like the Amazon Associates Program [11].
Snyder et al. studied the extent to which users encountered afﬁli-
ate fraud from the HTTP request logs for a public university [16].
In another study, Edelman et al. explored the incentives of different
players in the afﬁliate marketing ecosystem, and also used crawling
to identify afﬁliate programs defrauded through adware, typosquat-
ting, and search engine optimization (SEO) [7]. Our work furthers
this line of work by characterizing cookie-stufﬁng techniques and
the range of targeted networks and retailers. In addition, we per-
form a user study to characterize the prevalence of afﬁliate market-
ing and cookie-stufﬁng fraud.

3. METHODOLOGY

In this section we describe how we measure cookie-stufﬁng fraud
against six large afﬁliate programs: CJ Afﬁliate, Rakuten LinkShare,
ShareASale, ClickBank, Amazon Associates Program, and Host-
Gator Afﬁliate Program. While Amazon and HostGator run their
own afﬁliate programs, the remaining four are consistently top-
rated afﬁliate networks [15], which include well known merchants
such as Nordstrom, Lego Brand, GoDaddy, etc. First, we study the
structures of afﬁliate URLs and cookies used by these programs

42so that we can identify the afﬁliate network, the targeted merchant,
and the afﬁliate’s ID. We then use a custom-built browser extension
to identify afﬁliate cookies received while browsing, and use it for
the large scale crawling and the user study.

3.1 Identifying Afﬁliate URLs and Cookies

Broadly, we identiﬁed afﬁliate URLs and cookies either by sign-
ing up for these programs ourselves, or by ﬁnding this information
online. Table 1 shows how we parse out afﬁliate and merchant IDs
from some example afﬁliate URLs and cookies. For CJ Afﬁliate,
we only show how we identify the publisher ID because we are
unable to identify the corresponding afﬁliate ID. Every CJ afﬁliate
can have multiple publisher IDs, one for each site used for pub-
lishing afﬁliate marketing creatives. However, every publisher ID
is uniquely associated with a single afﬁliate. As a result, we use
the terms publisher ID and afﬁliate ID interchangeably when dis-
cussing CJ Afﬁliate in the following sections.

Finally, the merchant is easy to identify because an afﬁliate URL

eventually redirects to the merchant domain.

3.2 User Study

In our user study, we examine how often users click on afﬁl-
iate links while browsing the Web, and identify afﬁliate cookies
using a custom-built browser extension for Google Chrome called
AffTracker.2

AffTracker gathers information about every single afﬁliate cookie
it observes in the Set-Cookie HTTP response headers while a
user is browsing. Upon detection of an afﬁliate cookie, AffTracker
parses out the afﬁliate and merchant identiﬁers and the rendering
information, including size and visibility, for the DOM element that
initiated the afﬁliate URL request. AffTracker also records the redi-
rect chain for the requests that result in afﬁliate cookies. Besides
notifying the user about the cookie, AffTracker also submits this
information to our server which stores it in a Postgres database.

By advertising to friends and colleagues, we obtained browsing
data from 74 installations between March 1, 2015 – May 2, 2015.
Using a locally generated unique ID, we can attribute afﬁliate cook-
ies to speciﬁc users without collecting any personally identiﬁable
information (PII).

While we can identify ﬁnal attributes of DOM elements that
cause a browser to fetch the afﬁliate links, we cannot automatically
determine how such DOM elements are generated. Upon manual
inspection we came across several afﬁliates who use JavaScript or
Flash to dynamically generate hidden images and iframes that then
request afﬁliate URLs. However, we are unable to quantify this
phenomenon. Also, our user study does not have a completely ran-
dom sample of users, and is likely biased towards savvy computer
users. We discuss the results of our user study in Section 4.3.

3.3 Crawling

To characterize cookie-stufﬁng at scale, we visited over 475K
domains to search for stuffed cookies. As described in Section 2,
a user should only receive an afﬁliate cookie upon clicking on an
afﬁliate URL. While crawling we do not click on any links and
therefore every afﬁliate cookie we receive is deemed fraudulent.
Since it is infeasible to crawl every Web page, we narrowed our
visits to four different sets of URLs where we expected to come
across afﬁliate fraud.

For every crawl we used a slightly modiﬁed version of our pub-
licly available extension, AffTracker, which automatically grabs
a new URL from a queue on Redis, a persistent key-value store.
Upon completion of a visit, the extension submits results to our

server and purges the crawler browser of all history, cookies, and
local storage. We purge the browser because we found afﬁliates
who save state in browsers to rate-limit their cookie-stufﬁng to
evade detection by afﬁliate programs. For example, an afﬁliate,
jon007, who controls bestwordpressthemes.com, sets a cus-
tom cookie called bwt which is valid for a month. As long as this
cookie remains valid in a browser, bestwordpressthemes.c
om does not request HostGator afﬁliate cookies for the user. Also,
inspired by Shawn Hogan who, according to EBay, rate-limited
his cookie-stufﬁng by only requesting an afﬁliate cookie once per
IP [4], we use 300 proxies to mitigate IP based detection by fraud-
ulent afﬁliates.

We crawled the following four sets of domains to gather afﬁliate
cookies. Except Alexa top domains set, the remaining three sets are
purposely biased towards domains where we expect to ﬁnd higher
concentration of cookie-stufﬁng.

Alexa Top Domains. We crawled the Alexa [1] top 100K do-
mains as of April 16, 2015 to ﬁnd popular domains stufﬁng cookies.

Reverse Cookie Lookups. After identifying the cookie names
used by different afﬁliate programs, we performed reverse lookups
on the cookie-search interface [5] on digitalpoint.com, a web-
master community that indexes all of the cookies its crawler en-
counters. Overall, we gathered 9.5K domains that the Digital Point
crawler observed performing cookie-stufﬁng over the last 2 years.

Reverse Afﬁliate ID Lookup. Using the cookie-stufﬁng afﬁli-
ate IDs discovered from our Digital Point domain crawl, we queried
an aggregator site, sameid.net, that indexes domains by Amazon
and ClickBank afﬁliate IDs seen on a domain. By iteratively crawl-
ing domains queried from the newly discovered cookie-stufﬁng af-
ﬁliate IDs, we visited a total of 74.5K domains.

Typosquatted Domains. In our ﬁrst three sets we observed
that much of the cookie-stufﬁng fraud was on domains typosquat-
ted on merchant domains names. Thus, we crawled all typosquatted
.com domains for over 7K domains belonging to major e-retailers.
Similar to Edelman et al. [7], we interpret the use of typosquat-
ting to redirect users to merchant sites without any explicit clicks
as cookie-stufﬁng, and therefore, fraudulent. Typically users vis-
iting typosquatted domains intend to visit the merchant site rather
than the typosquatted domain itself. Thus, typosquatting a domain
does not bring new customers to merchant sites via direct afﬁliate
marketing of products. Therefore, we recognize cookie-stufﬁng via
typosquatted domains as fraudulent.

We acquired the set of domains belonging to e-retailers from a
public API offered by Rakuten Popshops.3 The downloaded data
includes merchant lists for Commission Junction, ShareASale, and
Rakuten LinkShare afﬁliate networks. By calculating the Leven-
shtein distance [12] for merchant domains against all .com do-
mains in a zone ﬁle from April 19, 2015, we found over 300K ty-
posquatted domains with an edit distance of one. We visited this
set of domains as well.

We gather the same features about afﬁliate cookies through crawl-
ing as from the user study because we use the same browser ex-
tension, AffTracker, in both cases. Furthermore, we only visit
top-level pages of domains and therefore miss any cookie-stufﬁng
in domain sub-pages. Also, Google Chrome disables popups by
default, a feature we left unchanged because it emulates a user’s
browser more faithfully. However, this behavior likely caused our

2afﬁliatetracker.ucsd.edu

3https://www.popshops.com

43Afﬁliate Program

URL

Cookie

Amazon Associates Program http://www.amazon.com/dp/tag=<aff>&...
CJ Afﬁliate
ClickBank
HostGator
Rakuten LinkShare
ShareASale

http://www.anrdoezrs.net/click-<pub>- ...
http://<aff>.<merchant>.hop.clickbank.net/
http://secure.hostgator.com/~affiliat/...
http://click.linksynergy.com/fs-bin/click?...
http://www.shareasale.com/r.cfm?...

UserPref=.*
LCLK=.*
q=.*
GatorAffiliate=.*.<aff>
lsclick_mid<merchant>=".*|<aff>- .*"
MERCHANT<merchant>=<aff>

Table 1: Examples of afﬁliate URLs and cookies for different afﬁliate programs.

crawler to miss any afﬁliate fraud where a fraudster opens a popup
to load an afﬁliate URL.

Finally, while we can detect fraudulent afﬁliates stufﬁng cookies,
we are unable to discern whether an afﬁliate network has already
identiﬁed the fraudster. We have seen examples of ClickBank and
LinkShare afﬁliate sites where afﬁliate links show an error mes-
sage about afﬁliates having been banned, but some networks do not
break banned afﬁliate links to prevent bad end-user experience for
their URLs.

4. RESULTS

In this section we ﬁrst analyze the afﬁliate networks and mer-
chants most impacted by cookie-stufﬁng fraud. Next, we survey
various cookie-stufﬁng techniques used by afﬁliates, and then present
the results from our user study on the prevalence of afﬁliate mar-
keting and cookie-stufﬁng fraud.

4.1 Networks Affected by Cookie-Stufﬁng

Using data collected from our crawls, we identify the afﬁliate
networks most targeted by cookie-stufﬁng. Overall, we received
12,033 afﬁliate cookies from 11.7K domains. Table 2 summarizes
our results.

We found that CJ Afﬁliate and Rakuten LinkShare are the most
targeted programs, comprising 85% of all fraudulent cookies we
observed. We identiﬁed afﬁliate IDs for all but 1.6% of these cook-
ies. Every fraudulent CJ afﬁliate stuffed almost 50 cookies, while
every LinkShare afﬁliate stuffed 41 cookies. However, fraudulent
afﬁliates in Amazon and HostGator afﬁliate programs only stuffed
2.5 cookies per afﬁliate on average, the fewest of all afﬁliate pro-
grams in our study, suggesting that fraudulent afﬁliates target net-
works much more than they target in-house afﬁliate programs.

Generally, afﬁliate networks present greater cookie-stufﬁng op-
portunity to fraudulent afﬁliates because a single afﬁliate can si-
multaneously defraud multiple merchant members of the network.
Our data from the Popshops API (Section 3.3) contains almost
2.4K merchants in CJ Afﬁliate, and 1.3K merchants in Rakuten
LinkShare, and as Table 2 shows, each fraudulent afﬁliate targeted
more than three merchants in LinkShare on average. We received
10 and 15 cookies on average for every targeted merchant in CJ
Afﬁliate and Rakuten LinkShare, respectively.

Using the Popshops data as ground truth, we classiﬁed the de-
frauded merchants in all of the major networks (Figure 2) in our
study except ClickBank and 420 CJ Afﬁliate cookies. We found
that on the whole, Apparel and Accessories e-retailers are targeted
the most across all three afﬁliate networks while the second most
impacted group of merchants are Department Stores, again abused
in all three networks but to a greater extent in LinkShare. Travel
and Hotel sites were the third-most defrauded group. These three
sectors have a large number of merchants and we found almost 11
stuffed cookies on average for every targeted merchant. On the
other hand, the Tools and Hardware category only contains four
impacted merchants but we observed almost 45 cookies for each of

CJ Affiliate

ShareASale

Rakuten LinkShare

1000

i

s
e
k
o
o
C

750

500

250

0

A pparel & A ccessories
D epartm ent Stores

Travel & H otels

H o m e & G arden
S hoes & A ccessories
H ealth &  W ellness
Electronics & A ccessories
C o m puters & A ccessories

S oftw are

M usic & M usical Instru m ents

Figure 2: Stuffed cookie distribution for top 10 categories of im-
pacted merchants.

them on average, the highest of any category. Home Depot, a CJ
Afﬁliate member, was the most impacted merchant in this category
with 163 stuffed cookies.

We also found 107 merchants who were defrauded across two
or more networks. Chemistry.com, a member of CJ Afﬁliate and
LinkShare, was the most targeted merchant participating in more
than one afﬁliate program.

4.2 Prevalence of Cookie-Stufﬁng Techniques
We use the collected data to characterize the use of various cookie-

stufﬁng techniques against each of the afﬁliate programs under con-
sideration. As described in Section 3, whenever the browser re-
quests an afﬁliate URL, our extension ﬁnds the DOM element that
caused the fetch. Visiting a fraudulent afﬁliate’s Web page can
cause the user’s browser to fetch an afﬁliate URL without any ex-
plicit click from the user by setting it as the src attribute of im-
ages, iframes, or script tags. All of these DOM elements can re-
quest third-party content on a Web page. Our extension is able to
detect all afﬁliate cookies by observing the Set-Cookie HTTP
headers, and distinguish between these techniques automatically.

44Afﬁliate Program

Cookies

Domains

Merchants

Afﬁliates

Techniques

Avg. Redirects

Amazon Associates Program
CJ Afﬁliate
ClickBank
HostGator
Rakuten LinkShare
ShareASale

170 (1.41%)
7344 (61.0%)
1146 (9.52%)
71 (0.59%)
2895 (24.1%)
407 (3.38%)

122
7253
1001
63
2861
404

1
725
606
1
188
66

Images

Iframes

Redirecting

70
146
403
29
57
34

28.8%
0.29%
34.4%
43.7%
0.28%
0.25%

34.1%
2.46%
13.5%
19.7%
0.41%
0.0%

37.0%
97.2%
52.0%
35.2%
99.3%
99.8%

1.64
0.94
0.68
0.87
1.01
0.74

Table 2: Afﬁliate Programs affected by cookie-stufﬁng.

Table 2 shows the percentage of cookies corresponding to each of
these techniques for every afﬁliate program.

At a high level, we observe that fraudulent afﬁliates use a much
larger variety of techniques uniformly for afﬁliate programs run by
the merchants themselves compared with larger afﬁliate networks,
which are targeted primary via redirects to merchant sites without
user clicks. Table 2 also shows the average number of interme-
diate domains requested after the initial page visit but before the
afﬁliate URL, i.e., a value of zero means that an afﬁliate URL was
directly requested from the crawled page.
Intermediate referrers
can be used to obfuscate the original source of a fraudulent afﬁl-
iate URL request because an afﬁliate program only sees the ﬁnal
referrer when determining the legitimacy of such a request. Af-
ﬁliates defrauding Amazon Associates Program use more interme-
diate domains on average. Since the cost of getting intermediate
domains is higher, it is likely more expensive for fraudulent afﬁl-
iates to defraud Amazon Associates Program presumably due to
stricter policing by Amazon.

Redirecting. Fraudulent afﬁliates redirect users to afﬁliate URLs
without any clicks by either using 301 or 302 HTTP response sta-
tus codes, or using Flash or JavaScript to redirect the browser to the
afﬁliate URL. In each of these cases, the original page we crawled
only resulted in one stuffed cookie per visit. Such redirects de-
livered over 91% of all stuffed cookies, most of which resulted
from typosquatted domains. In fact, we received 84% of all afﬁliate
cookies from 10.1K typosquatted domains.

Of the 10.1K cookies from typosquatted domains, 93% (9.4K

cookies) are from domains typosquatting on merchant domain names
while 1.8% resulted from typosquatting on subdomains. For exam-
ple, liinensource.com redirects to Rakuten LinkShare mer-
chant linensource.blair.com. We manually inspected 30
of the remaining 520 typosquatted domains that resulted in afﬁl-
iate cookies and found that these domains can be broadly classi-
ﬁed into three types. One-third of these domains are contextually
related to the ﬁnal landing page. For example, 0rganize.com
redirects to CJ merchant shopgetorganized.com, and bhea
lthypets.com and healthypts.com redirect to CJ merchant
entirelypets.com. Another third appear to be expired CJ of-
fers, and thus did not redirect to any merchant site. The remaining
one-third cookies result from typosquatted domains selling trafﬁc
to trafﬁc distributors like pureleads.com, 7search.com, and
blendernetworks.com that eventually redirect through an af-
ﬁliate URL. We revisit trafﬁc distributors in our discussion on re-
ferrer obfuscation in this section.

Iframes. Iframes are often used to render third-party content on a
Web page, which is otherwise forbidden by the Same-Origin policy
implemented by browsers. Most major afﬁliate programs disallow
the use of iframes, as it is a commonly used mechanism to facil-
itate cookie-stufﬁng. For example, HostGator explicitly prohibits

iframes: “iframes may not be used unless given express permis-
sion by HostGator, sales made through hidden iframes or Cookie-
stufﬁng methods will be considered invalid” [10]. Similarly, Ama-
zon Associates Program prohibits framing any Amazon link on a
page [3].

We received 420 cookies from content rendered in iframes on
third-party sites. Generally, a server can prevent a Web site from
framing its content on a page by using the X-Frame-Options
HTTP header with its value set to SAMEORIGIN to only allow ren-
dering content on a page with the same origin as the frame, or DENY
to completely disallow framing content on any Web site [14]. We
determined that Google Chrome and Firefox browsers honor the
X-Frame-Options header and do not render the iframe con-
tent, but both browsers save the cookies nonetheless. Thus, iframe
based stufﬁng is effective despite the use of X-Frame-Options
header.

We found that 17% of the cookies received from iframes set
X-Frame-Options to either SAMEORIGIN or DENY, includ-
ing every Amazon Associates Program cookie. Table 2 shows that
iframes still accounted for over a third of the stuffed Amazon cook-
ies. Unlike Amazon, only 2% of CJ cookies and 50% of LinkShare
cookies were accompanied by a restrictive X-Frame-Options
header.

We also used the style and size information gathered in our crawl
to determine how, if at all, a user would have seen the correspond-
ing iframe on the crawled page. We gathered this information
for 46% of the iframes. Of the 191 iframes, 64% explicitly set
the height or width to either 0 or 1px; 49 (25%) iframes have
visibility:hidden or display:none set, thereby mak-
ing the iframe invisible to an end user. Additionally, seven iframes
use CSS classes to hide the iframe DOM element. Of these, three
have the same afﬁliate ID kunkinkun and the CSS class rkt speci-
ﬁes left:-9000px, which positions the iframe outside the view-
port, and therefore invisible to the user. The same afﬁliate also de-
frauds Amazon Associates Program using the same technique and
ID shoppertoday-20. We also found two examples where iframes
were made invisible by setting the visibility CSS property on
their parent DOM elements. The 49 remaining iframes were not
hidden, and most of them correspond to ClickBank.

Images. Images can also be used to fetch third-party content on
a Web page. 504 cookies in our data set were requested as im-
ages. Of these we have recorded rendering information for 91%
cookies. Unlike our iframe data, we found that every single DOM
element either had width or height set to 0 or 1px, or style set to
display:none, effectively hiding the image from the end user.
We also found six cookies were requested by hidden img ele-
ments embedded within iframe elements. For example, best
blackhatforum.eu, a domain with Alexa rank 47,520, stuffs
cookies for three different LinkShare merchants (UDemy.com, mi
crosoftstore.com, origin.com), one CJ merchant (GoDa

45ddy.com), and Amazon. All of these afﬁliate URLs are requested
as hidden images of height and width zero pixels inside iframes
with src set to lievequinp.com, which is then observed by af-
ﬁliate programs as the referrer. As a result, the afﬁliate programs do
not observe the actual cookie-stufﬁng bestblackhatforum.eu
domain in the request for afﬁliate URLs thereby making detection
of cookie-stufﬁng difﬁcult. As shown in Table 3, fraudulent afﬁli-
ates use iframes to defraud Amazon and HostGator more often than
afﬁliate networks, suggesting greater difﬁculty in evading detection
by these in-house programs.

Scripts. Even though script tags can be used to fetch third-
party content from afﬁliate URLs by setting the src attribute, we
only found two such stuffed cookies. However, upon manual in-
spection of several cookie-stufﬁng domains we found that scripts
are often used for dynamic generation of hidden images and iframes
that then request the afﬁliate URLs.

Referrer Obfuscation. Next, we analyze the extent to which
fraudulent afﬁliates hide the actual cookie-stufﬁng domain behind
innocuous domains. Referrer obfuscation is used to make cookie-
stufﬁng via any technique, such as images, opaque to the afﬁliate
programs.

Of the 12K cookies we gathered in our crawl, 84% were fetched
via at least one intermediate domain. In fact, 77% of all cookies
were fetched via a single redirect, 4.5% via two redirects, and an-
other 2% via three or more redirects. Only the last redirect is seen
by the afﬁliate program in the HTTP Referer header.

We analyzed the intermediate domains, and found that a signiﬁ-
cant portion of the redirects go through a very small variety of do-
mains. The most common intermediate domains we observed are
cheap-universe.us, flexlinks.com, dpdnav.com, pgpa
rtner.com, 7search.com and pricegrabber.com. Of these,
flexlinks.com belongs to an afﬁliate program called FlexOf-
fers, while the other domains are likely trafﬁc distributors buying
trafﬁc and then monetizing via afﬁliate fraud. Over 25% of the
cookies in our data contain a redirect through at least one of these
trafﬁc distributors. In fact, 36% of all CJ cookies contain at least
one of these domains.

4.3 Prevalence of Afﬁliate Marketing

As described in Section 3, we gathered afﬁliate cookie data from
74 users over a two month period to study how often users click
on afﬁliate links and how often they receive stuffed cookies. Only
12 users received any afﬁliate cookie, encountering a total of 61
cookies for 23 distinct merchants. Over a third of these cookies
resulted from afﬁliate links on dealnews.com and slickdea
ls.net. Thus, while almost 84% of the users did not receive any
cookie at all, 12 users received an average of 5 cookies per user.
Table 3 shows the high level results.

Amazon Associates Program was the most popular afﬁliate pro-
gram in our study, accounting for almost 51% of the cookies. As
shown in Table 3, CJ Afﬁliate was the second most popular afﬁl-
iate program, followed by Rakuten LinkShare. Our users did not
receive any afﬁliate cookies from the ClickBank or HostGator af-
ﬁliate programs. This distribution is different from the networks
targeted by cookie-stuffers, where CJ Afﬁliate is targeted signiﬁ-
cantly more than Amazon.

Notably, none of these afﬁliate cookies were rendered within hid-
den DOM elements. We manually inspected all of them and veri-
ﬁed that none of the source afﬁliate Web sites are stufﬁng cookies.
To rule out the possibility that users were protected by ad-blocking
extensions that often disallow third-party cookies, we gathered the

Afﬁliate Network

Cookies Users Merchants Afﬁliates

Amazon Associates Program
CJ Afﬁliate
ClickBank
HostGator
Rakuten LinkShare
ShareASale

31
18
0
0
9
3

9
5
0
0
3
2

1
2
0
0
6
3

16
7
0
0
5
2

Table 3: Afﬁliate Programs that AffTracker users received cookies
for.

lists of extensions on their browsers and found that only four users
use any such extension. From our user study we found that users
rarely encounter cookie-stufﬁng fraud, and afﬁliate marketing is
dominated by a small number of afﬁliates. While the set of par-
ticipants of our user study is likely biased towards technologically
savvy users, our results are consistent with Snyder et al. [16] who
found that cookie-stufﬁng was a very small percentage of the HTTP
trafﬁc of a large public university.

5. CONCLUSION

In this study we characterized the abuse of afﬁliate marketing for
monetary gains through the use of techniques broadly classiﬁed as
cookie-stufﬁng. Overall, even through targeted crawling of domains
with higher likelihood of encountering afﬁliate fraud, we observed
only a limited amount cookie-stufﬁng in our study.

Most merchants interested in afﬁliate marketing have a choice
to either run their own afﬁliate programs, or join a large afﬁliate
network with thousands of other merchants and afﬁliates. Since af-
ﬁliate networks have a larger number of merchants, they provide
greater opportunity to fraudulent afﬁliates to simultaneously target
multiple merchants. In fact, of the afﬁliate fraud we did identify,
we observed that large afﬁliate networks are targeted disproportion-
ately more compared to the merchant-run afﬁliate programs who
are targeted to a smaller extent, but through more sophisticated and
costly cookie-stufﬁng techniques such as the use of intermediate
domains to obfuscate the cookie-stufﬁng domains. These results
suggest that the in-house afﬁliate programs are better placed to po-
lice their afﬁliate programs due to greater visibility into the afﬁli-
ate activities and the revenue ﬂow, and possibly shorter turnaround
time to take action against a fraudulent afﬁliate upon detection.
However, running an in-house afﬁliate program requires expertise
and cost investment not necessary for outsourcing the logistics of
running an afﬁliate program to an existing network.

Finally, we conducted a user study to determine the extent of
afﬁliate marketing encountered by users during their daily Web
browsing. We found that a small number of afﬁliates dominate af-
ﬁliate marketing, and, as with the crawling results, our users rarely
encountered cookie-stufﬁng fraud.

Acknowledgements

We thank our shepherd Paul Barford for his help with improving the
paper, and the anonymous reviewers for their valuable feedback.
We are also grateful to all the users of the AffTracker extension
without whom our user study would not have been possible. We are
in debt to Cindy Moore for her help in setting up the affiliatet
racker.ucsd.edu domain, and to Tristan Halvorson for manag-
ing the ˙COM zone ﬁle data. This work was supported by National
Science Foundation grant NSF-1237264 and by generous research,
operational and/or in-kind support from Google, Microsoft, Yahoo,
and the UCSD Center for Networked Systems (CNS).

466. REFERENCES
[1] Alexa. Does Alexa have a list of its top-ranked websites?

https://support.alexa.com/hc/en-us/
articles/200449834-Does-Alexa-have-a-lis
t-of-its-top-ranked-websites-.

[2] Amazon. Associates Program Advertising Fee Schedule.

https://affiliate-program.amazon.com/gp/
associates/help/operating/
advertisingfees.

[3] Amazon. Associates Program Participation Requirements.
https://affiliate-program.amazon.com/gp/
associates/help/operating/participation/.

[4] Civil Cover Sheet.

http://www.benedelman.org/affiliate-litig
ation/ebay-digitalpoint-hogan-kessler-t
hunderwood-dunning-complaint.pdf#page=8,
2008.

[5] Digital Point. Cookie Search. https://

tools.digitalpoint.com/cookie-search.

attachments/press-releases/
ftc-publishes-final-guides-governing-end
orsements-testimonials/
091005revisedendorsementguides.pdf.

[10] HostGator. Afﬁliate Terms of Service. http://

www.hostgator.com/tos/affiliate-tos.

[11] A. Kapravelos, C. Grier, N. Chachra, C. Kruegel, G. Vigna,

and V. Paxson. Hulk: Eliciting Malicious Behavior in
Browser Extensions. In Proceedings of the 23rd USENIX
Security Symposium, 2014.

[12] V. I. Levenshtein. Binary Codes Capable of Correcting
Deletions, Insertions, and Reversals. In Soviet Physics
Doklady, 1966.

[13] T. Moore and B. Edelman. Measuring the perpetrators and

funders of typosquatting. In Financial Cryptography and
Data Security, 2010.

[14] Mozilla Developer Network. The X-Frame-Options response
header. https://developer.mozilla.org/en-US/
docs/Web/HTTP/X-Frame-Options.

[6] B. Edelman. Afﬁliate fraud litigation index. http://

[15] mThink. The Top 20 Afﬁliate Networks 2014.

www.benedelman.org/affiliate-litigation/,
2015.

http://mthink.com/
the-top-20-affiliate-networks-2014.

[7] B. Edelman and W. Brandi. Risk, Information, and

[16] P. Snyder and C. Kanich. No Please, After You: Detecting

Incentives in Online Afﬁliate Marketing. In Journal of
Marketing Research, 2014.

[8] J. Edwards. How eBay Worked With The FBI To Put Its Top

Afﬁliate Marketers In Prison.
http://finance.yahoo.com/news/
ebay-worked-fbi-put-top-120500693.html,
2013.

[9] Federal Trade Commission. Guides Concerning the Use of

Endorsements and Testimonials in Advertising.
https://www.ftc.gov/sites/default/files/

Fraud in Afﬁliate Marketing Networks. In Proceedings of the
Workshop on the Economics of Information Security (WEIS),
2015.

[17] The Economist. Pay Per Sale.

http://www.economist.com/node/4462811.

[18] The New York Times. Surviving the Dark Side of Afﬁliate

Marketing. http://www.nytimes.com/2013/12/05/
business/smallbusiness/surviving-the-dar
k-side-of-affiliate-marketing.html.

47