.

......

Weaponizing Femtocells: The Eﬀect of

Rogue Devices on Mobile

Telecommunication

Nico Golde, Kévin Redon, Ravishankar Borgaonkar

Berlin Institute of Technology, Security in Telecommunications

femtocell@sec.t-labs.tu-berlin.de

NDSS 2012, San Diego, 6th February 2012

✆ technology introduction
Introduction

⚔ end-user threats

☠ femtocell/infrastructure threats

Mobile data traﬃc is rapidly increasing (3G, 4G),
but coverage often bad

Operators seek for solutions to oﬄoad traﬃc to
other networks

Introduction of small/cheap cells in residential
environments (home)

As of Q2 2011, 31 operators in 20 countries
adopted femtocell technology (Vodafone, AT&T,
SFR, NTT DoCoMo, ...)

SecT / TU-Berlin

2 / 16

✆ technology introduction
What is a femtocell (HNB or FAP)?

⚔ end-user threats

☠ femtocell/infrastructure threats

Small and cheap base station, small coverage
(around 50m)
Deployed in home environment (no tamper
resistance)
Connected to operator backend via Internet

Reduce expenditure by oﬄoading traﬃc from public
infrastructure
Low maintenance and installation costs
Improved 3G coverage in buildings
Location based services

SecT / TU-Berlin

3 / 16

✆ technology introduction
Contributions

⚔ end-user threats

☠ femtocell/infrastructure threats

End-User risk assessment

Demonstrate attacks violating conﬁdentiality,
integrity and availability of subscriber traﬃc

Femtocell/Infrastructure weakness analysis

Network attacks originating from a femtocell and
design shortcomings in current architectures

) Implementation and evaluation in a real network

SecT / TU-Berlin

4 / 16

✆ technology introduction
Assumption

⚔ end-user threats

☠ femtocell/infrastructure threats

We assume a rooted device!

More information on the rooting process is available in:
Ravishankar Borgaonkar, Kevin Redon and Jean-Pierre
Seifert. "Security Analysis of a Femtocell device". 4th ACM
International Conference on Security of Information and
Networks (SIN)

SecT / TU-Berlin

5 / 16

✆ technology introduction
Home Node B Subsystem (HNS)

⚔ end-user threats

☠ femtocell/infrastructure threats

SecT / TU-Berlin

6 / 16

✆ technology introduction
IMSI-Catching

⚔ end-user threats

☠ femtocell/infrastructure threats

IMSI-Catching in GSM easy by just conﬁguring the
BTS with correct MCC/MNC
In 3G subscribers are protected from IMSI-Catching
by mutual authentication
Authentication performed with the home network,
not the actual cell
) Femtocells by design provide network
authenticity!

Given device access it is possible to:

Reconﬁgure MCC/MNC
Open access for all subscribers (roaming allowed by
SFR)

SecT / TU-Berlin

7 / 16

✆ technology introduction
Voice recording (Conﬁdentiality)

⚔ end-user threats

☠ femtocell/infrastructure threats

Over-the-Air traﬃc encrypted but decrypted on
the femtocell

All traﬃc between femtocell and network is
plaintext and only protected by IPsec

Hijacking control ﬂow of IPSec tunnel software
) Decode IPsec traﬃc, extract voice/SMS
) Femtocells can be a very cheap IMSI-Catcher

SecT / TU-Berlin

8 / 16

✆ technology introduction
Traﬃc MitM (Integrity/Authenticity)

⚔ end-user threats

☠ femtocell/infrastructure threats

What if we change the HNB-GW?
) Full control over all communication

Modify traﬃc, impersonating subscribers
Relay messages to subscriber whenever
authentication is required
Demo implementation based on SMS:
Modify messages or inject SMS on behalf of
subscriber (will be billed)

SecT / TU-Berlin

9 / 16

✆ technology introduction
Detach subscribers (Availability)

⚔ end-user threats

☠ femtocell/infrastructure threats

Disconnecting subscribers in GSM via IMSI DETACH
message (unauthenticated!)
Limited to a certain geographical location!

Femtocell networks have one dedicated VLR
) Limitation vanishes
) DoS against subscribers by detaching the
complete femtocell network

SecT / TU-Berlin

10 / 16

✆ technology introduction
Datamining subscriber information

⚔ end-user threats

☠ femtocell/infrastructure threats

Femtocells store various subscriber and location
information (registered users, neighbour cells, ...)
3GPP speciﬁcations require Node-B's to submit
measurement reports to a central entity

Our device exposed a hidden technician web
interface with broken authentication
) Subscriber and femtocell data exposed!
) No ﬁltering for HNB,HNB communication
Measurement reports are pushed to an FTP server,
with a shared account!

SecT / TU-Berlin

11 / 16

✆ technology introduction
Mapping femtocells

⚔ end-user threats

☠ femtocell/infrastructure threats

Using neighbour cell list, you could, e.g., map
femtocells

SecT / TU-Berlin

12 / 16

✆ technology introduction
Femtocell attack surface

⚔ end-user threats

☠ femtocell/infrastructure threats

Attack surface limited:

Network protocols: NTP, DNS spooﬁng (not tested)
Services: webserver, TR-069 provisioning (feasible)
TR-069 is the de-facto standard for femtocell remote
provisioning

Both HTTP; TR-069 is based on SOAP and XML
) Great potential for software vulnerabilities
All services run as root

Eventually we found a remote root vulnerability in
the webserver (CVE-2011-2900)
) Take over femtocell network
) End-user threats become a global problem!

SecT / TU-Berlin

13 / 16

✆ technology introduction
Possible infrastructure impact

⚔ end-user threats

☠ femtocell/infrastructure threats

Signaling attacks a well known problem, e.g. HLR
overload 1
TCP/IP based communication allows for easy
signaling traﬃc generation at a high rate
) Given a remote root bug this can be ampliﬁed with a
femtocell botnet
Connect to femtocell network without femtocell!
Act as femtocell by using network protocols

1Traynor et al., On Cellular Botnets: Measuring the impact of

Malicious Devices on a Cellular Core Network

SecT / TU-Berlin

14 / 16

✆ technology introduction
Conclusion

⚔ end-user threats

☠ femtocell/infrastructure threats

This is a big mess
Given the history of rooted femtocells (Vodafone
SureSignal, Samsung, SFR) security poorly
implemented in practice
Inherent trust in the physical security of these low
cost devices may be wrong
Femtocell security strongly aﬀects subscriber
privacy, authenticity, availability and operator
network

SecT / TU-Berlin

15 / 16

✆ technology introduction
Acknowledgements (in no particular order) & Questions

⚔ end-user threats

☠ femtocell/infrastructure threats

Jean-Pierre Seifert
Collin Mulliner
Benjamin Michéle
Dieter Spaar
K2
Nicholas Weaver

Thanks for the attention!

Questions?

SecT / TU-Berlin

16 / 16

