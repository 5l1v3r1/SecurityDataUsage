Temporal and Spatial Classiﬁcation

of Active IPv6 Addresses

David Plonka

Akamai Technologies

plonka@akamai.com

Arthur Berger

Akamai Technologies

Massachusetts Institute of Technology

arthur@akamai.com

ABSTRACT
There is striking volume of World-Wide Web activity on
IPv6 today. In early 2015, one large Content Distribution
Network handles 50 billion IPv6 requests per day from
hundreds of millions of IPv6 client addresses; billions of
unique client addresses are observed per month. Address
counts, however, obscure the number of hosts with IPv6
connectivity to the global Internet. There are numerous
address assignment and subnetting options in use; privacy
addresses and dynamic subnet pools signiﬁcantly inﬂate
the number of active IPv6 addresses. As the IPv6 address
space is vast, it is infeasible to comprehensively probe ev-
ery possible unicast IPv6 address. Thus, to survey the
characteristics of IPv6 addressing, we perform a year-long
passive measurement study, analyzing the IPv6 addresses
gleaned from activity logs for all clients accessing a global
CDN.

The goal of our work is to develop ﬂexible classiﬁcation
and measurement methods for IPv6, motivated by the fact
that its addresses are not merely more numerous; they are
different in kind. We introduce the notion of classifying
addresses and preﬁxes in two ways: (1) temporally, ac-
cording to their instances of activity to discern which ad-
dresses can be considered stable; (2) spatially, according
to the density or sparsity of aggregates in which active
addresses reside. We present measurement and classiﬁ-
cation results numerically and visually that: provide de-
tails on IPv6 address use and structure in global operation
across the past year; establish the efﬁcacy of our classiﬁ-
cation methods; and demonstrate that such classiﬁcation
can clarify dimensions of the Internet that otherwise ap-
pear quite blurred by current IPv6 addressing practices.

1.

INTRODUCTION

In 2015, we are in an era of production-quality, simulta-
neous operation of the Internet protocol versions 4 (IPv4)

Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage and that copies bear this notice and the full citation
on the ﬁrst page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior speciﬁc permission
and/or a fee. Request permissions from Permissions@acm.org.
IMC ’15, October 28–30, 2015, Tokyo, Japan
Copyright is held by the owner/author(s). Publication rights licenced to ACM.
ACM 978-1-4503-3848-6/15/10...$15.00
DOI: http://dx.doi.org/10.1145/2815675.2815678

and 6 (IPv6).
IPv6 trafﬁc volumes have reportedly dou-
bled in the past year, and globally over 6% of clients hav-
ing IPv6 connectivity [2, 27, 36]. In the fourth quarter of
2014, a signiﬁcant proportion of World-Wide Web (WWW)
clients used IPv6 to access content that is available over
both IPv6 and IPv4 via a global Content Distribution Net-
work (CDN): 70% for Verizon Wireless, 30% for AT&T, and
27% for Comcast [4].

In this work, we study populations of active IPv6 ad-
dresses, i.e., those observed to exchange trafﬁc rather than
merely allocated or assigned. Like most censuses, ours
involves counting members of groups or classes.
IP ad-
dresses can be classiﬁed with respect to various dimen-
sions. Historically, the initial IPv4 address “classes” were
determined a priori as classes A, B, C, etc. Following the
introduction of classless inter-domain routing (CIDR), ad-
dresses would more naturally be classiﬁed based on ﬂexi-
ble aggregates in routing tables, such as that of their Bor-
der Gateway Protocol (BGP) preﬁx. Addresses can also
be classiﬁed based on reserved and special-use preﬁxes,
e.g., RFC1918 and multicast. However, operational needs
have led to a broader notion of address class, even if not
referred to as “class” per se, nor are classes mutually ex-
clusive. Some example IPv4 address classiﬁcations of re-
cent interest are based on client reputation, geolocation,
assignment to a common network element (e.g., router
aliases), anycast, and proxy.

Most of these classes pertain to both IPv4 and IPv6 ad-
dresses. However, two dimensions are more signiﬁcant
with IPv6, and are the focus of this paper. The ﬁrst we call
“temporal” and is primarily motivated by the popularity of
host privacy extensions whereby the vast majority of IPv6
addresses are used for short periods, e.g., 24 hours or less,
and in all likelihood will never be used again. The second
we call “spatial” and pertains to the vastly greater num-
ber of possible areas (preﬁxes) and positions (addresses)
in the IPv6 address space. Whereas scanning the full IPv4
address space is now routine, this is not feasible for IPv6.
We need other techniques to discover “where the action
is.” IPv6, also, allows greater freedom in the use of the
subnet preﬁx. We ﬁnd a variety of practices employed by
different network operators. Our goal is to detect the dif-
ferent types of IPv6 addresses in active use, with particular
interest in (a) discriminating stable, persistent addresses
from ephemeral, short-lived addresses and (b) discovering

509how addresses are arranged in the address space, thereby
forming sparse and dense regions.

There are numerous applications of temporal and spatial
address classiﬁcation. Examples include: selecting targets
for active measurements, e.g., traceroutes, vulnerability
scans, and reachability surveys; informing data retention
policy to prevent resource exhaustion, e.g., when encoun-
tering many ephemeral addresses or preﬁxes; informing
host reputation and access control, e.g., to mitigate net-
work abuse; identifying homogeneous address aggregates,
e.g., for IP geolocation; and detecting changes in network
operation or estimating Internet usage over time.

This paper makes the following contributions:

(1) We present census results based on a large-scale, lon-
gitudinal, passive IPv6 measurement study of active ad-
dresses used by WWW clients in 133 countries and over
(2) We introduce a
four thousand autonomous systems.
temporal classiﬁcation technique for IPv6 addresses based
on observation of address activity over time. (3) We intro-
duce a complementary spatial classiﬁcation technique for
IPv6 addresses based on measurement of the sparsity or
density of the address preﬁxes in which they reside. (4)
We evaluate the temporal and spatial classiﬁers by utiliz-
ing them in situ, and show results of the classiﬁcation of
billions of active IPv6 addresses.

In addition, we introduce the Multi-Resolution Aggre-
gate (MRA) plot, a tool for examining a set of numbers in
a very sparsely populated number space, inspired by the
work of Kohler et al. [28] and make available the plot data
for any or all of the IPv6 BGP preﬁxes across the year un-
der study. [3] MRA plots show structural detail and allow
address space exploration without necessarily identifying
speciﬁc addresses or blocks by number.

Highlights of our results include, as of early 2015:
• When autonomous systems (ASNs) are ranked by their
WWW client address counts, the top 5 ASNs represent
85% of active /64 preﬁxes (“/64s”) and 59% of all active ad-
dresses. Of these ASNs, 2 are U.S.-based mobile carriers,
i.e., wireless Internet Service Providers (ISP); the others
are a European, an American, and a Japanese ISP.

• Although the vast majority of IPv6 clients use native
transport, 6to4 tunneling is still common.
If not segre-
gated in measurement, the ASNs hosting 6to4 relays would
be amongst the top 5 ASNs.

• 74% of the 153 million of the /64s observed as active
during both of two weeks separated by 6 months are asso-
ciated with just 1 ASN.

• Despite the vast IPv6 unicast address space and gen-
erous allocations to networks, many /64s are reused, i.e.,
assigned to different users over time, certainly within a
week.

• Of 1.81 million addresses observed as stable across 1
year, over half a million are associated with two mobile car-
riers which, in apparent contradiction, use dynamic values
in network identiﬁers. Further investigation shows that
many mobile devices simultaneously use the same ﬁxed in-
terface identiﬁer. Combined with dynamic /64 assignment,
this can result in an IPv6 address being reused by a differ-
ent subscriber on a short timescale, e.g., within days.

• While privacy addressing is common and brings ran-
domness and sparsity to address values, there are many
dense regions of IPv6 address space where addresses are
well-ordered and tightly-packed. 49% of active IPv6 ASNs
have BGP preﬁxes containing such regions, e.g., /112 pre-
ﬁxes (64K address blocks) containing multiple active WWW
client addresses. These blocks are natural targets if fu-
ture, active scanning or probing is intended.

The remainder of this paper is organized as follows. In
Section 2, we discuss related prior work. In Section 3, we
give a brief introduction to IPv6 addresses. In Section 4,
we describe the data used in our empirical study. In Sec-
tion 5, we present our IPv6 address classiﬁcation methods.
In Section 6, we present and discuss results of our tempo-
ral and spatial classiﬁcations.
In Section 7, we propose
future work based on our results, and subsequently con-
clude.

2. RELATED WORK

To our knowledge, our temporal classiﬁer does not have
a precedent in the research literature. The temporal char-
acteristics of IPv4 addresses, however, became topical as
scalability concerns arose with the Internet’s exponential
growth in the 1990s. Carpenter et al. comment on this in
RFC 2101 [10]. With respect to IPv6, Malone’s work [30]
is similar to ours in that they also study active IPv6 ad-
dresses. They develop a technique intended to classify
short-lived privacy addresses by examining only the ad-
dress itself, but its accuracy is limited by design, expected
to identify approximately 73% of all privacy addresses. Since
it is very challenging to detect randomness in short strings,
e.g., 63 bits of an IPv6 address, we take the complemen-
tary approach and identify those addresses that are sta-
ble and, thus, almost certainly not privacy addresses. In
the end, Malone speculates that “[accuracy] might be im-
proved accounting for the times addresses are observed
and spatially/temporally adjacent addresses,” which seems
exactly the notion at which we arrive independently, inspir-
ing the strategies that we develop here.

Development of our spatial classiﬁer is largely informed
by the prior work of two teams: Cho et al. and Kohler
et al. Cho et al. [12] introduce aguri, a trafﬁc proﬁler
that employs automatic aggregation based on addresses’
and preﬁxes’ observed trafﬁc volume. As in their work, we
ﬁnd their PATRICIA/radix tree-based aggregation useful in
dealing with resource constraints, however, we use it to
discover address structure. We do this by aggregating to a
threshold that is either (a) a percentage of total addresses
or (b) a preﬁx density, rather than a percentage of total
trafﬁc volume. This aggregation method is useful because
it generalizes to other metrics.

Kohler et al. [28] investigate the structure of the IPv4
address space based on passive trafﬁc analysis. In a broad
sense, our IPv6 investigation is similar and we employ two
of their metrics as-is: active aggregate counts and aggre-
gate population distributions.
IPv6 addresses, however,
present different challenges and opportunities to discern
structure, so we develop new IPv6-speciﬁc metrics. Our
work also differs in that we apply those metrics to classify

510addresses rather than to evaluate mathematical character-
izations of the address space.

Dainotti et al. [16] investigate IPv4 address space usage
by attempting to identify active and inactive /24 address-
blocks using passive measurement. Our census of WWW
client addresses similarly employs passive means, but we
count aggregates of every possible preﬁx length. Also, be-
cause we determine address activity from the complete
logs of all clients’ successful WWW transactions with a
large CDN, we eschew complications introduced by spoofed
addresses. While they propose that their method could
potentially apply to measuring IPv6 address space usage,
they do not discuss how it might treat persistent versus
ephemeral addresses nor if it could count addresses in
“small” address-blocks, e.g., smaller than /64 preﬁxes. Our
method would likely complement theirs, if applied to IPv6.
In 2012, Barnes et al. [8, 13] evaluated methods to map
the vast IPv6 address space by probes in order to discover
active addresses. Our work shares that goal but beneﬁts
from increased IPv6 activity and content-accessibility that
make passive methods viable. The stable addresses and
dense address regions that we identify are feasible targets
for active scans or probes, thus our method may repair or
complement target selection heuristics employed in their
early survey. Still, like Barnes et al., our work is guided by
operator practice with respect to IPv6 addressing.

There are a number of studies in the literature that mea-
sure and report on the deployment and adoption of IPv6.
Recent examples of such work are those of Colitti et al. [14]
and Czyz et al. [15] Our work differs in that we measure
IPv6 by counting active addresses and preﬁxes, rather than
by counting advertised preﬁxes or trafﬁc hits and bytes.
Each have different biases with respect to estimating us-
age.
Internet-wide surveys of active IPv6 addresses are
scarce in the literature, e.g., Malone [30] circa 2008. How-
ever, Huston and Michaelson [26, 27], perform a signiﬁ-
cant ongoing measurement study involving IPv6 addresses;
they observe activity by opportunistically running “interac-
tive” advertisements that are crafted to elicit connection
attempts from WWW clients to their own measurement
service via both IPv4 and IPv6. Our study is limited to
IPv6, but seems to offer different advantages. They ob-
serve the IPv4/IPv6 address pairs associated with WWW
clients. We observe signiﬁcantly more activity from mobile
carriers, where the ads rarely run, and activity in a larger
set of ASNs [32, 25].

3.

IPV6 ADDRESSES

Here we present a brief introduction to IPv6 address as-
signment. An IPv6 address consists of a leading network
identiﬁer, a.k.a. subnet preﬁx, portion followed by an inter-
face identiﬁer (IID) portion. The network identiﬁer is used
to route trafﬁc destined for this address to its Local Area
Network (LAN) and the IID makes a host interface’s ad-
dress unique on its local network segment. While superﬁ-
cially similar to the network and host identiﬁer portions of
IPv4 addresses, the vast IPv6 address space allows much
more freedom.

There are many IPv6 addressing schemes and network
operators are reminded to treat interface identiﬁers as se-

mantically opaque [11]. In this work, however, we utilize
address content, including IID, as a basis for classiﬁca-
tion and ﬁnd correspondences with a variety of standards-
deﬁned address types. For instance, administrators have
the option to use a /64 network preﬁx and a rather large
IID, i.e., 64 bits [22], or a larger network preﬁx, e.g., /127,
and a smaller IID, e.g., only 1 bit [17, 29]. In the former
case, with stateless address auto-conﬁguration (SLAAC),
the host chooses a 64-bit IID sufﬁx for itself. Consider the
sample addresses in Figure 1. In increasing order of com-
plexity, these addresses appear to be: (i) an address with
ﬁxed IID value (::103), (ii) an address with a structured
value in the low 64 bits (perhaps a subnet distinguished by
::10), (iii) a SLAAC address with EUI-64 Ethernet-MAC-
based IID, and (iv) a SLAAC privacy address with a pseu-
dorandom IID.

2001:db8:10:1::103
2001:db8:167:1109::10:901
2001:db8:0:1cdf:21e:c2ff:fec0:11db
2001:db8:4137:9e76:3031:f3fd:bbdd:2c2a

Figure 1: Sample IPv6 addresses in presentation format
with the low 64 bits shown bold.

The ﬁrst two addresses are similar to those created by
traditional addressing schemes used in IPv4 while the lat-
ter two use standard IPv6-speciﬁc addresses schemes: EUI-
64 [39] and privacy addresses [33], respectively. 1 Since
one might reasonably expect these interface identiﬁers to
be difﬁcult to distinguish merely by their content, we em-
ploy temporal analysis to discriminate these from, at least,
privacy addresses.

A number of transition mechanisms aid concurrent op-
eration of IPv6 with IPv4 and affect IPv6 addresses them-
selves. These include: 6to4 relays [23] and Teredo [24],
which employ global reserved preﬁxes; and ISATAP [38]
which embeds IPv4 addresses in the IPv6 IID. Finally, there
are additional ad hoc schemes by which an IPv6 address
contains an embedded IPv4 address, e.g., those used for
some router and dual-stack host interfaces. This is typi-
cally a convenience rather than a requirement.

4. EMPIRICAL DATA

Our study requires data sources containing IPv6 addresses

which are active, that is, addresses that exchange globally-
routed Internet trafﬁc.
4.1 WWW Client Addresses

We primarily rely on aggregated logs of WWW server
activity in this study. These aggregated logs contain hit
counts per client IP address. We select only the client IP
addresses from log entries that represent successfully han-
dled requests, thus avoiding spoofed sources. The aggre-
gation interval is 24 hours, for 55,000 of the CDN’s IPv6-
capable servers, and is processed roughly by the end of

1Other IPv6 address schemes by which interface identi-
ﬁers are generated include: Cryptographically Generated
Addresses [5, 7], Hash-Based Addresses [6], and stable pri-
vacy addresses [20].

511the subsequent day. Note that the aggregation does not
include the timestamp from the individual log lines, used
in separate processing for the CDN’s customers. Instead,
we use the time epoch of the completion of processing of
the aggregated logs. Our stability analysis, described in
Section 5, uses a heuristic to accommodate this timestamp
slew.

In March 2015, the dataset contains IPv6 addresses in
6,872 BGP preﬁxes originating from 4,420 ASNs (46% of
those advertising IPv6 preﬁxes). These ﬁgures are an in-
crease from March 2014 when there were 5,531 BGP pre-
ﬁxes originating from 3,842 ASNs (40%). Alas, we cer-
tainly do not see trafﬁc from all the world’s WWW client
addresses at this observation point, and our stability anal-
ysis shows that some speciﬁc long-lived active IPv6 ad-
dresses, e.g., EUI-64, return as WWW clients only infre-
quently.

Table 1 summarizes the IPv6 WWW client address ac-
tivity observed across a year at 6 month intervals, March
2014 through March 2015; we report both daily and weekly
counts. With daily counts, fewer ephemeral privacy ad-
dresses are observed, while with weekly counts there is
increased opportunity to observe activity of WWW clients
that visit the CDN less frequently than daily.

In Table 1, by March 2015, we see that the address count
increased to over 318 million observed daily and over 1.8
billion observed in a week’s time. Correspondingly, 121
million /64 preﬁxes are observed daily and 307 million /64
preﬁxes in a week’s time.

We are careful to separate client addresses involving
some IPv6 transition mechanisms from addresses involved
in “native” IPv6 end-to-end transport; this is because those
transition mechanisms’ addresses would skew results. Spec-
iﬁcally, we cull addresses associated with the early IPv6
transition mechanisms, i.e., Teredo, ISATAP, and 6to4. Of
these, only 6to4 still shows signiﬁcant use. These 3 par-
ticular transition mechanisms’ addresses are easily classi-
ﬁed, do not involve native, end-to-end IPv6 transport, and
are, thus, not the focus of our classiﬁers. Once removed
the remaining “Other” addresses in Table 1 account for
over 90% of the active addresses observed. These “Other”
addresses are subjects for the classiﬁers we introduce in
Section 5 and are those for which we report results unless
otherwise noted. These addresses intentionally include
those of transition mechanisms such as 464-XLAT [31] and
DS-Lite [18, 9], e.g., used by large mobile carriers involv-
ing native, end-to-end IPv6 transport.

Lastly, in Table 1, EUI-64 addresses are reported. These
are those addresses in which we detect the 16-bit value
ff:fe at the prescribed position when the EUI-64 IID is
based on an Ethernet MAC address. [39] Some of these
have invalid or duplicate MAC addresses, e.g., MAC ad-
dress 00:11:22:33:44:56 is the most prevalent and just in
one mobile carrier’s network. Others are likely false posi-
tives, e.g., privacy addresses where the likelihood of being
mislabelled as EUI-64 is 1 in 216, or less than 30, 000 of
1.8 billion addresses. We consider these an inconsequen-
tial subset of the 16.2 million EUI-64 addresses in Table 1,
March 17-23, 2015.

4.2 Router Addresses

In addition to periodic collection of active WWW client
addresses, we also collect a set of IPv6 addresses that
were the source addresses of ICMP “Time Exceeded” re-
sponses to our TTL-limited probes, similar to those gener-
ated by the traceroute tool. Based on collection in Febru-
ary 2015, this dataset consists of 3.2 million addresses that
appear to be assigned to router interfaces. Three types
of probe targets were used: (1) addresses of IPv6 recur-
sive DNS servers, as observed by our authoritative DNS
servers, (2) addresses of the CDN’s servers in approxi-
mately 500 locations world-wide, and (3) a selection of
about 18 million WWW client addresses assembled since
2013, including a subset (12 million) of those addresses
identiﬁed as stable in March and September, 2014 (Those
reported in Table 2a in Section 6.) This dataset is used
to identify additional dense preﬁxes as reported in Table 3
with the expectation that areas of the address space con-
taining WWW clients differ from those containing routers.

5. ANALYSIS METHOD
5.1 Temporal Classiﬁcation

Our temporal methods of IPv6 address classiﬁcation are
intended to determine address lifetime, primarily to sep-
arate those client addresses that are persistent or stable
from those that are perhaps not. We refer to this as sta-
bility analysis. Let’s ﬁrst consider a simple notion of sta-
bility. If one periodically logs sets of active addresses at
some interval, e.g., 6 months, it is easy to ﬁnd which sets
have addresses in common. For instance, if address x is
observed as active in March 2015 as well as a year earlier,
in March 2014, it can be considered stable. Our stability
classes are named according to the length of time across
which stability has been assessed. Thus we would say ad-
dress x is “1 year stable,” when sampled across the past 1
year, and is classiﬁed as “1y-stable (-1y).” If x is observed
in March 2015 and also 6 months earlier, in September
2014, it would also be classiﬁed as “6m-stable (-6m).” This
notion of stability generalizes to preﬁxes of any length, not
just full addresses; we similarly assess the stability of /64
preﬁxes extracted from the full addresses.

Since we wish to perform stability analysis on an ongo-
ing basis, consider a slightly more complicated notion of
stability. Let’s deﬁne more granular classes of stability,
e.g., daily. Deﬁnition: “nd-stable” is the class of addresses
for which there exist observations of activity on two differ-
ent days with an intervening time period of at least n   1
days. For example, a given address seen on March 17
and again on March 18 (for which there are no interven-
ing days) is said to be “1d-stable.” Likewise, an address
seen on March 17 and on March 19 (for which there is
one intervening day) is said to be “2d-stable.” Note that
since March 17 and March 19 have at least zero interven-
ing days, then an address seen on these two days is also
“1d-stable,” besides being “2d-stable;” the classes are not
mutually exclusive. More generally, an address that is “nd-
stable” is also “(n   1)d-stable.”
Since a measurement study of client IP addresses that
access a given service will typically capture only a portion

512Characteristic

Teredo addresses
ISATAP addresses
6to4 addresses
Other addresses
Other /64 preﬁxes
ave. addrs per /64
EUI-64 addr (!6to4)
EUI-64 IIDs (MACs)

Mar 17,
2014
1.98K (0.00%)
90.2K (0.06%)
12.8M (7.97%)
149M (92.0%)
61.4M
2.41
3.13M (1.94%)
2.85M

Sep 17,
2014
3.28K (0.00%)
101K (0.04%)
12.5M (5.90%)
199M (94.1%)
82.9M
2.40
3.66M (1.73%)
3.23M

Mar 17,
2015
20.1K (0.01%)
133K (0.04%)
13.9M (4.19%)
318M (95.8%)
121M
2.63
4.49M (1.35%)
3.81M

Characteristic

Teredo addresses
ISATAP addresses
6to4 addresses
Other addresses
Other /64 preﬁxes
ave. addrs per /64
EUI-64 addr (!6to4)
EUI-64 IIDs (MACs)

Mar 17-23,
2014
15.1K (0.00%)
210K (0.02%)
64.9M (7.22%)
833M (92.8%)
157M
5.32
8.88M (0.99%)
6.12M

Sep 17-23,
2014
24.5K (0.00%)
238K (0.02%)
78.3M (6.34%)
1.17B (94.9%)
207M
5.64
13.1M (1.06%)
8.16M

Mar 17-23,
2015
131K (0.01%)
346K (0.02%)
64.2M (3.43%)
1.80B (96.5%)
307M
5.88
16.2M (0.866%)
9.74M

(a) Address characteristics per day

(b) Address characteristics per week

Table 1: Active IPv6 WWW client address characteristics: March 2014 through March 2015.

of the addresses’ total Internet activity, and since that ser-
vice may be accessed infrequently, even a long-lived client
address, e.g., using EUI-64, may appear to be ephemeral.
Thus, we will simply label such addresses as “not stable,”
meaning only that we do not know that address to be sta-
ble. Stability classiﬁcation relies on, and is limited by, the
opportunity for observation of activity from given vantage
points.

In our daily stability analysis, we employ a sliding 15-day
window centered on the day of observation and spanning 7
days prior through 7 days following. In such context, a 3d-
stable address might be classiﬁed as “3d-stable (-7d,+7d).”
For stability results herein, “(-7d,+7d)” is implied unless
otherwise noted. Figure 5 in Section 6 shows the numbers
of active addresses and /64s observed on each day as well
as the subset in common between those also observed on
the reference day (March 17 or March 23, 2015).
5.2 Spatial Classiﬁcation

Our spatial methods of IPv6 address classiﬁcation and
preﬁx characterization are intended to both assess the prox-
imity of addresses and preﬁxes and to visualize the address
blocks in which they are contained. We develop two re-
lated metrics for use with IPv6: Multi-Resolution Aggre-
gate (MRA) Count Ratios and Preﬁx Density, and a com-
plementary visualization technique, the MRA plot. In the
following, preﬁxes are characterized structurally, then ad-
dresses therein are classiﬁed according to the densities of
their containing, non-overlapping sub-preﬁxes.
5.2.1 Multi-Resolution Aggregate Count Ratios
Our metric MRA Count Ratio is a generalization of a met-
ric introduced by Kohler et al. With 128 bit addresses and
IPv6 presentation format using hexadecimal characters,
network operators have great ﬂexibility to use segments
of the address for internal purposes; e.g., 16 bit and 4 bit
segments are commonly used for subnetting.
(See [21]
and [35] for recommended operational guidelines.) Here
we present an informal, high-level understanding of MRA
ratios and an optional, formal deﬁnition. The latter is un-
necessary for a general introduction.

• Informally, to the trained eye, MRA plots expose struc-
ture amongst preﬁxes populating the vast IPv6 address
space.
In the following MRA plots, the height indicates
how much that segment of the address is relevant to group-
ing a set of addresses into areas of the address space. Ad-

dresses aggregated further to the left (high order bits) are
more distant from each other; addresses aggregated to the
right are close to one another. MRA ratios for a set of ad-
dresses, when plotted, expose the density (or sparsity) of
each segment of the addresses, whether bits, characters,
or colon-separated segments.

• Formally, Kohler et al. introduce the metric of active
aggregate (preﬁx) counts, and their ratio. Given N ad-
dresses, they can be grouped into preﬁxes of various sizes.
For a given preﬁx size, say /p, there is a (smallest) set of
preﬁxes of size /p that contains (covers) all N addresses.
At one extreme, each IPv6 address is in its own /128 pre-
ﬁx, at the other extreme the single /0 preﬁx contains all
of the addresses. Let the “active aggregate count” np be
the number of /p preﬁxes that covers the given set of ad-
dresses. By deﬁnition np = 1 for p = 0 and np = N for
p = 128. Often a more convenient metric is the ratio of
active aggregate counts,  p ⌘ np+1/np. The range of  p
is 1 to 2. As an example, suppose that a set of addresses
is covered by 100 preﬁxes of size /56, n56 = 100. Now,
consider one of these /56 preﬁxes and what can happen
when it is partitioned in two /57 preﬁxes. Either all of the
addresses in the /56 are in one of the /57 preﬁxes, or there
is at least one address in each of the two /57 preﬁxes. If
the former pertains for all of the /56 preﬁxes then the ra-
tio n57/n56 would be 1, and if the latter pertains for all, the
ratio would be 2. Typically, the former pertains for some
and the latter for others, in which case the ratio is be-
tween 1 and 2. Now, to examine 4-bit address segments,
for instance, it is convenient to compute ratios of active
aggregate counts where the mask has been incremented
by values larger than 1 bit. Note that 4 bits is one hex-
adecimal character and 16 bits is a series of 4 hexadecimal
characters that, when aligned, are colon-delimited in IPv6
presentation format; these are convenient segment sizes
in IPv6 that are not convenient in IPv4 due to presentation
format being in base 10. We consider the somewhat more
general “MRA count ratio”  k
p ⌘ np+k/np, where canoni-
cally p is a multiple of k, and k is 1, 4, 8, or 16. The range
of  k
p is 1 to 2k. Note: The deﬁnition of the ratios implies
that, for given resolution (k), the product of the ratios is
the total number of addresses in the set.

Sample MRA plots are shown in Figure 2, annotated with
sample addresses (inset) and arrows marking features to
aid the reader’s interpretation. In Figure 2a, consider the

5132001:db8:e:0:e174:5522:1ada:1e5b
2001:db8:1082:fff8:ab:ebfd:9b16:6095
2001:db8:1082:fff8:9185:20eb:4349:816b
2001:db8:1082:fffa:245d:21cc:69a5:ac39
2001:db8:1082:ffff:d4b8:7d56:ad92:252f

compare height

16-bit segments
4-bit segments
single bits

256

e
l
a
c
s
 
g
o
l
 
,

o
i
t
a
r
 
t
n
u
o
c
 
e
t
a
g
e
r
g
g
a

128

64

32

16

8

4

2

1

0

"u" bit cleared

sparse /64 prefixes

(known BGP prefix)

16

32

48

64

Prefix length (p)

80

(a) US university

96

112

128

2001:db8:10:8::17f
2001:db8:10:9::68
2001:db8:10:c::109d
2001:db8:10:e::92d
2001:db8:20:c000:568:acf2:32ba:c6bf
compare height

256

128

16-bit segments
4-bit segments
single bits

e
l
a
c
s
 
g
o
l
 
,

o
i
t
a
r
 
t
n
u
o
c
 
e
t
a
g
e
r
g
g
a

64

32

16

8

4

2

1

0

single bit

sparse

dense

(known BGP prefix)

16

32

48

64

Prefix length (p)

80

(b) JP telco

96

112

128

Figure 2: Sample MRA plots for active IPv6 client ad-
dresses (a) a university preﬁx with 7.22K addresses and
(b) a telco preﬁx with 12.8K addresses.

portion of the plot for the “single bits” (blue) line at x >=
64. This portion of the plot initially approximates 2, then
slopes downward to the right, but with a drop to 1 at a
particular bit: this is the signature of a scenario where
each /64 contains many addresses and where, within each
preﬁx, the majority of the addresses have IIDs determined
by the end host according to the pseudorandom privacy
extension as speciﬁed in RFC 4941 [33].

• Details on the signature for privacy extension: Con-
sider one of the /64 preﬁxes. Given that the 65th bit is
chosen randomly, and that there are many addresses in the
/64 preﬁx, e.g., x addresses, then it is very likely (proba-
bility = 1  (1/2)x 1) that at least one of the addresses will
have a 0 for the 65th bit and, likewise, that at least one
of the addresses will have a 1. Thus the ratio n65/n64 for
this preﬁx is very likely to be 2. If this pertains for all /64
preﬁxes, the ratio for the whole set of addresses will also
be 2. In turn, given that each /65 preﬁx also has a large
number of addresses, the above logic repeats, and thus we

expect the ratio to remain close to 2. However, as we con-
tinue to split preﬁxes in half, each preﬁx has a decreasing
number of addresses and an increasing chance that those
addresses will all have the same next bit. Once they are
all the same, the ratio for such preﬁxes will be 1 and the
overall ratio will begin to decline from 2. Moreover, even if
the original set contained a billion addresses, it would still
be very sparse in the space of 264 possible IIDs. As we con-
tinue to consider ever smaller preﬁxes, eventually, each
will contain just one pseudorandom-IID address, and the
overall ratio will ﬂat line at 1. In the presented plot, this
occurs at about the 80th bit. Finally, as a deﬁning feature
of the present scenario, note that the ratio drops to almost
1 at the 71st bit, shown at 70 on the horizontal axis. This is
consistent with end hosts that determine the IID according
to RFC 4941, which speciﬁes that the “u” bit be set to 0,
meaning that an IID is not necessarily universally unique,
as opposed to a MAC address.

Now consider Figure 2b in contrast to Figure 2a. These
two organizations appear to have signiﬁcantly different ad-
dress assignment policies. In Figure 2b, we see a promi-
nence between bits 112 and 128. This indicates that there
are many active addresses that differ in only those least-
signiﬁcant bits, i.e., addresses are clustered within smaller
preﬁxes, and thus such preﬁxes are more dense address
blocks.

If one were interested in searching for additional active
IPv6 addresses, these denser address blocks would be nat-
ural targets. A /112 preﬁx covers 216 addresses, the same
as a /16 in IPv4, and is easily scanned, whereas scanning
across a /64 is not practical.

Now consider Figure 2a with respect to the plotted ra-
tios for 4-bit segments, a.k.a. nybbles, in the plot (black
line). Here we consider changes on a per-nybble, hex-
adecimal character basis. This provides a more aggre-
gated view, summarizing details of changes on a per-bit
basis. Our ﬁrst-order interest is network operator prac-
tice with respect to subnetting. In particular, we assume
this network subnets their /32 BGP preﬁx, so we consider
segments of the address down to the /64, i.e., across the
canonical network identiﬁer. The jump up for the plot at 32
indicates that addresses have differing (character) values
at that nybble, but not, in turn, at the subsequent nybble at
36. The subsequent two nybbles could also be used to dis-
criminate many addresses, and then much less so for the
subsequent three nybbles. In contrast to Figure 2a, note
that the addresses in Figure 2b have many different (char-
acter) values in the last nybble within network portion of
the address at 60.

While this introduction to Multi-Resolution Aggregation
ratio focused on visual recognition of IPv6 features in MRA
plots, the underlying x, y values offer a convenient basis to
classify preﬁxes, and the addresses therein. While deﬁning
MRA-based address classes is left for future work, we be-
gin by developing spatial classiﬁcation by identifying dense
preﬁxes.
5.2.2 Preﬁx Density
Kohler et al. [28] introduces the metric of the number
of active addresses in a preﬁx, and examine the distribu-

514tion of this number across preﬁxes of a given size. They
consider IPv4 and are interested in how well their models
match with measurements, commenting, “aggregate pop-
ulation distributions are the most effective test we have
found to differentiate address structures.”

We plot the aggregate population complementary cumu-
lative distribution function for all IPv6 addresses and /64
preﬁxes active during a 7-day period in Figure 3. For the
curve showing the 112-aggregate of addresses (the low-
est curve), only 10 5 of the /112 preﬁxes contained 10
or more observed addresses; for the 48-aggregate of ad-
dresses, fewer than one in ten of the /48 preﬁxes contained
10 or more observed addresses, hence, a few preﬁxes must
contain most of the addresses. Approximately 10 4 of the
48-aggregate of addresses contain 105 or more addresses,
which clearly illustrates the sparsity of the IPv6 address
space and the concentration of observed addresses in a
small subset of preﬁxes.

e
l
a
c
s
 

g
o
l
 
,

 

n
o
i
t
r
o
p
o
r
P
F
D
C
y
r
a
t
n
e
m
e
l
p
m
o
C

 

100

10-1

10-2

10-3

10-4

10-5

10-6

100

101

102

32-agg. of IPv6 addrs
32-agg. of /64s
48-agg. of IPv6 addrs
48-agg. of /64s
112-agg of IPv6 addrs

107

108

109

103
106
Aggregate Population, log scale

104

105

Figure 3: Aggregate population distributions for 1.87B
IPv6 addresses, 358M /64s, March 17-23, 2015.

Kohler’s aggregate population considers the observed
count of addresses in a preﬁx. A related measure is ob-
tained by dividing that observed count by the number of
addresses spanned by the preﬁx, yielding the percentage
of the addresses of the preﬁx that were observed.

Cho et al. [12] use a percentage as a criterion in an
aggregation-based trafﬁc proﬁler, however, their percent-
age is obtained by dividing an observed count by a total
observed count across all preﬁxes. In their implementa-
tion, preﬁxes are nodes in an aguri tree, with observed ad-
dresses added as leaf nodes. Aggregation is kind of “prun-
ing,” and is performed by aggregating a node’s count to its
parent (and removing that node), unless that node’s count
meets or exceeds a target minimum percentage.

Consider an IP network preﬁx such as 2000::/3 or

2001:db8::/32. A preﬁx might contain “addresses of in-
terest” by arbitrary criterion, e.g., addresses for which ac-
tivity was observed. A simple notion of a preﬁx’s density,
then, is the fraction of its addresses that are active. Both
the preﬁx and its addresses can be said to have a density
of d. where d is a fraction with a value greater than 0 and
less than or equal to 1.

If we restrict desired minimum densities to the fraction
n/2p0 , where p0 is a number of bits in the range 0 through
128, there is a simpler solution that does not require base-
10 math with large numbers, i.e., greater than 64 bits. We
use this restriction, and choose densities based on two pa-
rameters: n and p, where p = 128   p0.
Now, let’s deﬁne our spatial address classes based on
preﬁx density. Deﬁnition: “n@/p-dense” is the class of
preﬁxes of length p that contain at least n addresses for
which there exist observations of activity.
It is also the
class of those addresses contained therein. For example,
let’s say the IPv6 addresses 2001:db8::1 and 2001:db8::4
are both active, but no others. If the desire is to identify
/112 preﬁxes that are dense, then 2001:db8::/112 is the
sole 2@/112-dense preﬁx. There is also one 2@/125-dense
preﬁx, but no 2@/126-dense preﬁxes.
5.2.3 Computing Dense Preﬁxes
We would like to identify the dense preﬁxes based on
observed active addresses. We start by choosing a desired
minimum density, and then compute the set of dense pre-
ﬁxes, if any.

Given a set of IP addresses and a desired minimum den-
sity, we compute a corresponding set of preﬁxes that (a)
contain a subset of those addresses, (b) have the desired
density, and (c) have preﬁx length up to 127. The dense
subset are the least-speciﬁc, non-overlapping preﬁxes that
are dense, i.e., contain the requisite fraction of addresses.
One way to implement this “densiﬁcation” is inspired by
Cho et al. and uses their aguri tree, [12] (a base-2 radix
tree, a.k.a., PATRICIA trie) augmented with a new “den-
sify” operation that works as follows:

(1) Populate the tree by adding each of the addresses
with a count of 1. If dense preﬁxes of just that one length
are desired, add each address with a “/p” and skip to step
3. 2

(2) Perform a post-order traversal of the tree; when vis-
iting a node that has children and the sum of counts for
the current node and its children would make the current
node’s preﬁx of the desired density, aggregate the node’s
children into the current node, by accumulating the count
and removing the children.

(3) Now the least-speciﬁc dense preﬁxes, of at least the
desired length p (if speciﬁed), are nodes in the tree. How-
ever, addresses in sparse regions remain unaggregated,
so they are present as well, e.g., /128s. To report only
the dense preﬁxes, perform an in-order traversal, skipping
those with a count that is less than n, e.g., 2, and print
others as they are dense preﬁxes.

An example of this process, implemented using an en-
hanced aguri tree, is shown in Figure 4. The result is that
we identify one dense preﬁx (2001:db8:10:1::/125) and
two sparse preﬁxes (a /66 and /68).

2When preﬁxes of just one length are desired, the aguri
tree is unnecessary; it is just accumulating counts and
sorting output. An alternative is to print addresses in a
ﬁxed-width 32-character hex format, one per line, and use:
sort [-m] |cut -c1-$((p/4)) |uniq -c [1]

5152001:db8::/42

2001:db8:20:d020:c000::/66

2001:db8:20:d020:e000::/67

2001:db8:20:d020:e000::/68

2001:db8:10:1::2/127

2001:db8:10:1::/125

2001:db8:10:1::4/126

2001:db8::/42

2001:db8:20:d020:c000::/66

(a)

2001:db8:10:1::/125

4

2001:db8:20:d020:e000::/67

2001:db8:20:d020:e000::/68

(b)

2001:db8:10:1::2

1

2001:db8:10:1::3

1

2001:db8:10:1::4

1

2001:db8:10:1::7

1

2001:db8:20:d020:c535:65cc:1b60:c941

1

2001:db8:20:d020:e0f6:2b71:6f2:ac1b

1

2001:db8:20:d020:edd0:8d72:47a8:a412

1

2001:db8:20:d020:f59d:3e14:f9e1:b894

1

2001:db8:20:d020:c535:65cc:1b60:c941

1

2001:db8:20:d020:e0f6:2b71:6f2:ac1b

1

2001:db8:20:d020:edd0:8d72:47a8:a412

1

2001:db8:20:d020:f59d:3e14:f9e1:b894

1

2001:db8::/42

2001:db8:20:d020:c000::/66

2001:db8:20:d020:e000::/68

2001:db8:10:1::/125

(c)

Figure 4: A 3-step method to identify dense (and sparse) preﬁxes using a binary PATRICIA tree: (a) First, an aguri tree
is populated with 8 active addresses, i.e., /128 preﬁxes, shown as nodes with solid lines, each with a count of 1; internal
nodes are shown dashed. (b) Next, the tree is “densiﬁed” to a density of 2/224 (at least 2@/104-dense) during a post-order
traversal; addresses are aggregated to their parent nodes for dense preﬁxes, with their respective counts accumulated
there, while addresses in sparse preﬁxes remain unaggregated. (c) Lastly, the contents of pruned tree are reported: one
dense /125 preﬁx, shown solid, and two sparse preﬁxes, shown dashed; here, we simply skip reporting the unaggregated
addresses (having a count of 1) in sparse regions during traversal.

6. RESULTS

6.1 Temporal Classiﬁcation

Table 2 summarizes the temporal classiﬁcations for the

“Other” addresses in Table 1 of Section 4.

Based on our temporal classiﬁcation method as described
in Section 5.1, Figure 5 shows stability of active addresses
and /64 preﬁxes observed on March 17 and 23, 2015, by
15-day sliding window. Consider the values for “March 17
active” (red) in Figure 5a. Here we see that about 320 mil-
lion WWW client IPv6 addresses were observed on March
17. Of those addresses, about 75 million were also seen
the previous day, about 20 million the day before that,
about 10 million the day before that, and so on, in step-
wise fashion. The same is true, approximately symmetri-
cally, for the days following March 17. Ultimately, this as-

sessment yields 30.1 million 3d-stable addresses (9.44%),
as listed in the “Mar 17, 2015” column of Table 2a.

Now consider the corresponding stability of /64 preﬁxes
shown in Figure 5b. A larger proportion of /64 preﬁxes are
stable than that of full addresses: 109 million 3d-stable
/64s (89.8%), as listed in the “Mar 17, 2015” column of Ta-
ble 2b. (The upper limit on the number stable addresses is
the number of stable /64s, or stable preﬁxes of any length.)
See Tables 2c and 2d for the stability results of addresses
and /64s, respectively, over a week’s time. For each of
the seven days, the 3d-stable addresses are determined,
and the table reports the count of the unique 3d-stable ad-
dresses seen over those days. Likewise for the “not 3d-
stable.”

On examining the values highlighted (bold) in Table 2,
we make two notes: (a) in a relative sense, there are not

516addr class
3d-stable
not 3d-stable
6m-stable (-6m)
1y-stable (-1y)

Mar 17, 2014
13.7M (9.22%)
134M (90.8%)

Sep 17, 2014
13.6M (6.84%)
185M (93.2%)
588K (.296%)

Mar 17, 2015
30.1M (9.44%)
288M (90.6%)
1.08M (.340%)
328K (.103%)

/64 class
3d-stable
not 3d-stable
6m-stable (-6m)
1y-stable (-1y)

Mar 17, 2014
55.8M (91.0%)
5.53M (9.01%)

Sep 17, 2014
74.6M (89.9%)
8.33M (10.1%)
23.4M (28.2%)

Mar 17, 2015
109M (89.8%)
12.3M (10.2%)
32.4M (26.7%)
21.8M (18.0%)

(a) Stability of IPv6 addresses per day

(b) Stability of /64 preﬁxes per day

addr class
3d-stable
not 3d-stable
6m-stable (-6m)
1y-stable (-1y)

Mar 17-23, 2014
37.0M (4.44%)
796M (95.6%)

Sep 17-23, 2014 Mar 17-23, 2015
69.0M (3.82%)
1.74B (96.2%)
3.66M (.202%)
1.81M (.100%)

34.0M (2.91%)
1.13B (97.1%)
3.25M (.280%)

/64 class
3d-stable
not 3d-stable
6m-stable (-6m)
1y-stable (-1y)

Mar 17-23, 2014
131M (83.7%)
25.5M (16.3%)

Sep 17-23, 2014 Mar 17-23, 2015
246M (80.3%)
60.6M (19.7%)
153M (49.9%)
116M (37.8%)

169M (81.8%)
37.7M (18.2%)
120M (58.1%)

(c) Stability of IPv6 addresses per week

(d) Stability of /64 preﬁxes per week

Table 2: Stability of active IPv6 WWW client address and preﬁx counts, not 6to4 or Teredo, March 2015.

400 M

350 M

300 M

250 M

200 M

150 M

100 M

50 M

s
e
s
s
e
r
d
d
a
 

6
v
P
I
 
e
v
i
t
c
a
 
e
u
q
i
n
u

400 M

350 M

300 M

250 M

200 M

150 M

100 M

50 M

s
e
s
s
e
r
d
d
a
 

6
v
P
I
 
e
v
i
t
c
a
 
e
u
q
i
n
u

active per day
Mar 17 active
Mar 23 active

active /64s per day
Mar 17 active /64s
Mar 23 active /64s

0 
Mar-10

Mar-11

Mar-12

Mar-13

Mar-14

Mar-20

Mar-17

Mar-16

Mar-21
Mar-22
Mar-19
Mar-18
log processed date

Mar-15
(a) IPv6 address stability

Mar-23

Mar-24

Mar-25

Mar-26

Mar-27

Mar-28

Mar-29

Mar-30

0 
Mar-10

Mar-11

Mar-12

Mar-13

Mar-14

Mar-20

Mar-17

Mar-21
Mar-22
Mar-19
Mar-18
log processed date

Mar-15
Mar-16
(b) /64 preﬁx stability

Mar-23

Mar-24

Mar-25

Mar-26

Mar-27

Mar-28

Mar-29

Mar-30

Figure 5: Stability study of active IPv6 WWW client addresses and preﬁxes observed per day, March 2015.

many very long-lived WWW client IPv6 addresses, only 1.81
million (0.1%) observed over the course of a year; and
(b), there are many long-lived /64 preﬁxes for active WWW
clients: 153 million 6m-stable /64s, and even 116 million
1y-stable /64s. Consider Figure 6a, where we plot the
CCDF of various counts by ASN. We see that a single ASN
accounts for over 100 million /64s (dashed black) as ob-
served across 6 months, indicating that most long-lived
/64s (dashed blue) are in only a few networks. We explore
this further in Section 6.2.1.
6.1.1 Discussion of Temporal Results
One motivation for identifying 3d-stable addresses is the
proposal that they’d make reliable targets for active prob-
ing to discover network infrastructure. We tested this hy-
pothesis by randomly selecting 3.18 million 3d-stable ac-
tive WWW client IPv6 addresses as targets for TTL-limited
probes and then performed 52.6 million traces to them
from 20 geographically-diverse source locations. We re-
ceived a response from 10.9% of the targets target versus
only 0.312% of targets selected randomly from all active
WWW client IPv6 addresses, i.e., not just the stable ones.
While also likely useful to trace toward ephemeral WWW

client address targets, we discover the last hop routers
and the diameter of the IPv6 Internet only if the target
responds. Thus, we ﬁnd that stable client addresses are
clearly useful as targets in subsequent active measure-
ments.

As for the “not 3d-stable” addresses, we expect that the
vast majority are hosts using a privacy-extension IID, as
the default timeout is 24 hours. [33] However, other types
of addresses are present as well. Note that, although the
IID of EUI-64 addresses is static, the subnet preﬁx can
vary, as when the device is moved between networks, or
when a given operator implements a policy of assigning
another subnet preﬁx each time the device connects to the
network.
(See Section 6.2.1 for further discussion.) We
investigated EUI-64 addresses in the Sept. 17-23, 2014
dataset that were classiﬁed as “not 3d-stable.” In 62% of
them, the IID appeared in more than one address. Also,
for 14% of them, the IID also appeared in an address that
was classiﬁed as 3d-stable.

While the temporal class “3d-stable (-7d,+7d)” is useful
when applied to target selection for active measurements,
more research is warranted in order to determine what

517speciﬁc temporal classes may be most useful, e.g., vary-
ing the number of days or the sliding window size, and in
combination with addressing practices.

One wonders whether or not any of our counts of ac-
tive or stable /64s could be an approximate lower-bound
on the actual number of subscribers or instances of IPv6-
capable Internet connections in the world today. Consider
the highlighted (bold) counts in Table 2d; is the 116 million
1y-stable /64s observed March, 2015, a reasonable lower-
bound? We discuss this in the forthcoming Section 7, but
ﬁrst, we address spatial classiﬁcation results in order to
better understand how network identiﬁers such as /64 pre-
ﬁxes are assigned by ISPs.
6.2 Spatial Classiﬁcation

6.2.1 Multi-Resolution Aggregate Count Ratio
Here we turn to results based on MRA plots that we in-
troduced in Section 5.2.1. With myriad possible address
populations for which to produce MRA plots but limited
space, a data-driven exploration methodology that directs
our attention to ASNs and preﬁxes of interest is called for.
To this end, we ﬁrst examine Figures 6a and 6b, distribu-
tions of aggregate counts across all active IPv6 ASNs and
BGP preﬁxes.

Consider Figure 6b. This is a set of box plots, each show-
ing the distribution of aggregation ratios across all IPv6
BGP preﬁxes for each of the 16-bit segments of each pre-
ﬁxes’ set of active IPv6 addresses. Unlike a typical box
plot showing just the median, middle 50, and whiskers to,
say, the 1st and 99th percentiles, these also show middle
90% and whiskers extend to the absolute maximum, as an-
notated. Overall, we can see that most aggregation takes
place across the three 16-bit segments between bits 32
and 80. We also see that about 20% of the preﬁxes (the
75th through 95th percentiles (transparent portion of the
box) have signiﬁcant aggregation in the 112-128 bit seg-
ment, thus we include an MRA plot for just such a preﬁx in
Figure 7e.

In Figure 6a, by the solid black line near the lower right-
hand corner, we see that there is an exceptional ASN with
500 million active addresses in a week’s time, thus we in-
clude its MRA plot as Figure 7c. This happens to be the
ASN of the preﬁx with the highest aggregation in the 48-
64 bit segment in Figure 6b.

Figures 7a through 7f are the resulting selected MRA
plots for active WWW client addresses observed March 17-
23, 2015. Let’s tour the active IPv6 address space through
these plots, discovering their features of interest. Coinci-
dentally, the networks represented in these plots happen
also to be diversely located in the world. Figure 7a is the
MRA plot for all active WWW client addresses observed
in the entire IPv6 unicast address space, the proverbial
“30,000-foot view.” The 0-32 bit segment is roughly gov-
erned by the Regional Internet Registries (RIRs) via their
allocations and assignments to ISPs and end users (though
some allocations are much larger than a /32), and remain-
ing bits down to /64 are within the area that a network
operator uses for subnetting in routing protocols. Fig-
ure 7a shows that there is greater use of the bit space

active addresses per ASN
active /64s per ASN
active EUI-64 addresses per ASN
active 6-month-stable /64s per ASN

1
0.30.40.5
0.2
0.1

0.01

0.001

e
l
a
c
s
 

g
o
l
 
,

 

n
o
i
t
r
o
p
o
r
P
F
D
C
y
r
a
t
n
e
m
e
l
p
m
o
C

 

0.0001

1 

10 

100 

1 k

10 k
100 k
Count, log scale

1 M

10 M 100 M 500M

(a) Distribution of active addrs and /64 counts, 4.42K
ASNs

65536
32768
16384
8192
4096
2048
1024
512
256
128
64
32
16
8
4
2
1

e
l
a
c
s
 

g
o
l
 
,

o
i
t
a
r
 
t
n
u
o
c
 
e
t
a
g
e
r
g
g
a

max

middle 90%
middle 50%

99th

95th

75th

25th

median

0

16

32

48

64

Prefix length (p)

80

96

112

128

(b) 16-bit segment agg. distributions, 6.87K BGP pre-
ﬁxes

Figure 6: Distribution plots for active IPv6 addresses ob-
served during 7 days, March 17-23, 2015.

in the 32-64 range than the 0-32, with the greatest use of
a 16-bit segment in the 32-48 bit range. Within the 16-
32 bit range, the RIRs partition more frequently by the
higher-order bits, while in the 32-48 bit range, network op-
erators partition more frequently by the lower-order bits.
Lastly, the 64-128 bit segment is clearly different, as ex-
pected given the prevalence of ephemeral addresses pre-
sumably due to SLAAC and privacy addressing. While we
can’t see ﬁne details at this level, preﬁx aggregation here
happens near bit position 64; this is because this segment
is mostly sparsely populated with random values such that
the majority of hosts’ addresses share at most short runs
of leading bits of their IIDs in common with other active
addresses in their /64.

Figure 7b is the MRA plot for 6to4 clients. Here we
witness the signiﬁcant difference between IPv6 and IPv4
aggregation. For addresses in the /16 preﬁx reserved for
6to4, IPv4 addresses are embedded in bits 16 through 48,
as is clearly evident in the plot. The single bits ratios plot-
ted (blue) in the 16-48 segment are similar to those Kohler
et al. studied years ago and plot in [28]. This 32-bit IPv4

518e
l
a
c
s
 
g
o
l
 
,
o
i
t
a
r
 
t
n
u
o
c
 
e
t
a
g
e
r
g
g
a

65536
32768
16384
8192
4096
2048
1024
512
256
128
64
32
16
8
4
2
1

16-bit segments
4-bit segments
single bits

0

16

32

48

64

Prefix length (p)

80

96

112

128

e
l
a
c
s
 
g
o
l
 
,
o
i
t
a
r
 
t
n
u
o
c
 
e
t
a
g
e
r
g
g
a

65536
32768
16384
8192
4096
2048
1024
512
256
128
64
32
16
8
4
2
1

16-bit segments
4-bit segments
single bits

0

16

32

48

64

Prefix length (p)

80

96

112

128

(a) All: 1.81B active IPv6 client addrs, not 6to4 or Teredo

(b) 6to4: 64.2M active IPv6 (49.3M IPv4) client addresses

e
l
a
c
s
 

g
o
l
 
,

o
i
t
a
r
 
t
n
u
o
c
 
e
t
a
g
e
r
g
g
a

65536
32768
16384
8192
4096
2048
1024
512
256
128
64
32
16
8
4
2
1

16-bit segments
4-bit segments
single bits

0

16

32

48

64

Prefix length (p)

80

96

112

128

e
l
a
c
s
 

g
o
l
 
,

o
i
t
a
r
 
t
n
u
o
c
 
e
t
a
g
e
r
g
g
a

65536
32768
16384
8192
4096
2048
1024
512
256
128
64
32
16
8
4
2
1

16-bit segments
4-bit segments
single bits

0

16

32

48

64

Prefix length (p)

80

96

112

128

(c) US mobile: 510M active IPv6 client addrs, 167M /64s

(d) EU ISP preﬁx: 86.2M active IPv6 client addrs, 15.5M /64s

e
l
a
c
s
 
g
o
l
 
,

o
i
t
a
r
 
t
n
u
o
c
 
e
t
a
g
e
r
g
g
a

65536
32768
16384
8192
4096
2048
1024
512
256
128
64
32
16
8
4
2
1

16-bit segments
4-bit segments
single bits

0

16

32

48

64

Prefix length (p)

80

96

112

128

e
l
a
c
s
 
g
o
l
 
,

o
i
t
a
r
 
t
n
u
o
c
 
e
t
a
g
e
r
g
g
a

65536
32768
16384
8192
4096
2048
1024
512
256
128
64
32
16
8
4
2
1

16-bit segments
4-bit segments
single bits

0

16

32

48

64

Prefix length (p)

80

96

112

128

(e) EU univ. dept. preﬁx: 94 active IPv6 client addrs, 1 /64

(f) JP ISP preﬁx: 57.0M active IPv6 client addrs, 2.18M /64s

Figure 7: Multi-Resolution Aggregate (MRA) plots for active IPv6 addresses observed during 7 days, March 17-23, 2015.

519address segment has much higher aggregation than any
similar segments of IPv6 in Figure 7a.

Figure 7c is the MRA plot for a U.S.-based mobile carrier.
Its most unusual feature is that the 44-64 bit segment is
nearly 100% utilized when observed over one week’s time.
This is evidenced by the 16-bit segments value (dashed
red) and the 4-bits segments value (black) nearly reach-
ing their maximum possible heights of 64K and 16, respec-
tively. By experiment as a subscriber, we know that user
equipment (UE) in this mobile service receives a different
/64 preﬁx on each association, and by comparison to the
same plot over only 1 day (not shown), we can deduce that
this network seems to dynamically assign /64s from pools
of addresses in this 44-64 bit segment. This dynamic as-
signment has consequences when trying to estimate sub-
scribers because it can cause the count of active /64s ob-
served to over-represent the number of subscribers. Cor-
roborating evidence for a dynamic address component in
the 44-64 bit segment is that this carrier’s BGP advertise-
ments consist of over 400 /44 preﬁxes. The MRA plot for
another top mobile carrier that advertises tens of /40 pre-
ﬁxes (not shown due to limited space) is strikingly similar.
Next, let’s consider the MRA plots of a European ISP, in
Figure 7d, and a Japanese ISP, in Figure 7f, for one of each
of their advertised BGP preﬁxes. The careful observer will
note that the preﬁxes are at least of size 19 and 24 bits, re-
spectively, as evidenced by the left-most of the single bits
(blue) values. Their numbers of active addresses are sim-
ilar and both sets appear to primarily consist of privacy
addresses, sparsely distributed in the 64-128 bit segment.
However, the leading 64-bit portions (left side) of the plots
differ starkly, suggesting very different address plans are
in use. Most notably, in Figure 7d, the 40-64 bit segment is
populated with many values over a week’s time, with heav-
ier usage of the higher order bits of this range. Note that
bit 40 seems to be constant and that there is a subtle per-
turbation in the single bits (blue) aggregation ratios at po-
sition 56. After examining the distribution (not shown) of
values in bits 40-55, we posit that this segment contains an
oft-changing, pseudorandom 15-bit number beginning at
bit 41. This is followed by an 8-bit value in bits 56-63 of un-
known construction, with all 256 possible values observed,
but non-uniform and most often 0x00 or 0x01. By contrast,
in Figure 7f, the 48-64 bit segment exhibits seemingly no
aggregation, suggesting that each /48 has the same 16-bit
value in every address it contains. Further, by examining
the distribution (not shown) of /64 counts per IID (or Eth-
ernet MAC address) for the JP ISP’s 185K active EUI-64
addresses, we see that 99.6% of them were observed in
just one /64 in a week’s time; this ﬁgure is 67.4% for the
EU ISP. We discuss a reason for this in Section 6.2.3.

Figure 7e is the MRA plot for one /64 preﬁx for one de-
partment at a European university. We selected it for con-
sideration because it contains multiple 2@/112-dense pre-
ﬁxes, identiﬁed in the forthcoming results in Section 6.2.2.
Consequently, the structure shown is markedly different
from other plots. The WWW client addresses are densely
packed, as evidenced by the values at all resolutions (dashed
red, black, and blue) being most prominent in the 112-128
bit segment; this indicates that these client addresses are

numerically close together, as one might expect, e.g. when
assigning static addresses to hosts or when assigning ad-
dresses via DHCP. There don’t appear to be any SLAAC
addresses, which require a 64-bit network identiﬁer. Ag-
gregation seen in the 72-80 bit range and none in bits 80-
120 suggests network identiﬁer lengths are between 80
and 120.
6.2.2 Dense Preﬁxes and Addresses

Density
Class
2 @ /124
3 @ /120
2 @ /120
2 @ /116
64 @ /112
32 @ /112
16 @ /112
8 @ /112
4 @ /112
2 @ /112
2 @ /108
2 @ /104

Dense
Preﬁxes
43.1K
8.28K
64.2K
207K
187
509
3.06K
21.5K
101K
367K
289K
108K

Router
Addresses
116K
81.0K
193K
568K
41.2K
54.8K
105K
290K
681K
1.29M
1.72M
1.84M

Possible
Addresses
689K
2.12M
16.4M
852M
12.3M
33.4M
201M
1.41B
6.63B
24.1B
303B
1.81T

Router Address
Density
0.1678459119
0.0382372758
0.0117351137
0.0006670818
0.0033593815
0.0016417438
0.0005259994
0.0002057970
0.0001026403
0.0000534072
0.0000056895
0.0000010171

Table 3: Dense preﬁxes identiﬁed at various densities for
3.2M router addresses collected February 2015.

Table 3 summarizes the dense preﬁxes discovered, by
the method described in Section 5.2.3, using the router ad-
dresses dataset described in Section 4. Here we perform
a limited search of the parameter space to determine what
combinations of n and p (where n is the number of hosts
that must be observed within a preﬁx of length p for the
preﬁx to be considered dense) yield a reasonable number
of targets for active measurements. As we see, manipulat-
ing these two parameters gives signiﬁcant control over the
preﬁxes classiﬁed as dense and, therefore, the number of
possible target addresses that result.

Finally, for active WWW client addresses observed March
17, 2015, we identify 128 thousand 2@/112-dense preﬁxes
and 1.38 million WWW client addresses contained therein.
This yields 8.39 billion possible target addresses. Given
that it is feasible to survey the entire IPv4 address space
space by active probing in only minutes [19], we propose
that it is similarly feasible to survey these dense regions of
the IPv6 address space. Other IPv6 address datasets could
yield additional sets of dense preﬁxes to survey.
6.2.3 Discussion of Spatial Classiﬁcation
To evaluate the interpretation of our MRA plots, we con-
tacted operators pertaining to networks in Figure 7 and
received the following information. (1) The high utilization
of the 40 - 64 bit address segment in Figure 7c coincides
with their subscribers being assigned /64s, e.g., by least
recently used, from a pool sized according to the connec-
tion capacity of a gateway. Thus the /64s are reused by
other subscribers. Our results suggest this reuse can oc-
cur in just days. (2) The university of Figure 2a provided us
with their full IPv6 address plan, and the implication from
the ﬁgure that we observe only 3 hex character values
matches their address plan. Two of these indicate “cus-
tomer networks” and “large customer networks,” which

520are the portions of their preﬁx that one would expect to
see WWW clients.

After we posited that the IP addresses plotted in Fig-
ure 7d contain a pseudorandom value in the network iden-
tiﬁer, we learned that a European ISP does just that. As
a supposed privacy-enhancing feature, they allow service
subscribers to have their IP addresses’ network identiﬁer
changed on demand, at the press of a button [37].

Regarding the subnet shown in Figure 7d, we found a
pertinent IPv6 address allocation plan available on the web;
this indicates the university to which the containing /48
is assigned. Furthermore, we found that every active ad-
dress had an ip6.arpa PTR record in the DNS and, thus,
were able to collect names for each of these hosts of which
92 began with “dhcpv6-.” This is evidence that the depart-
ment uses a single /64 to provide IPv6 addresses to a set
of about 100 active hosts.

We evaluate the application of our dense preﬁx results
by performing ip6.arpa PTR queries for the 2.12 million
possible addresses preﬁxes of the 3@/120-dense class, high-
lighted (bold) in Table 3. This yielded an additional 47K
domain names more than performing queries for just the
active WWW client addresses. (DNS names are valuable
hints to IP geolocation software because domain names
sometimes contain physical location information; this is es-
pecially true for routers. [34])

Overall, although our results are based on only a few
months of data across a year-long period, we claim they
demonstrate that both temporal and spatial address classi-
ﬁcations can reasonably be performed at large scale, and
that the results are useful in choosing targets for active
measurements and in discovering network-speciﬁc address-
ing practices.

7. DISCUSSION AND FUTURE WORK
7.1 Counting IPv6

If one assumes a 1:1 correspondence between /64 pre-
ﬁxes and IPv6 subscribers or “user connections,” the num-
bers of /64 preﬁxes are candidate surrogates for IPv6 “user”
counts. However, this assumption is rather crude.
It is
difﬁcult to say whether numbers of active and stable /64
preﬁxes are low or high estimates. Some networks employ
addressing schemes which cause the count of /64s (active
or stable) to overestimate the number of subscribers, e.g.,
the U.S. mobile carrier in Figure 7c. Other networks use
a plan by which the number of active /64s seems a rea-
sonable estimate of active subscribers, e.g., the Japanese
ISP in Figure 7f. Still other networks place many users in
the same /64, or more speciﬁc subnet, causing the count
of active /64s to underestimate the number of user connec-
tions, e.g., the network in Figure 7e. Evidence shows that
the number active /64s observed in a week’s time can mis-
count IPv6 WWW client devices by a factor of 100 in either
direction.

This challenging situation leads us to conclude that esti-
mating IPv6 user or device counts should be informed by
addressing practice on a per-network or per-preﬁx basis.
This likely requires either inside information from network
operators, or a reliable measurement method to determine

addressing practices from outside. We’ve had success in
reverse engineering addressing practice by examining the
network identiﬁers of EUI-64 addresses over time. These
persistent, unique IIDs serve as guides that help ﬁnd our
way in areas of the IPv6 address space.
7.2 Longest Stable Preﬁxes

Having achieved some success reverse engineering net-
work structure “manually,” as just described, we propose
that one could automatically discover stable portions of
network identiﬁers, deﬁned as the set of longest stable
preﬁxes in a dataset recording many address observations
over time. By combining aspects of our temporal and spa-
tial classiﬁcation techniques, we claim that it is possible
to identify a set of such preﬁxes, perhaps without relying
on inspection of addresses with long-lived IIDs, e.g., EUI-
64. These longest stable preﬁxes are likely to be signif-
icant aggregates within a network’s routing tables, thus
this presents a passive means by which one might glean
a network’s address plan. We’ve begun to explore this
prospect and it is a focus of our future work.

8. CONCLUSION

In this paper, we present a methodology to classify IPv6
addresses. We employ two techniques: (1) temporal anal-
ysis to determine preﬁx and address stability over time,
and (2) spatial analysis to determine the structure in which
preﬁxes and addresses are contained. We develop classi-
ﬁers and demonstrate their efﬁcacy in an empirical study
of active IPv6 addresses observed at a large CDN across a
year’s time, involving billions of WWW client addresses.
The results of our analyses expose operator addressing
practices that impact the interpretation of Internet mea-
surements. Finally, we propose that the classiﬁcations we
develop are applicable, and likely necessary, to compre-
hensively survey or census the IPv6 Internet by passive
and active means.

Acknowledgments
We thank Cameron Byrne, Dale Carder, Jon Crowcroft, Pawe 
Foremski, Jan Galkowski, Steve Hoey, Geoff Huston, Jeff
Kline, Liz Krznarich, David Malone, George Michaelson,
Keung-Chi “KC” Ng, and Erik Nygren for their helpful com-
ments and assistance.

9. REFERENCES
[1] GNU core utilities.

http://www.gnu.org/software/coreutils/, 2003.

[2] Google IPv6 Statistics. http://www.google.com/

intl/en/ipv6/statistics.html, 2015.

[3] Sample IPv6 Active WWW Client Address Aggregate

Counts Data. http:
//www.akamai.com/technical-publications/,
October 2015.

[4] State of the Internet: IPv6 Adoption Trends by

Country and Network.
http://www.stateoftheinternet.com/ipv6, April
2015.

521[5] T. Aura. Cryptographically Generated Addresses

[22] R. Hinden and S. Deering. IP Version 6 Addressing

(CGA). IETF RFC 3972, March 2005.

[6] M. Bagnulo. Hash-Based Addresses (HBA). IETF RFC

5535, June 2009.

Architecture. IETF RFC 4291, February 2006.
[23] C. Huitema. An Anycast Preﬁx for 6to4 Relay

Routers. IETF RFC 3068, June 2001.

[7] M. Bagnulo and J. Arkko. Support for Multiple Hash

[24] C. Huitema. Teredo: Tunneling IPv6 over UDP

Algorithms in Cryptographically Generated
Addresses (CGAs). IETF RFC 4982, July 2007.

[8] R. Barnes, R. Altmann, and D. Kerr. Mapping the

Great Void: Smarter scanning for IPv6.
http://www.caida.org/workshops/isma/1202/
slides/aims1202_rbarnes.pdf, Feb 2012.

[9] F. Brockners, S. Gundavelli, S. Seicher, and D. Ward.
Gateway-Initiated Dual-Stack Lite Deployment. IETF
RFC 6674, July 2012.

[10] B. Carpenter, J. Crowcroft, and Y. Rekhter. IPv4

Address Behaviour Today. IETF RFC 2101, February
1997.

[11] B. Carpenter and S. Jiang. Signiﬁcance of IPv6

through Network Address Translations (NATs). IETF
RFC 4380, February 2006.

[25] G. Huston. Personal correspondence, April 2015.
[26] G. Huston and G. Michaelson. Measuring IPv6.

http://www.potaroo.net/presentations/
2013-05-16-ipv6-measurement.pdf, May 2013.

[27] G. Huston and G. Michaelson. March 2015 Update

on Measuring IPv6. http://www.potaroo.net/
presentations/2015-03-22-ipv6-stats.pdf,
March 2015.

[28] E. Kohler, J. Li, V. Paxson, and S. Shenker. Observed

Structure of Addresses in IP Trafﬁc. In Internet
Measurement Workshop, pages 253–266, 2002.

Interface Identiﬁers. IETF RFC 7136, February 2014.

[29] M. Kohno, B. Nitzan, R. Bush, Y. Matsuzaki, L.Colitti,

[12] K. Cho, R. Kaizaki, and A. Kato. Aguri: An

Aggregation-Based Trafﬁc Proﬁler. In Proceedings of
the Workshop on Quality of Future Internet Services
(QofIS ’01), Coimbra, Portugal, September 2001.

[13] k. claffy. The 4th Workshop on Active Internet

Measurements (AIMS-4) Report. ACM SIGCOMM
Computer Communication Review (CCR),
42(3):34–38, Jul 2012.

[14] L. Colitti, S. H. Gunderson, E. Kline, and T. Reﬁce.
Evaluating IPv6 Adoption in the Internet. In PAM,
pages 141–150, 2010.

[15] J. Czyz, M. Allman, J. Zhang, S. Iekel-Johnson,

E. Osterweil, and M. Bailey. Measuring IPv6
Adoption. SIGCOMM Computer Communication
Review, 44(4):87–98, August 2014.

[16] A. Dainotti, K. Benson, A. King, k. claffy, M. Kallitsis,

E. Glatz, and X. Dimitropoulos. Estimating Internet
Address Space Usage Through Passive
Measurements. ACM SIGCOMM Computer
Communication Review (CCR), 44(1):42–49, Jan
2014.

[17] R. Droms, J. Bound, B. Volz, T. Lemon, C. Perkins,

and M. Carney. Dynamic Host Conﬁguration Protocol
for IPv6 (DHCPv6). IETF RFC 3315, July 2003.

[18] A. Durand, R. Droms, J. Woodyatt, and Y. Lee.

Dual-Stack Lite Broadband Deployments Following
IPv4 Exhaustion. IETF RFC 6333, August 2011.
[19] Z. Durumeric, E. Wustrow, and J. A. Halderman.

ZMap: Fast Internet-Wide Scanning and its Security
Applications. In Proceedings of the 22nd USENIX
Security Symposium, August 2013.

[20] F. Gont. A Method for Generating Semantically

Opaque Interface Identiﬁers with IPv6 Stateless
Address Autoconﬁguration (SLAAC). IETF RFC 7217,
April 2014.

[21] C. Grundemann, A. Hughes, and O. Delo. Best

Current Operational Practices - IPv6 Subnetting.
http://bcop.nanog.org/images/6/62/BCOP-IPv6_
Subnetting.pdf, 2011.

and T. Narten. Using 127-Bit IPv6 Preﬁxes on
Inter-Router Links. IETF RFC 6164, April 2011.

[30] David Malone. Observations of IPv6 Addresses. In

Passive and Active Network Measurement, 9th
International Conference, PAM 2008, Cleveland, OH,
USA, April 29-30, 2008. Proceedings, pages 21–30,
2008.

[31] M. Mawatari, M. Kawashima, and C. Byrne.

464XLAT: Combination of Stateful and Stateless
Translation. IETF RFC 6877, April 2013.

[32] G. Michaelson. Personal conversation, July 2014.
[33] T. Narten, R. Draves, and S. Krishnan. Privacy

Extensions for Stateless Address Autoconﬁguration
in IPv6. IETF RFC 4941, September 2007.

[34] V. N. Padmanabhan and L. Subramanian. An

Investigation of Geographic Mapping Techniques for
Internet Tools. In Proceedings of ACM SIGCOMM
2001, San Diego, CA, August 2001.

[35] SURFnet. Preparing an IPv6 Address Plan.

http://www.ripe.net/lir-services/training/
material/IPv6-for-LIRs-Training-Course/
Preparing-an-IPv6-Addressing-Plan.pdf,
September 2013.

[36] Akamai Technologies. State Of The Internet Q3 2014

Report. http://www.akamai.com/dl/akamai/
akamai-soti-q314.pdf, 2014.

[37] Deutsche Telekom. Deutsche Telekom offers

anonymous surﬁng with IPv6.
https://www.telekom.com/media/company/93184,
Nov 2011.

[38] F. Templin, T. Gleeson, and D. Thaler. Intra-Site

Automatic Tunnel Addressing Protocol (ISATAP).
IETF RFC 5214, March 2008.

[39] S. Thompson, T. Narten, and T. Jinmei. IPv6 Stateless

Address Autoconﬁguration. IETF RFC 4862,
September 2007.

522